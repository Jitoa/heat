C=======================================================================
C     CRANK-NICOLSON FOR Y-DIRECTION                                    
C     4TH-ORDER CENTRAL SCHEME (X,Z DIR.) FOR CONVECTIVE TERM           
C     2ND-ORDER CENTRAL SCHEME (Y DIR.CONSISTENT) FOR CONVECTIVE TERM   
C     4TH-ORDER CENTRAL SCHEME (X,Z DIR.) FOR VISCOUS TERM              
C     2ND-ORDER CENTRAL SCHEME FOR THE OTHER TERMS                      
C     2000.07.02 PROGRAMED BY H.ABE                                     
C     2000.07.20 REVISED BY H.ABE (ADD => TRIPLE CORR.)                 
C     2000.09.24 REVISED BY H.ABE (EXTENDED TO PARALLEL VERSION)        
C     2000.10.26 REVISED BY H.ABE (TRI,QUAD,CON_AVE)                    
C=======================================================================
C                                                                       
      SUBROUTINE ERG_1STP(PR1,PR2)                                      
C                                                                       
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCDATA'                                         
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
C---  LOCAL  VARIABLES  ------------------------------------------------
C                                                                       
      DIMENSION U(-4:IG+4,-2:JG+2,-4:KG+4,3)                            
      DIMENSION T1(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION T2(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION FFS1(0:IG,JG,0:KG),FFS2(0:IG,JG,0:KG)                   
C                                                                       
      COMMON /TDMAT/ AAT(LY),BBT1(LY),BBT2(LY),CCT(LY)                  
      COMMON /FD2C/ CEN2_F(0:JG,2),CEN2_M(0:JG,2),CEN2_B(0:JG,2)        
      COMMON /OLDCNT/ CNS1_OLD(0:IG,JG,0:KG),CNS2_OLD(0:IG,JG,0:KG)     
C                                                                       
      DIMENSION EA_U(-2:JG+2)                                           
C                                                                       
      COMMON /RVTL/ PTTL                                                
      COMMON /RVXZ/ PXZ                                                 
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /VELO/ UG(-4:IG+4,-2:JG+2,-4:KG+4,3)                       
      COMMON /EAVU/ EAGU(-2:JG+2)                                       
C                                                                       
      COMMON /TEM1/ T1G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /TEM2/ T2G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /OLDS/ FFS1G(0:IG,JG,0:KG),FFS2G(0:IG,JG,0:KG)             
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (UG,U)                                                
      EQUIVALENCE (EAGU,EA_U)                                           
      EQUIVALENCE (T1G,T1),(T2G,T2)                                     
      EQUIVALENCE (FFS1G,FFS1),(FFS2G,FFS2)                             
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
      PE1=RE*PR1                                                        
      PE2=RE*PR2                                                        
C                                                                       
      DO 100 J=1,JG                                                     
       AAT(J)=2.0D0/DRR(J+1)/(DRR(J)+DRR(J+1))                          
       CCT(J)=2.0D0/DRR(J)/(DRR(J)+DRR(J+1))                            
       BBT1(J)=2.0D0/DRR(J)/DRR(J+1)+2.0D0*PE1/DT                       
       BBT2(J)=2.0D0/DRR(J)/DRR(J+1)+2.0D0*PE2/DT                       
  100 CONTINUE                                                          
C                                                                       
      DO 10 J=1,JG                                                      
       EA_U(J)=0.0D0                                                    
   10 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K)                                          
      DO 20 J=1,JG                                                      
      DO 20 K=1,KG                                                      
      DO 20 I=1,IG                                                      
       EA_U(J)=EA_U(J)+U(I,J,K,1)                                       
   20 CONTINUE                                                          
C                                                                       
      DO 30 J=1,JG                                                      
       EA_U(J)=EA_U(J)*PXZ                                              
   30 CONTINUE                                                          
C                                                                       
C                                                                       
      TTL=0.0D0                                                         
      TTL=TTL+0.25D0*DR(1)*EA_U(1)                                      
C                                                                       
      DO 40 J=2,JG                                                      
       TTL=TTL+0.5D0*DRR(J)*( EA_U(J-1)+EA_U(J) )                       
   40 CONTINUE                                                          
C                                                                       
      TTL=TTL+0.25D0*DR(JG)*EA_U(JG)                                    
      PTTL=1.0D0/TTL                                                    
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K,UDTDX,WDTDZ,VDTDY,DTDX_2,DTDZ_2,DTDY_2    
!$OMP&                   ,CONS)                                         
      DO 50 J=1,JG                                                      
      DO 50 K=1,KG                                                      
      DO 50 I=1,IG                                                      
C                                                                       
C---  Calculate Pr1                                                     
C                                                                       
      UDTDX=(9.0D0/8.0D0)*(                                             
     &      (U(I,J,K,1)*(T1(I+1,J,K)-T1(I,J,K))*PDX)                    
     &      +                                                           
     &      (U(I-1,J,K,1)*(T1(I,J,K)-T1(I-1,J,K))*PDX)                  
     &      )*0.5D0                                                     
     &      -                                                           
     &      (1.0D0/8.0D0)*(                                             
     &      (U(I+1,J,K,1)*(T1(I+3,J,K)-T1(I,J,K))/3.0D0*PDX)            
     &      +                                                           
     &      (U(I-2,J,K,1)*(T1(I,J,K)-T1(I-3,J,K))/3.0D0*PDX)            
     &      )*0.5D0                                                     
      WDTDZ=(9.0D0/8.0D0)*(                                             
     &      (U(I,J,K,3)*(T1(I,J,K+1)-T1(I,J,K))*PDZ)                    
     &      +                                                           
     &      (U(I,J,K-1,3)*(T1(I,J,K)-T1(I,J,K-1))*PDZ)                  
     &      )*0.5D0                                                     
     &      -                                                           
     &      (1.0D0/8.0D0)*(                                             
     &      (U(I,J,K+1,3)*(T1(I,J,K+3)-T1(I,J,K))/3.0D0*PDZ)            
     &      +                                                           
     &      (U(I,J,K-2,3)*(T1(I,J,K)-T1(I,J,K-3))/3.0D0*PDZ)            
     &      )*0.5D0                                                     
      VDTDY= U(I,J,K,2)*((T1(I,J+1,K)-T1(I,J,K))*(0.5D0*PDRR(J+1)))     
     &      +U(I,J-1,K,2)*((T1(I,J,K)-T1(I,J-1,K))*(0.5D0*PDRR(J)))     
      DTDX_2=(-T1(I+2,J,K)+16.0D0*T1(I+1,J,K)-30.0D0*T1(I,J,K)          
     &        +16.0D0*T1(I-1,J,K)-T1(I-2,J,K))/12.0D0*PDX2/PE1          
      DTDZ_2=(-T1(I,J,K+2)+16.0D0*T1(I,J,K+1)-30.0D0*T1(I,J,K)          
     &        +16.0D0*T1(I,J,K-1)-T1(I,J,K-2))/12.0D0*PDZ2/PE1          
      DTDY_2= CEN2_F(J,2)*T1(I,J+1,K)+CEN2_M(J,2)*T1(I,J,K)             
     &       +CEN2_B(J,2)*T1(I,J-1,K)                                   
      CONS=UDTDX+VDTDY+WDTDZ                                            
C---------------------------------------------CONST.WALL-HEAT FLUX      
      FFS1(I,J,K)=2.0D0*PE1*(CONS-DTDX_2-DTDZ_2)-(DTDY_2)               
     &            -2.0D0*PE1/DT*T1(I,J,K)                               
     &            -2.0D0*PE1*(2.0D0*PTTL*U(I,J,K,1))                    
                                                                        
      CNS1_OLD(I,J,K)=CONS-DTDX_2-DTDZ_2                                
C---------------------------------------------CONST.WALL-TEMP DIFFERENCE
C      EVVV=(U(I,J,K,2)+U(I,J-1,K,2))*0.5D0                             
CC                                                                      
C      FFS1(I,J,K)=2.0D0*PE1*(CONS-DTDX_2-DTDZ_2+EVVV)                  
C     &            -(DTDY_2)-2.0D0*PE1/DT*T1(I,J,K)                     
CC                                                                      
C      CNS1_OLD(I,J,K)=CONS-DTDX_2-DTDZ_2+EVVV                          
C                                                                       
   50 CONTINUE                                                          
C                                                                       
C---  Calculate Pr2                                                     
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K,UDTDX,WDTDZ,VDTDY,DTDX_2,DTDZ_2,DTDY_2    
!$OMP&                   ,CONS,EVVV)                                    
      DO 51 J=1,JG                                                      
      DO 51 K=1,KG                                                      
      DO 51 I=1,IG                                                      
C                                                                       
      UDTDX=(9.0D0/8.0D0)*(                                             
     &      (U(I,J,K,1)*(T2(I+1,J,K)-T2(I,J,K))*PDX)                    
     &      +                                                           
     &      (U(I-1,J,K,1)*(T2(I,J,K)-T2(I-1,J,K))*PDX)                  
     &      )*0.5D0                                                     
     &      -                                                           
     &      (1.0D0/8.0D0)*(                                             
     &      (U(I+1,J,K,1)*(T2(I+3,J,K)-T2(I,J,K))/3.0D0*PDX)            
     &      +                                                           
     &      (U(I-2,J,K,1)*(T2(I,J,K)-T2(I-3,J,K))/3.0D0*PDX)            
     &      )*0.5D0                                                     
                                                                        
      WDTDZ=(9.0D0/8.0D0)*(                                             
     &      (U(I,J,K,3)*(T2(I,J,K+1)-T2(I,J,K))*PDZ)                    
     &      +                                                           
     &      (U(I,J,K-1,3)*(T2(I,J,K)-T2(I,J,K-1))*PDZ)                  
     &      )*0.5D0                                                     
     &      -                                                           
     &      (1.0D0/8.0D0)*(                                             
     &      (U(I,J,K+1,3)*(T2(I,J,K+3)-T2(I,J,K))/3.0D0*PDZ)            
     &      +                                                           
     &      (U(I,J,K-2,3)*(T2(I,J,K)-T2(I,J,K-3))/3.0D0*PDZ)            
     &      )*0.5D0                                                     
      VDTDY= U(I,J,K,2)*((T2(I,J+1,K)-T2(I,J,K))*(0.5D0*PDRR(J+1)))     
     &      +U(I,J-1,K,2)*((T2(I,J,K)-T2(I,J-1,K))*(0.5D0*PDRR(J)))     
      DTDX_2=(-T2(I+2,J,K)+16.0D0*T2(I+1,J,K)-30.0D0*T2(I,J,K)          
     &        +16.0D0*T2(I-1,J,K)-T2(I-2,J,K))/12.0D0*PDX2/PE2          
      DTDZ_2=(-T2(I,J,K+2)+16.0D0*T2(I,J,K+1)-30.0D0*T2(I,J,K)          
     &        +16.0D0*T2(I,J,K-1)-T2(I,J,K-2))/12.0D0*PDZ2/PE2          
      DTDY_2= CEN2_F(J,2)*T2(I,J+1,K)+CEN2_M(J,2)*T2(I,J,K)             
     &       +CEN2_B(J,2)*T2(I,J-1,K)                                   
      CONS=UDTDX+VDTDY+WDTDZ                                            
C---------------------------------------------CONST.WALL-HEAT FLUX      
C      FFS2(I,J,K)=2.0D0*PE2*(CONS-DTDX_2-DTDZ_2)-(DTDY_2)              
C     &            -2.0D0*PE2/DT*T2(I,J,K)                              
C     &            -2.0D0*PE2*(2.0D0*PTTL*U(I,J,K,1))                   
C                                                                       
C      CNS2_OLD(I,J,K)=CONS-DTDX_2-DTDZ_2                               
C---------------------------------------------CONST.WALL-TEMP DIFFERENCE
      EVVV=(U(I,J,K,2)+U(I,J-1,K,2))*0.5D0                              
C                                                                       
      FFS2(I,J,K)=2.0D0*PE2*(CONS-DTDX_2-DTDZ_2+EVVV)                   
     &            -(DTDY_2)-2.0D0*PE2/DT*T2(I,J,K)                      
C                                                                       
      CNS2_OLD(I,J,K)=CONS-DTDX_2-DTDZ_2+EVVV                           
C                                                                       
   51 CONTINUE                                                          
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C     CRANK-NICOLSON FOR Y-DIRECTION                                    
C     4TH-ORDER CENTRAL SCHEME (X,Z DIR.) FOR CONVECTIVE TERM           
C     2ND-ORDER CENTRAL SCHEME (Y DIR.CONSISTENT) FOR CONVECTIVE TERM   
C     4TH-ORDER CENTRAL SCHEME (X,Z DIR.) FOR VISCOUS TERM              
C     2ND-ORDER CENTRAL SCHEME FOR THE OTHER TERMS                      
C     2000.07.02 PROGRAMED BY H.ABE                                     
C     2000.07.20 REVISED BY H.ABE (ADD => TRIPLE CORR.)                 
C     2000.09.24 REVISED BY H.ABE (EXTENDED TO PARALLEL VERSION)        
C=======================================================================
C                                                                       
      SUBROUTINE ERG(PR1,PR2)                                           
C                                                                       
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCDATA'                                         
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
C---  LOCAL  VARIABLES  ------------------------------------------------
C                                                                       
      DIMENSION U(-4:IG+4,-2:JG+2,-4:KG+4,3)                            
      DIMENSION T1(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION T2(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION FFS1(0:IG,JG,0:KG),FFS2(0:IG,JG,0:KG)                   
C                                                                       
      COMMON /FD2C/ CEN2_F(0:JG,2),CEN2_M(0:JG,2),CEN2_B(0:JG,2)        
      COMMON /OLDCNT/ CNS1_OLD(0:IG,JG,0:KG),CNS2_OLD(0:IG,JG,0:KG)     
C                                                                       
      DIMENSION EA_U(-2:JG+2)                                           
C                                                                       
      COMMON /RVTL/ PTTL                                                
      COMMON /RVXZ/ PXZ                                                 
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /VELO/ UG(-4:IG+4,-2:JG+2,-4:KG+4,3)                       
      COMMON /EAVU/ EAGU(-2:JG+2)                                       
C                                                                       
      COMMON /TEM1/ T1G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /TEM2/ T2G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /OLDS/ FFS1G(0:IG,JG,0:KG),FFS2G(0:IG,JG,0:KG)             
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (UG,U)                                                
      EQUIVALENCE (EAGU,EA_U)                                           
      EQUIVALENCE (T1G,T1),(T2G,T2)                                     
      EQUIVALENCE (FFS1G,FFS1),(FFS2G,FFS2)                             
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
      PE1=RE*PR1                                                        
      PE2=RE*PR2                                                        
C                                                                       
      DO 10 J=1,JG                                                      
       EA_U(J)=0.0D0                                                    
   10 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K)                                          
      DO 20 J=1,JG                                                      
      DO 20 K=1,KG                                                      
      DO 20 I=1,IG                                                      
       EA_U(J)=EA_U(J)+U(I,J,K,1)                                       
   20 CONTINUE                                                          
C                                                                       
      DO 30 J=1,JG                                                      
       EA_U(J)=EA_U(J)*PXZ                                              
   30 CONTINUE                                                          
C                                                                       
C                                                                       
      TTL=0.0D0                                                         
      TTL=TTL+0.25D0*DR(1)*EA_U(1)                                      
C                                                                       
      DO 40 J=2,JG                                                      
       TTL=TTL+0.5D0*DRR(J)*( EA_U(J-1)+EA_U(J) )                       
   40 CONTINUE                                                          
C                                                                       
      TTL=TTL+0.25D0*DR(JG)*EA_U(JG)                                    
      PTTL=1.0D0/TTL                                                    
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K,UDTDX,WDTDZ,VDTDY,DTDX_2,DTDZ_2,DTDY_2    
!$OMP&                   ,CONS)                                         
      DO 50 J=1,JG                                                      
      DO 50 K=1,KG                                                      
      DO 50 I=1,IG                                                      
C                                                                       
C---  Calculate Pr1                                                     
C                                                                       
      UDTDX=(9.0D0/8.0D0)*(                                             
     &      (U(I,J,K,1)*(T1(I+1,J,K)-T1(I,J,K))*PDX)                    
     &      +                                                           
     &      (U(I-1,J,K,1)*(T1(I,J,K)-T1(I-1,J,K))*PDX)                  
     &      )*0.5D0                                                     
     &      -                                                           
     &      (1.0D0/8.0D0)*(                                             
     &      (U(I+1,J,K,1)*(T1(I+3,J,K)-T1(I,J,K))/3.0D0*PDX)            
     &      +                                                           
     &      (U(I-2,J,K,1)*(T1(I,J,K)-T1(I-3,J,K))/3.0D0*PDX)            
     &      )*0.5D0                                                     
C                                                                       
      WDTDZ=(9.0D0/8.0D0)*(                                             
     &      (U(I,J,K,3)*(T1(I,J,K+1)-T1(I,J,K))*PDZ)                    
     &      +                                                           
     &      (U(I,J,K-1,3)*(T1(I,J,K)-T1(I,J,K-1))*PDZ)                  
     &      )*0.5D0                                                     
     &      -                                                           
     &      (1.0D0/8.0D0)*(                                             
     &      (U(I,J,K+1,3)*(T1(I,J,K+3)-T1(I,J,K))/3.0D0*PDZ)            
     &      +                                                           
     &      (U(I,J,K-2,3)*(T1(I,J,K)-T1(I,J,K-3))/3.0D0*PDZ)            
     &      )*0.5D0                                                     
      VDTDY= U(I,J,K,2)*((T1(I,J+1,K)-T1(I,J,K))*(0.5D0*PDRR(J+1)))     
     &      +U(I,J-1,K,2)*((T1(I,J,K)-T1(I,J-1,K))*(0.5D0*PDRR(J)))     
      DTDX_2=(-T1(I+2,J,K)+16.0D0*T1(I+1,J,K)-30.0D0*T1(I,J,K)          
     &        +16.0D0*T1(I-1,J,K)-T1(I-2,J,K))/12.0D0*PDX2/PE1          
      DTDZ_2=(-T1(I,J,K+2)+16.0D0*T1(I,J,K+1)-30.0D0*T1(I,J,K)          
     &        +16.0D0*T1(I,J,K-1)-T1(I,J,K-2))/12.0D0*PDZ2/PE1          
      DTDY_2= CEN2_F(J,2)*T1(I,J+1,K)+CEN2_M(J,2)*T1(I,J,K)             
     &       +CEN2_B(J,2)*T1(I,J-1,K)                                   
      CONS=UDTDX+VDTDY+WDTDZ                                            
C---------------------------------------------CONST.WALL-HEAT FLUX      
      FFS1(I,J,K)=PE1*(3.0D0*(CONS-DTDX_2-DTDZ_2)-CNS1_OLD(I,J,K))      
     &            -(DTDY_2)-2.0D0*PE1/DT*T1(I,J,K)                      
     &            -2.0D0*PE1*(2.0D0*PTTL*U(I,J,K,1))                    
                                                                        
      CNS1_OLD(I,J,K)=CONS-DTDX_2-DTDZ_2                                
C---------------------------------------------CONST.WALL-TEMP DIFFERENCE
C      EVVV=(U(I,J,K,2)+U(I,J-1,K,2))*0.5D0                             
CC                                                                      
C      FFS1(I,J,K)=PE1*(3.0D0*(CONS-DTDX_2-DTDZ_2+EVVV)                 
C     &            -CNS1_OLD(I,J,K))-(DTDY_2)                           
C     &            -2.0D0*PE1/DT*T1(I,J,K)                              
CC                                                                      
C      CNS1_OLD(I,J,K)=CONS-DTDX_2-DTDZ_2+EVVV                          
C                                                                       
   50 CONTINUE                                                          
C                                                                       
C---  Calculate Pr2                                                     
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K,UDTDX,WDTDZ,VDTDY,DTDX_2,DTDZ_2,DTDY_2    
!$OMP&                   ,CONS,EVVV)                                    
      DO 51 J=1,JG                                                      
      DO 51 K=1,KG                                                      
      DO 51 I=1,IG                                                      
C                                                                       
      UDTDX=(9.0D0/8.0D0)*(                                             
     &      (U(I,J,K,1)*(T2(I+1,J,K)-T2(I,J,K))*PDX)                    
     &      +                                                           
     &      (U(I-1,J,K,1)*(T2(I,J,K)-T2(I-1,J,K))*PDX)                  
     &      )*0.5D0                                                     
     &      -                                                           
     &      (1.0D0/8.0D0)*(                                             
     &      (U(I+1,J,K,1)*(T2(I+3,J,K)-T2(I,J,K))/3.0D0*PDX)            
     &      +                                                           
     &      (U(I-2,J,K,1)*(T2(I,J,K)-T2(I-3,J,K))/3.0D0*PDX)            
     &      )*0.5D0                                                     
C                                                                       
      WDTDZ=(9.0D0/8.0D0)*(                                             
     &      (U(I,J,K,3)*(T2(I,J,K+1)-T2(I,J,K))*PDZ)                    
     &      +                                                           
     &      (U(I,J,K-1,3)*(T2(I,J,K)-T2(I,J,K-1))*PDZ)                  
     &      )*0.5D0                                                     
     &      -                                                           
     &      (1.0D0/8.0D0)*(                                             
     &      (U(I,J,K+1,3)*(T2(I,J,K+3)-T2(I,J,K))/3.0D0*PDZ)            
     &      +                                                           
     &      (U(I,J,K-2,3)*(T2(I,J,K)-T2(I,J,K-3))/3.0D0*PDZ)            
     &      )*0.5D0                                                     
      VDTDY= U(I,J,K,2)*((T2(I,J+1,K)-T2(I,J,K))*(0.5D0*PDRR(J+1)))     
     &      +U(I,J-1,K,2)*((T2(I,J,K)-T2(I,J-1,K))*(0.5D0*PDRR(J)))     
      DTDX_2=(-T2(I+2,J,K)+16.0D0*T2(I+1,J,K)-30.0D0*T2(I,J,K)          
     &        +16.0D0*T2(I-1,J,K)-T2(I-2,J,K))/12.0D0*PDX2/PE2          
      DTDZ_2=(-T2(I,J,K+2)+16.0D0*T2(I,J,K+1)-30.0D0*T2(I,J,K)          
     &        +16.0D0*T2(I,J,K-1)-T2(I,J,K-2))/12.0D0*PDZ2/PE2          
      DTDY_2= CEN2_F(J,2)*T2(I,J+1,K)+CEN2_M(J,2)*T2(I,J,K)             
     &       +CEN2_B(J,2)*T2(I,J-1,K)                                   
      CONS=UDTDX+VDTDY+WDTDZ                                            
C---------------------------------------------CONST.WALL-HEAT FLUX      
C      FFS2(I,J,K)=PE2*(3.0D0*(CONS-DTDX_2-DTDZ_2)-CNS2_OLD(I,J,K))     
C     &            -(DTDY_2)-2.0D0*PE2/DT*T2(I,J,K)                     
C     &            -2.0D0*PE2*(2.0D0*PTTL*U(I,J,K,1))                   
C                                                                       
C      CNS2_OLD(I,J,K)=CONS-DTDX_2-DTDZ_2                               
C---------------------------------------------CONST.WALL-TEMP DIFFERENCE
      EVVV=(U(I,J,K,2)+U(I,J-1,K,2))*0.5D0                              
C                                                                       
      FFS2(I,J,K)=PE2*(3.0D0*(CONS-DTDX_2-DTDZ_2+EVVV)                  
     &            -CNS2_OLD(I,J,K))-(DTDY_2)                            
     &            -2.0D0*PE2/DT*T2(I,J,K)                               
C                                                                       
      CNS2_OLD(I,J,K)=CONS-DTDX_2-DTDZ_2+EVVV                           
C                                                                       
   51 CONTINUE                                                          
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C====================================================================   
C     CALCU. TEMPORARY TEMPERATURE WITH THE USE OF TDMA (Y-DIRECTION)   
C     1997.12.23 PROGRAMED BY H.ABE                                     
      SUBROUTINE CNTDMAT                                                
C---- REVISED BY H.ABE: DO 10  (2000.09.29, H.ABE)                      
C---- SPREAD REGION => SPREAD DO (2000.08.27, H.ABE)                    
C====================================================================   
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCDATA'                                         
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
C---  LOCAL  VARIABLES  ------------------------------------------------
C                                                                       
      COMMON /TDMAT/ AAT(LY),BBT1(LY),BBT2(LY),CCT(LY)                  
C                                                                       
      DIMENSION T1(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION T2(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION FFS1(0:IG,JG,0:KG),FFS2(0:IG,JG,0:KG)                   
      DIMENSION FFSS1(0:IG,0:JG,0:KG),FFSS2(0:IG,0:JG,0:KG)             
      DIMENSION TT1(0:IG,JG+1,0:KG),TT2(0:IG,JG+1,0:KG)                 
      DIMENSION B(0:IG,JG,2),D(0:IG,JG,2),E(0:IG,JG,2)                  
C                                                                       
C---  GLOBAL  VARIABLES  ---------------------------------------------  
C                                                                       
      COMMON /TEM1/ T1G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /TEM2/ T2G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /OLDS/ FFS1G(0:IG,JG,0:KG),FFS2G(0:IG,JG,0:KG)             
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (T1G,T1),(T2G,T2)                                     
      EQUIVALENCE (FFS1G,FFS1),(FFS2G,FFS2)                             
C                                                                       
C====================================================================   
C                                                                       
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,J)                                          
      DO 10 K=1,KG                                                      
      DO 10 J=1,JG                                                      
      DO 10 I=1,IG                                                      
       FFSS1(I,J,K)=FFS1G(I,J,K)                                        
       FFSS2(I,J,K)=FFS2G(I,J,K)                                        
C       TT1(I,J,K)=T1G(I,J,K)                                           
C       TT2(I,J,K)=T2G(I,J,K)                                           
   10 CONTINUE                                                          
C                                                                       
C---- X,Y,Z-DIRECTION                                                   
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,J,B,D)                                      
      DO 11 K=1,KG                                                      
       DO 12 J=1,JG                                                     
       DO 12 I=1,IG                                                     
        B(I,J,1)=BBT1(J)                                                
        B(I,J,2)=BBT2(J)                                                
        D(I,J,1)=FFSS1(I,J,K)                                           
        D(I,J,2)=FFSS2(I,J,K)                                           
   12  CONTINUE                                                         
C                                                                       
       DO 13 I=1,IG                                                     
        B(I,1,1)=BBT1(1)+CCT(1)                                         
        B(I,JG,1)=BBT1(JG)+AAT(JG)                                      
        B(I,1,2)=BBT2(1)+CCT(1)                                         
        B(I,JG,2)=BBT2(JG)+AAT(JG)                                      
   13  CONTINUE                                                         
C                                                                       
       CALL TDMASC(AAT,B,CCT,D)                                         
C                                                                       
       DO 14 J=1,JG                                                     
       DO 14 I=1,IG                                                     
        TT1(I,J,K)=D(I,J,1)                                             
        TT2(I,J,K)=D(I,J,2)                                             
   14  CONTINUE                                                         
   11 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K)                                          
      DO 15 J=1,JG                                                      
      DO 15 K=1,KG                                                      
      DO 15 I=1,IG                                                      
       T1(I,J,K)=TT1(I,J,K)                                             
       T2(I,J,K)=TT2(I,J,K)                                             
   15 CONTINUE                                                          
C                                                                       
C---------SCAL.B.C.                                                     
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
      DO 810 J=-2,JG+2                                                  
      DO 810 K=-3,KG+3                                                  
        T1(  -3,J,K)=T1(IG-3,J,K)                                       
        T1(  -2,J,K)=T1(IG-2,J,K)                                       
        T1(  -1,J,K)=T1(IG-1,J,K)                                       
        T1(   0,J,K)=T1(  IG,J,K)                                       
        T1(IG+1,J,K)=T1(   1,J,K)                                       
        T1(IG+2,J,K)=T1(   2,J,K)                                       
        T1(IG+3,J,K)=T1(   3,J,K)                                       
        T2(  -3,J,K)=T2(IG-3,J,K)                                       
        T2(  -2,J,K)=T2(IG-2,J,K)                                       
        T2(  -1,J,K)=T2(IG-1,J,K)                                       
        T2(   0,J,K)=T2(  IG,J,K)                                       
        T2(IG+1,J,K)=T2(   1,J,K)                                       
        T2(IG+2,J,K)=T2(   2,J,K)                                       
        T2(IG+3,J,K)=T2(   3,J,K)                                       
  810 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
      DO 820 J=-2,JG+2                                                  
      DO 820 I=-3,IG+3                                                  
       T1(I,J,  -3)=T1(I,J,KG-3)                                        
       T1(I,J,  -2)=T1(I,J,KG-2)                                        
       T1(I,J,  -1)=T1(I,J,KG-1)                                        
       T1(I,J,   0)=T1(I,J,  KG)                                        
       T1(I,J,KG+1)=T1(I,J,   1)                                        
       T1(I,J,KG+2)=T1(I,J,   2)                                        
       T1(I,J,KG+3)=T1(I,J,   3)                                        
       T2(I,J,  -3)=T2(I,J,KG-3)                                        
       T2(I,J,  -2)=T2(I,J,KG-2)                                        
       T2(I,J,  -1)=T2(I,J,KG-1)                                        
       T2(I,J,   0)=T2(I,J,  KG)                                        
       T2(I,J,KG+1)=T2(I,J,   1)                                        
       T2(I,J,KG+2)=T2(I,J,   2)                                        
       T2(I,J,KG+3)=T2(I,J,   3)                                        
  820 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 830 K=-3,KG+3                                                
        DO 830 I=-3,IG+3                                                
         T1(I,  -2,K)=-T1(I,   3,K)                                     
         T2(I,  -2,K)=-T2(I,   3,K)                                     
         T1(I,  -1,K)=-T1(I,   2,K)                                     
         T2(I,  -1,K)=-T2(I,   2,K)                                     
         T1(I,   0,K)=-T1(I,   1,K)                                     
         T2(I,   0,K)=-T2(I,   1,K)                                     
         T1(I,JG+1,K)=-T1(I,  JG,K)                                     
         T2(I,JG+1,K)=-T2(I,  JG,K)                                     
         T1(I,JG+2,K)=-T1(I,JG-1,K)                                     
         T2(I,JG+2,K)=-T2(I,JG-1,K)                                     
  830   CONTINUE                                                        
C                                                                       
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C====================================================================   
C     CALC. TEMPORARY VELOCITY WITH THE USE OF TDMA (Y-DIRECTION)       
C     1997.12.22 H.ABE                                                  
      SUBROUTINE TDMASC(A,B,C,D)                                        
C====================================================================   
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
C                                                                       
      DIMENSION A(JG+1),B(0:IG,JG,2),C(JG+1),D(0:IG,JG,2),E(0:IG,JG,2)  
C                                                                       
      DO 600 I=1,IG                                                     
       E(I,1,1)=A(1)/B(I,1,1)                                           
       E(I,1,2)=A(1)/B(I,1,2)                                           
       D(I,1,1)=-D(I,1,1)/B(I,1,1)                                      
       D(I,1,2)=-D(I,1,2)/B(I,1,2)                                      
  600 CONTINUE                                                          
C                                                                       
      DO 610 J=2,JG                                                     
      DO 610 I=1,IG                                                     
       B(I,J,1)=B(I,J,1)-C(J)*E(I,J-1,1)                                
       B(I,J,2)=B(I,J,2)-C(J)*E(I,J-1,2)                                
       E(I,J,1)=A(J)/B(I,J,1)                                           
       E(I,J,2)=A(J)/B(I,J,2)                                           
       D(I,J,1)=(-D(I,J,1)+C(J)*D(I,J-1,1))/B(I,J,1)                    
       D(I,J,2)=(-D(I,J,2)+C(J)*D(I,J-1,2))/B(I,J,2)                    
  610 CONTINUE                                                          
C                                                                       
      DO 620 J=JG-1,1,-1                                                
      DO 620 I=1,IG                                                     
       D(I,J,1)=D(I,J,1)+D(I,J+1,1)*E(I,J,1)                            
       D(I,J,2)=D(I,J,2)+D(I,J+1,2)*E(I,J,2)                            
  620 CONTINUE                                                          
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE STCS(PPR1,PPR2,NN)                                     
C                                                                       
C     REVISED ON 2005.01.18  BY T.TSUKAHARA                             
C     REVISED ON 2001.03.04  BY H.ABE (QA-VT)                           
C     REVISED ON 2000.10.27  BY H.ABE (CON_AVE)                         
C     REVISED ON 2000.10.26  BY H.ABE (TRI,QUAD,CON_AVE)                
C     REVISED ON 2000.10.17  BY H.ABE (QUADRUPLE CORR.)                 
C     REVISED ON 2000.10.17  BY H.ABE (QUADRANT ANALYSIS: VT)           
C     REVISED BY H.ABE (2000.09.30) ADD: TSKEWVT & TFLATVT              
C     REVISED BY H.ABE (2000.09.30) ADD: 3-POINT CORR. (TTT,UTT,ETC)    
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCDATA'                                         
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
      COMMON /SNUM/ NSTCS                                               
      COMMON /SCNM/ NCALC                                               
      COMMON /SCTM/ CALTIM                                              
C                                                                       
C---  LOCAL VARIABLES  -------------------------------------------------
C                                                                       
      DIMENSION U(-4:IG+4,-2:JG+2,-4:KG+4,3)                            
      DIMENSION UT(-4:IG+4,-2:JG+2,-4:KG+4,3)                           
      DIMENSION P(-3:IG+3,-2:JG+2,-3:KG+3)                              
      DIMENSION T1(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION T2(-3:IG+3,-2:JG+2,-3:KG+3)                             
C                                                                       
      DIMENSION EAT1(-2:JG+2)                                           
      DIMENSION EAT2(-2:JG+2)                                           
      DIMENSION TAT1(JG),TRMS1(JG)                                      
      DIMENSION FLXUT1(JG),FLXVT1(JG),FLXWT1(JG)                        
      DIMENSION THFV1(JG),TOTAL1(JG)                                    
      DIMENSION ATHFV1(JG),ATOTAL1(JG)                                  
      DIMENSION TAT2(JG),TRMS2(JG)                                      
      DIMENSION FLXUT2(JG),FLXVT2(JG),FLXWT2(JG)                        
      DIMENSION THFV2(JG),TOTAL2(JG)                                    
      DIMENSION ATHFV2(JG),ATOTAL2(JG)                                  
C                                                                       
      DIMENSION EA_U(-2:JG+2)                                           
      DIMENSION EA_V(-2:JG+2),EA_W(-2:JG+2),EA_P(-2:JG+2)               
      DIMENSION TA_U(JG),TA_V(JG),TA_W(JG),TA_P(JG),                    
     &          U_RMS(JG),V_RMS(JG),W_RMS(JG),P_RMS(JG)                 
C                                                                       
      DIMENSION TSKEWVT(JG,2),TFLATVT(JG,2)                             
      DIMENSION STVT1(JG,2),STVT2(JG,2)                                 
      DIMENSION FTVT1(JG,2),FTVT2(JG,2)                                 
C                                                                       
      DIMENSION AT1TRI(JG,10),AT1QUAD(JG,19),AQAVT1(JG,4)               
      DIMENSION AT2TRI(JG,10),AT2QUAD(JG,19),AQAVT2(JG,4)               
C                                                                       
      DIMENSION NQAVT(JG,4,2)                                           
      DIMENSION ANQAVT(JG,4,2)                                          
C                                                                       
      COMMON /RVXZ/ PXZ                                                 
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /VELO/ UG(-4:IG+4,-2:JG+2,-4:KG+4,3)                       
      COMMON /TEMP/ UTG(-4:IG+4,-2:JG+2,-4:KG+4,3)                      
      COMMON /SCAL/ PG(-3:IG+3,-2:JG+2,-3:KG+3)                         
C                                                                       
      COMMON /TEM1/ T1G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /TEM2/ T2G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /ETM1/ EAT1G(-2:JG+2)                                      
      COMMON /ETM2/ EAT2G(-2:JG+2)                                      
      COMMON /TTM1/ TAT1G(JG),TRMS1G(JG),                               
     &              FLXUT1G(JG),FLXVT1G(JG),FLXWT1G(JG)                 
C                                                                       
      COMMON /TTM2/ TAT2G(JG),TRMS2G(JG),                               
     &              FLXUT2G(JG),FLXVT2G(JG),FLXWT2G(JG)                 
C                                                                       
      COMMON /THF1/ ATHFV1G(JG),ATOTAL1G(JG)                            
      COMMON /THF2/ ATHFV2G(JG),ATOTAL2G(JG)                            
C                                                                       
      COMMON /EAVU/ EAGU(-2:JG+2)                                       
      COMMON /EAVE/ EAGV(-2:JG+2),EAGW(-2:JG+2),EAGP(-2:JG+2)           
      COMMON /TAVE/ TAGU(JG),TAGV(JG),TAGW(JG),TAGP(JG),                
     &              UGRMS(JG),VGRMS(JG),WGRMS(JG),PGRMS(JG)             
C                                                                       
      COMMON /TSFVT/ TSKEWVTG(JG,2),TFLATVTG(JG,2)                      
C                                                                       
      COMMON /T1HOA/ AT1TRIG(JG,10),AT1QUADG(JG,19),AQAVT1G(JG,4)       
      COMMON /T2HOA/ AT2TRIG(JG,10),AT2QUADG(JG,19),AQAVT2G(JG,4)       
C                                                                       
      COMMON /NQAC/ NQACU,NQACT                                         
      COMMON /NQAVT/ ANQAVTG(JG,4,2)                                    
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (UG,U),(UTG,UT),(PG,P)                                
C                                                                       
      EQUIVALENCE (T1G,T1),(T2G,T2)                                     
      EQUIVALENCE (EAT1G,EAT1),(EAT2G,EAT2)                             
      EQUIVALENCE (TAT1G,TAT1),(TRMS1G,TRMS1),                          
     &            (FLXUT1G,FLXUT1),(FLXVT1G,FLXVT1),(FLXWT1G,FLXWT1),   
     &            (ATHFV1G,ATHFV1),(ATOTAL1G,ATOTAL1)                   
      EQUIVALENCE (TAT2G,TAT2),(TRMS2G,TRMS2),                          
     &            (FLXUT2G,FLXUT2),(FLXVT2G,FLXVT2),(FLXWT2G,FLXWT2),   
     &            (ATHFV2G,ATHFV2),(ATOTAL2G,ATOTAL2)                   
C                                                                       
      EQUIVALENCE (EAGU,EA_U),(EAGV,EA_V),                              
     &            (EAGW,EA_W),(EAGP,EA_P)                               
      EQUIVALENCE (TAGU,TA_U),(TAGV,TA_V),                              
     &            (TAGW,TA_W),(TAGP,TA_P)                               
      EQUIVALENCE (UGRMS,U_RMS),(VGRMS,V_RMS),                          
     &            (WGRMS,W_RMS),(PGRMS,P_RMS)                           
c                                                                       
      EQUIVALENCE (TSKEWVTG,TSKEWVT),(TFLATVTG,TFLATVT)                 
C                                                                       
      EQUIVALENCE (AT1TRIG,AT1TRI),(AT1QUADG,AT1QUAD),                  
     &            (AQAVT1G,AQAVT1)                                      
      EQUIVALENCE (AT2TRIG,AT2TRI),(AT2QUADG,AT2QUAD),                  
     &            (AQAVT2G,AQAVT2)                                      
C                                                                       
      EQUIVALENCE (ANQAVTG,ANQAVT)                                      
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
      DO 10 J=-2,JG+2                                                   
       EA_U(J)=0.0D0                                                    
       EA_V(J)=0.0D0                                                    
       EA_W(J)=0.0D0                                                    
       EA_P(J)=0.0D0                                                    
       EAT1(J)=0.0D0                                                    
       EAT2(J)=0.0D0                                                    
   10 CONTINUE                                                          
C                                                                       
      DO 11 J=1,JG                                                      
       THFV1(J)=0.0D0                                                   
       THFV2(J)=0.0D0                                                   
       TOTAL1(J)=0.0D0                                                  
       TOTAL2(J)=0.0D0                                                  
       STVT1(J,1)=0.0D0                                                 
       STVT2(J,1)=0.0D0                                                 
       STVT1(J,2)=0.0D0                                                 
       STVT2(J,2)=0.0D0                                                 
       FTVT1(J,1)=0.0D0                                                 
       FTVT2(J,1)=0.0D0                                                 
       FTVT1(J,2)=0.0D0                                                 
       FTVT2(J,2)=0.0D0                                                 
   11 CONTINUE                                                          
C                                                                       
      DO 12 J=1,JG                                                      
       NQAVT(J,1,1)=0                                                   
       NQAVT(J,2,1)=0                                                   
       NQAVT(J,3,1)=0                                                   
       NQAVT(J,4,1)=0                                                   
       NQAVT(J,1,2)=0                                                   
       NQAVT(J,2,2)=0                                                   
       NQAVT(J,3,2)=0                                                   
       NQAVT(J,4,2)=0                                                   
   12 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K)                                          
      DO 20 J=-2,JG+2                                                   
      DO 20 K=1,KG                                                      
      DO 20 I=1,IG                                                      
       EA_U(J)=EA_U(J)+U(I,J,K,1)                                       
       EA_V(J)=EA_V(J)+U(I,J,K,2)                                       
       EA_W(J)=EA_W(J)+U(I,J,K,3)                                       
       EA_P(J)=EA_P(J)+P(I,J,K)                                         
       EAT1(J)=EAT1(J)+T1(I,J,K)                                        
       EAT2(J)=EAT2(J)+T2(I,J,K)                                        
   20 CONTINUE                                                          
C                                                                       
      DO 30 J=-2,JG+2                                                   
       EA_U(J)=EA_U(J)*PXZ                                              
       EA_V(J)=EA_V(J)*PXZ                                              
       EA_W(J)=EA_W(J)*PXZ                                              
       EA_P(J)=EA_P(J)*PXZ                                              
       EAT1(J)=EAT1(J)*PXZ                                              
       EAT2(J)=EAT2(J)*PXZ                                              
   30 CONTINUE                                                          
C                                                                       
C                                                                       
C========================= UT ZERO-CLEAR                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K)                                          
      DO 140 J=-2,JG+2                                                  
      DO 140 K=-4,KG+4                                                  
      DO 140 I=-4,IG+4                                                  
        UT(I,J,K,1)=0.0D0                                               
        UT(I,J,K,2)=0.0D0                                               
        UT(I,J,K,3)=0.0D0                                               
  140 CONTINUE                                                          
C                                                                       
C========================= PRODUCING VT                                 
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K)                                          
      DO 150 J=1,JG                                                     
      DO 150 K=1,KG                                                     
      DO 150 I=1,IG                                                     
       UT(I,J,K,1)=(((T1(I,J+1,K)-EAT1(J+1))*DR(J)+                     
     &              (T1(I,J,K)-EAT1(J))*DR(J+1))/(DR(J)+DR(J+1))        
     &             *(U(I,J,K,2)-EA_V(J)))                               
       UT(I,J,K,2)=(((T2(I,J+1,K)-EAT2(J+1))*DR(J)+                     
     &              (T2(I,J,K)-EAT2(J))*DR(J+1))/(DR(J)+DR(J+1))        
     &             *(U(I,J,K,2)-EA_V(J)))                               
  150 CONTINUE                                                          
C                                                                       
       NQACT=NQACT+1                                                    
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K)                                          
      DO 60 J=1,JG                                                      
      DO 60 K=1,KG                                                      
      DO 60 I=1,IG                                                      
       THFV1(J)=THFV1(J)+UT(I,J,K,1)                                    
       THFV2(J)=THFV2(J)+UT(I,J,K,2)                                    
C                                                                       
       STVT1(J,1)=STVT1(J,1)+UT(I,J,K,1)**3                             
       STVT2(J,1)=STVT2(J,1)+UT(I,J,K,2)**3                             
       STVT1(J,2)=STVT1(J,2)+UT(I,J,K,1)**2                             
       STVT2(J,2)=STVT2(J,2)+UT(I,J,K,2)**2                             
       FTVT1(J,1)=FTVT1(J,1)+UT(I,J,K,1)**4                             
       FTVT2(J,1)=FTVT2(J,1)+UT(I,J,K,2)**4                             
       FTVT1(J,2)=FTVT1(J,2)+UT(I,J,K,1)**2                             
       FTVT2(J,2)=FTVT2(J,2)+UT(I,J,K,2)**2                             
C                                                                       
C========================= VT(PR1) CONVENTIONAL AVE.                    
       IF(UT(I,J,K,1).GE.0) THEN                                        
        GO TO 1000                                                      
       ELSE                                                             
        GO TO 1100                                                      
       ENDIF                                                            
 1000   IF((U(I,J,K,2)-EA_V(J)).GE.0) THEN                              
         AQAVT1(J,1)=AQAVT1(J,1)+UT(I,J,K,1)                            
         NQAVT(J,1,1)=NQAVT(J,1,1)+1                                    
        ELSE                                                            
         AQAVT1(J,3)=AQAVT1(J,3)+UT(I,J,K,1)                            
         NQAVT(J,3,1)=NQAVT(J,3,1)+1                                    
        ENDIF                                                           
        GO TO 1200                                                      
 1100   IF((U(I,J,K,2)-EA_V(J)).GE.0) THEN                              
         AQAVT1(J,2)=AQAVT1(J,2)+UT(I,J,K,1)                            
         NQAVT(J,2,1)=NQAVT(J,2,1)+1                                    
        ELSE                                                            
         AQAVT1(J,4)=AQAVT1(J,4)+UT(I,J,K,1)                            
         NQAVT(J,4,1)=NQAVT(J,4,1)+1                                    
        ENDIF                                                           
        GO TO 1200                                                      
 1200  CONTINUE                                                         
C                                                                       
C========================= VT(PR2) CONVENTIONAL AVE.                    
       IF(UT(I,J,K,2).GE.0) THEN                                        
        GO TO 2000                                                      
       ELSE                                                             
        GO TO 2100                                                      
       ENDIF                                                            
 2000   IF((U(I,J,K,2)-EA_V(J)).GE.0) THEN                              
         AQAVT2(J,1)=AQAVT2(J,1)+UT(I,J,K,2)                            
         NQAVT(J,1,2)=NQAVT(J,1,2)+1                                    
        ELSE                                                            
         AQAVT2(J,3)=AQAVT2(J,3)+UT(I,J,K,2)                            
         NQAVT(J,3,2)=NQAVT(J,3,2)+1                                    
        ENDIF                                                           
        GO TO 2200                                                      
 2100   IF((U(I,J,K,2)-EA_V(J)).GE.0) THEN                              
         AQAVT2(J,2)=AQAVT2(J,2)+UT(I,J,K,2)                            
         NQAVT(J,2,2)=NQAVT(J,2,2)+1                                    
        ELSE                                                            
         AQAVT2(J,4)=AQAVT2(J,4)+UT(I,J,K,2)                            
         NQAVT(J,4,2)=NQAVT(J,4,2)+1                                    
        ENDIF                                                           
        GO TO 2200                                                      
 2200  CONTINUE                                                         
C                                                                       
   60 CONTINUE                                                          
C                                                                       
      DO 70 J=1,JG                                                      
       THFV1(J)=THFV1(J)*PXZ                                            
       THFV2(J)=THFV2(J)*PXZ                                            
       TOTAL1(J)=-(EAT1(J+1)-EAT1(J))/DRR(J+1)*PPR1/RE+THFV1(J)         
       TOTAL2(J)=-(EAT2(J+1)-EAT2(J))/DRR(J+1)*PPR2/RE+THFV2(J)         
   70 CONTINUE                                                          
C                                                                       
      DO 71 J=1,JG-1                                                    
       STVT1(J,1)=STVT1(J,1)*PXZ                                        
       STVT2(J,1)=STVT2(J,1)*PXZ                                        
       STVT1(J,2)=DSQRT((STVT1(J,2)*PXZ)**3)                            
       STVT2(J,2)=DSQRT((STVT2(J,2)*PXZ)**3)                            
       FTVT1(J,1)=FTVT1(J,1)*PXZ                                        
       FTVT2(J,1)=FTVT2(J,1)*PXZ                                        
       FTVT1(J,2)=(FTVT1(J,2)*PXZ)**2                                   
       FTVT2(J,2)=(FTVT2(J,2)*PXZ)**2                                   
       TSKEWVT(J,1)=TSKEWVT(J,1)+STVT1(J,1)/STVT1(J,2)                  
       TSKEWVT(J,2)=TSKEWVT(J,2)+STVT2(J,1)/STVT2(J,2)                  
       TFLATVT(J,1)=TFLATVT(J,1)+FTVT1(J,1)/FTVT1(J,2)                  
       TFLATVT(J,2)=TFLATVT(J,2)+FTVT2(J,1)/FTVT2(J,2)                  
   71 CONTINUE                                                          
C                                                                       
      DO 72 J=1,JG                                                      
         ANQAVT(J,1,1)=ANQAVT(J,1,1)+NQAVT(J,1,1)*PXZ                   
         ANQAVT(J,2,1)=ANQAVT(J,2,1)+NQAVT(J,2,1)*PXZ                   
         ANQAVT(J,3,1)=ANQAVT(J,3,1)+NQAVT(J,3,1)*PXZ                   
         ANQAVT(J,4,1)=ANQAVT(J,4,1)+NQAVT(J,4,1)*PXZ                   
         ANQAVT(J,1,2)=ANQAVT(J,1,2)+NQAVT(J,1,2)*PXZ                   
         ANQAVT(J,2,2)=ANQAVT(J,2,2)+NQAVT(J,2,2)*PXZ                   
         ANQAVT(J,3,2)=ANQAVT(J,3,2)+NQAVT(J,3,2)*PXZ                   
         ANQAVT(J,4,2)=ANQAVT(J,4,2)+NQAVT(J,4,2)*PXZ                   
   72 CONTINUE                                                          
C                                                                       
      DO 40 J=1,JG                                                      
       TA_U(J)=TA_U(J)+EA_U(J)                                          
       TA_V(J)=TA_V(J)+EA_V(J)                                          
       TA_W(J)=TA_W(J)+EA_W(J)                                          
       TA_P(J)=TA_P(J)+EA_P(J)                                          
       TAT1(J)=TAT1(J)+EAT1(J)                                          
       TAT2(J)=TAT2(J)+EAT2(J)                                          
       ATHFV1(J)=ATHFV1(J)+THFV1(J)                                     
       ATHFV2(J)=ATHFV2(J)+THFV2(J)                                     
       ATOTAL1(J)=ATOTAL1(J)+TOTAL1(J)                                  
       ATOTAL2(J)=ATOTAL2(J)+TOTAL2(J)                                  
   40 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K)                                          
      DO 50 J=1,JG                                                      
      DO 50 K=1,KG                                                      
      DO 50 I=1,IG                                                      
       U_RMS(J)=U_RMS(J)+( U(I,J,K,1)-EA_U(J) )**2                      
       V_RMS(J)=V_RMS(J)+( U(I,J,K,2)-EA_V(J) )**2                      
       W_RMS(J)=W_RMS(J)+( U(I,J,K,3)-EA_W(J) )**2                      
       P_RMS(J)=P_RMS(J)+( P(I,J,K)-EA_P(J) )**2                        
       TRMS1(J)=TRMS1(J)+( T1(I,J,K)-EAT1(J) )**2                       
       TRMS2(J)=TRMS2(J)+( T2(I,J,K)-EAT2(J) )**2                       
C                                                                       
       FLXUT1(J)=  FLXUT1(J)                                            
     &           + 0.5D0*(  ( U(I,J,K,1)-EA_U(J) )                      
     &                     +( U(I-1,J,K,1)-EA_U(J) ) )                  
     &            *( T1(I,J,K)-EAT1(J) )                                
       FLXUT2(J)=  FLXUT2(J)                                            
     &           + 0.5D0*(  ( U(I,J,K,1)-EA_U(J) )                      
     &                     +( U(I-1,J,K,1)-EA_U(J) ) )                  
     &            *( T2(I,J,K)-EAT2(J) )                                
C                                                                       
       FLXVT1(J)=  FLXVT1(J)                                            
     &           + 0.5D0*(  ( U(I,J,K,2)-EA_V(J) )                      
     &                     +( U(I,J-1,K,2)-EA_V(J-1) ) )                
     &            *( T1(I,J,K)-EAT1(J) )                                
       FLXVT2(J)=  FLXVT2(J)                                            
     &           + 0.5D0*(  ( U(I,J,K,2)-EA_V(J) )                      
     &                     +( U(I,J-1,K,2)-EA_V(J-1) ) )                
     &            *( T2(I,J,K)-EAT2(J) )                                
C                                                                       
       FLXWT1(J)=  FLXWT1(J)                                            
     &           + 0.5D0*(  ( U(I,J,K,3)-EA_W(J) )                      
     &                     +( U(I,J,K-1,3)-EA_W(J) ) )                  
     &            *( T1(I,J,K)-EAT1(J) )                                
       FLXWT2(J)=  FLXWT2(J)                                            
     &           + 0.5D0*(  ( U(I,J,K,3)-EA_W(J) )                      
     &                     +( U(I,J,K-1,3)-EA_W(J) ) )                  
     &            *( T2(I,J,K)-EAT2(J) )                                
C                                                                       
       AT1TRI(J,1)=AT1TRI(J,1)+                                         
     &         (T1(I,J,K)-EAT1(J))**3                                   
       AT2TRI(J,1)=AT2TRI(J,1)+                                         
     &         (T2(I,J,K)-EAT2(J))**3                                   
C                                                                       
       AT1TRI(J,2)=AT1TRI(J,2)+                                         
     &          (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))   
     &         *(T1(I,J,K)-EAT1(J))**2                                  
       AT2TRI(J,2)=AT2TRI(J,2)+                                         
     &          (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))   
     &         *(T2(I,J,K)-EAT2(J))**2                                  
       AT1TRI(J,3)=AT1TRI(J,3)+                                         
     &          (0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))) 
     &         *(T1(I,J,K)-EAT1(J))**2                                  
       AT2TRI(J,3)=AT2TRI(J,3)+                                         
     &          (0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))) 
     &         *(T2(I,J,K)-EAT2(J))**2                                  
       AT1TRI(J,4)=AT1TRI(J,4)+                                         
     &          (0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))   
     &         *(T1(I,J,K)-EAT1(J))**2                                  
       AT2TRI(J,4)=AT2TRI(J,4)+                                         
     &          (0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))   
     &         *(T2(I,J,K)-EAT2(J))**2                                  
C                                                                       
       AT1TRI(J,5)=AT1TRI(J,5)+                                         
     &          (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**2
     &         *(T1(I,J,K)-EAT1(J))                                     
       AT2TRI(J,5)=AT2TRI(J,5)+                                         
     &          (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**2
     &         *(T2(I,J,K)-EAT2(J))                                     
       AT1TRI(J,6)=AT1TRI(J,6)+                                         
     &          0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))   
     &         *0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))   
     &         *(T1(I,J,K)-EAT1(J))                                     
       AT2TRI(J,6)=AT2TRI(J,6)+                                         
     &          0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))   
     &         *0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))   
     &         *(T2(I,J,K)-EAT2(J))                                     
       AT1TRI(J,7)=AT1TRI(J,7)+                                         
     &          (0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))**2
     &         *(T1(I,J,K)-EAT1(J))                                     
       AT2TRI(J,7)=AT2TRI(J,7)+                                         
     &          (0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))**2
     &         *(T2(I,J,K)-EAT2(J))                                     
C                                                                       
       AT1TRI(J,8)=AT1TRI(J,8)+                                         
     &          0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J)))     
     &         *0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))   
     &         *(T1(I,J,K)-EAT1(J))                                     
       AT2TRI(J,8)=AT2TRI(J,8)+                                         
     &          0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J)))     
     &         *0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))   
     &         *(T2(I,J,K)-EAT2(J))                                     
C                                                                       
       AT1TRI(J,9)=AT1TRI(J,9)+                                         
     &          0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J)))     
     &         *0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J)))     
     &         *(T1(I,J,K)-EAT1(J))                                     
       AT2TRI(J,9)=AT2TRI(J,9)+                                         
     &          0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J)))     
     &         *0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J)))     
     &         *(T2(I,J,K)-EAT2(J))                                     
C                                                                       
       AT1TRI(J,10)=AT1TRI(J,10)+                                       
     &          0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J)))     
     &         *0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))   
     &         *(T1(I,J,K)-EAT1(J))                                     
       AT2TRI(J,10)=AT2TRI(J,10)+                                       
     &          0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J)))     
     &         *0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))   
     &         *(T2(I,J,K)-EAT2(J))                                     
C                                                                       
       AT1QUAD(J,1)=AT1QUAD(J,1)+                                       
     &         (T1(I,J,K)-EAT1(J))**4                                   
       AT2QUAD(J,1)=AT2QUAD(J,1)+                                       
     &         (T2(I,J,K)-EAT2(J))**4                                   
C                                                                       
       AT1QUAD(J,2)=AT1QUAD(J,2)+                                       
     &          (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))   
     &         *((T1(I,J,K)-EAT1(J))**3)                                
       AT2QUAD(J,2)=AT2QUAD(J,2)+                                       
     &          (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))   
     &         *((T2(I,J,K)-EAT2(J))**3)                                
C                                                                       
       AT1QUAD(J,3)=AT1QUAD(J,3)+                                       
     &          (0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))) 
     &         *((T1(I,J,K)-EAT1(J))**3)                                
       AT2QUAD(J,3)=AT2QUAD(J,3)+                                       
     &          (0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)))) 
     &         *((T2(I,J,K)-EAT2(J))**3)                                
C                                                                       
       AT1QUAD(J,4)=AT1QUAD(J,4)+                                       
     &          (0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))   
     &         *((T1(I,J,K)-EAT1(J))**3)                                
       AT2QUAD(J,4)=AT2QUAD(J,4)+                                       
     &          (0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))   
     &         *((T2(I,J,K)-EAT2(J))**3)                                
C                                                                       
       AT1QUAD(J,5)=AT1QUAD(J,5)+                                       
     &      ((0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**2)  
     &     *((T1(I,J,K)-EAT1(J))**2)                                    
       AT2QUAD(J,5)=AT2QUAD(J,5)+                                       
     &      ((0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**2)  
     &     *((T2(I,J,K)-EAT2(J))**2)                                    
C                                                                       
       AT1QUAD(J,6)=AT1QUAD(J,6)+                                       
     &     ((0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))**2) 
     &    *((T1(I,J,K)-EAT1(J))**2)                                     
       AT2QUAD(J,6)=AT2QUAD(J,6)+                                       
     &     ((0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))**2) 
     &    *((T2(I,J,K)-EAT2(J))**2)                                     
C                                                                       
       AT1QUAD(J,7)=AT1QUAD(J,7)+                                       
     &      ((0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))**2)  
     &     *((T1(I,J,K)-EAT1(J))**2)                                    
       AT2QUAD(J,7)=AT2QUAD(J,7)+                                       
     &      ((0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))**2)  
     &     *((T2(I,J,K)-EAT2(J))**2)                                    
C                                                                       
       AT1QUAD(J,8)=AT1QUAD(J,8)+                                       
     &        (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))     
     &        *(0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))  
     &        *((T1(I,J,K)-EAT1(J))**2)                                 
       AT2QUAD(J,8)=AT2QUAD(J,8)+                                       
     &         (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))    
     &        *(0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))  
     &        *((T2(I,J,K)-EAT2(J))**2)                                 
C                                                                       
       AT1QUAD(J,9)=AT1QUAD(J,9)+                                       
     &          (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))   
     &         *(0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))   
     &         *((T1(I,J,K)-EAT1(J))**2)                                
       AT2QUAD(J,9)=AT2QUAD(J,9)+                                       
     &          (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))   
     &         *(0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))   
     &         *((T2(I,J,K)-EAT2(J))**2)                                
C                                                                       
       AT1QUAD(J,10)=AT1QUAD(J,10)+                                     
     &         (0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))    
     &        *(0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))  
     &        *((T1(I,J,K)-EAT1(J))**2)                                 
       AT2QUAD(J,10)=AT2QUAD(J,10)+                                     
     &         (0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))    
     &        *(0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))  
     &        *((T2(I,J,K)-EAT2(J))**2)                                 
C                                                                       
       AT1QUAD(J,11)=AT1QUAD(J,11)+                                     
     &      ((0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**3)  
     &     *(T1(I,J,K)-EAT1(J))                                         
       AT2QUAD(J,11)=AT2QUAD(J,11)+                                     
     &      ((0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**3)  
     &     *(T2(I,J,K)-EAT2(J))                                         
C                                                                       
       AT1QUAD(J,12)=AT1QUAD(J,12)+                                     
     &    (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))         
     &   *((0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))**2)  
     &   *(T1(I,J,K)-EAT1(J))                                           
       AT2QUAD(J,12)=AT2QUAD(J,12)+                                     
     &    (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))         
     &   *((0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))**2)  
     &   *(T2(I,J,K)-EAT2(J))                                           
C                                                                       
       AT1QUAD(J,13)=AT1QUAD(J,13)+                                     
     &    (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))         
     &   *((0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))**2)    
     &   *(T1(I,J,K)-EAT1(J))                                           
       AT2QUAD(J,13)=AT2QUAD(J,13)+                                     
     &    (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))         
     &   *((0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))**2)    
     &   *(T2(I,J,K)-EAT2(J))                                           
C                                                                       
       AT1QUAD(J,14)=AT1QUAD(J,14)+                                     
     &    ((0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**2)    
     &   *(0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))       
     &   *(T1(I,J,K)-EAT1(J))                                           
       AT2QUAD(J,14)=AT2QUAD(J,14)+                                     
     &    ((0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**2)    
     &   *(0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))       
     &   *(T2(I,J,K)-EAT2(J))                                           
C                                                                       
       AT1QUAD(J,15)=AT1QUAD(J,15)+                                     
     &    ((0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**2)    
     &   *(0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))         
     &   *(T1(I,J,K)-EAT1(J))                                           
       AT2QUAD(J,15)=AT2QUAD(J,15)+                                     
     &    ((0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))**2)    
     &   *(0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))         
     &   *(T2(I,J,K)-EAT2(J))                                           
C                                                                       
       AT1QUAD(J,16)=AT1QUAD(J,16)+                                     
     &        (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))     
     &       *(0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))     
     &       *(0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))   
     &       *(T1(I,J,K)-EAT1(J))                                       
       AT2QUAD(J,16)=AT2QUAD(J,16)+                                     
     &        (0.5D0*((U(I,J,K,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))))     
     &       *(0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))     
     &       *(0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))   
     &       *(T2(I,J,K)-EAT2(J))                                       
C                                                                       
       AT1QUAD(J,17)=AT1QUAD(J,17)+                                     
     &    ((0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))**3)  
     &   *(T1(I,J,K)-EAT1(J))                                           
       AT2QUAD(J,17)=AT2QUAD(J,17)+                                     
     &    ((0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))**3)  
     &   *(T2(I,J,K)-EAT2(J))                                           
C                                                                       
       AT1QUAD(J,18)=AT1QUAD(J,18)+                                     
     &      (0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))     
     &     *((0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))**2)  
     &     *(T1(I,J,K)-EAT1(J))                                         
       AT2QUAD(J,18)=AT2QUAD(J,18)+                                     
     &      (0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))     
     &     *((0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))**2)  
     &     *(T2(I,J,K)-EAT2(J))                                         
C                                                                       
       AT1QUAD(J,19)=AT1QUAD(J,19)+                                     
     &    ((0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))**2)  
     &   *(0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))         
     &   *(T1(I,J,K)-EAT1(J))                                           
       AT2QUAD(J,19)=AT2QUAD(J,19)+                                     
     &    ((0.5D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1))))**2)  
     &   *(0.5D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))))         
     &   *(T2(I,J,K)-EAT2(J))                                           
C                                                                       
   50 CONTINUE                                                          
C                                                                       
C-----------------------------------------------------------------------
C                                                                       
      IF(MOD(NN,1000).EQ.0) THEN                                        
       PSTC=1.0/DBLE(NSTCS)                                             
       TEMP1CL=EAT1G(JG/2)/DABS(ATOTAL1G(1)*PSTC)                       
       ATAT1CL=TAT1G(JG/2)/DABS(ATOTAL1G(1))                            
       TEMP2CL=(EAT2G(JG/2)+R(JG/2))                                    
       ATAT2CL=((TAT2G(JG/2)*PSTC)+R(JG/2))                             
C                                                                       
       UBULK=0.0D0                                                      
       T1BULK=0.0D0                                                     
       T2BULK=0.0D0                                                     
C                                                                       
      DO 100 J=1,JG                                                     
        UBULK=UBULK+DR(J)*EA_U(J)                                       
        T1BULK=T1BULK+DR(J)*EA_U(J)*EAT1G(J)                            
        T2BULK=T2BULK+DR(J)*EA_U(J)*(EAT2G(J)+R(J))                     
  100 CONTINUE                                                          
C                                                                       
       T1BULK=T1BULK/UBULK/DABS(ATOTAL1G(1)*PSTC)                       
       T2BULK=T2BULK/UBULK                                              
C                                                                       
      OPEN(42,ACCESS='APPEND')                                          
      WRITE(42,'(I9, E13.6, 6F8.4)')                                    
     & NCALC, CALTIM, TEMP1CL, ATAT1CL, T1BULK                          
     &              , TEMP2CL, ATAT2CL, T2BULK                          
      CLOSE(42)                                                         
      ENDIF                                                             
C                                                                       
C--------------                                                         
C                                                                       
C      NNN=NUM/500                                                       
C      NONE=MOD(NNN,10)                                                  
C      NTEN=MOD(NNN,100)-MOD(NNN,10)                                     
C      NHUN=MOD(NNN,1000)-MOD(NNN,100)                                   
C      NUMM=CHAR(48+NHUN/100)//CHAR(48+NTEN/10)//CHAR(48+NONE)           
CC                                                                       
C      OPEN(91, FILE='/fshome/home01/s21437/POIFLW/CH064W/MOV/ch064w_t12'
C     &//NUMM//'.dat'                                                    
C     &, STATUS='UNKNOWN')                                               
C       DO 910 K=1,KG,4                                                  
C       DO 910 J=1,JG/2,2                                                
C       DO 910 I=1,IG,4                                                  
C        WRITE(91,'(2E14.6)') UT(I,J,K,1),DINV2(I,J,K)                   
C  910  CONTINUE                                                         
C      CLOSE(91)                                                         
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE BUDGEK1(PPR,COE_BD)                                    
C                                                                       
C     REVISED BY H.ABE (2000.10.15) DISSIPATION RATE (BUDGET OF VT)     
C     REVISED BY H.ABE (2000.10.15) ADD: PTG,PDF (BUDGET OF UT,VT,WT)   
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
C---- LOCAL VARIABLES --------------------------------------------------
C                                                                       
      DIMENSION U(-4:IG+4,-2:JG+2,-4:KG+4,3)                            
      DIMENSION P(-3:IG+3,-2:JG+2,-3:KG+3)                              
      DIMENSION T(-3:IG+3,-2:JG+2,-3:KG+3)                              
      DIMENSION EA_T(-2:JG+2)                                           
C                                                                       
      DIMENSION PRO_TV(JG),DIS_TV(JG),                                  
     &          TDF_TV(JG),RMDFTV(JG)                                   
      DIMENSION PRO_UT(JG),DIS_UT(JG),TPG_UT(JG),                       
     &          TDF_UT(JG),RMDFUT(JG),PTG_UT(JG),PDF_UT(JG)             
      DIMENSION PRO_VT(JG),DIS_VT(JG),TPG_VT(JG),                       
     &          TDF_VT(JG),RMDFVT(JG),PTG_VT(JG),PDF_VT(JG)             
      DIMENSION PRO_WT(JG),DIS_WT(JG),TPG_WT(JG),                       
     &          TDF_WT(JG),RMDFWT(JG),PTG_WT(JG),PDF_WT(JG)             
C                                                                       
      DIMENSION EA_U(-2:JG+2)                                           
      DIMENSION EA_V(-2:JG+2),EA_W(-2:JG+2),EA_P(-2:JG+2)               
C                                                                       
      COMMON /FD1C/ CEN1_F(0:JG,2),CEN1_M(0:JG,2),CEN1_B(0:JG,2)        
      COMMON /FD2C/ CEN2_F(0:JG,2),CEN2_M(0:JG,2),CEN2_B(0:JG,2)        
      COMMON /RVTL/ PTTL                                                
C                                                                       
C---- GLOBAL VARIABLES -------------------------------------------------
C                                                                       
      COMMON /VELO/ UG(-4:IG+4,-2:JG+2,-4:KG+4,3)                       
      COMMON /SCAL/ PG(-3:IG+3,-2:JG+2,-3:KG+3)                         
      COMMON /TEM1/ TG(-3:IG+3,-2:JG+2,-3:KG+3)                         
      COMMON /ETM1/ EATG(-2:JG+2)                                       
C                                                                       
      COMMON /EAVU/ EAGU(-2:JG+2)                                       
      COMMON /EAVE/ EAGV(-2:JG+2),EAGW(-2:JG+2),EAGP(-2:JG+2)           
C                                                                       
      COMMON /KON1/ PRO_TG(JG),DIS_TG(JG),                              
     &              TDF_TG(JG),RMDFTG(JG),                              
     &              PRO_UG(JG),DIS_UG(JG),TPG_UG(JG),                   
     &              TDF_UG(JG),RMDFUG(JG),PTG_UG(JG),PDF_UG(JG),        
     &              PRO_VG(JG),DIS_VG(JG),TPG_VG(JG),                   
     &              TDF_VG(JG),RMDFVG(JG),PTG_VG(JG),PDF_VG(JG),        
     &              PRO_WG(JG),DIS_WG(JG),TPG_WG(JG),                   
     &              TDF_WG(JG),RMDFWG(JG),PTG_WG(JG),PDF_WG(JG)         
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (UG,U),(PG,P)                                         
      EQUIVALENCE (TG,T)                                                
      EQUIVALENCE (EATG,EA_T)                                           
      EQUIVALENCE (EAGU,EA_U),(EAGV,EA_V),                              
     &            (EAGW,EA_W),(EAGP,EA_P)                               
      EQUIVALENCE (PRO_TG,PRO_TV),(DIS_TG,DIS_TV),                      
     &            (TDF_TG,TDF_TV),(RMDFTG,RMDFTV)                       
      EQUIVALENCE (PRO_UG,PRO_UT),(DIS_UG,DIS_UT),                      
     &            (TPG_UG,TPG_UT),(TDF_UG,TDF_UT),                      
     &            (RMDFUG,RMDFUT),(PTG_UG,PTG_UT),                      
     &            (PDF_UG,PDF_UT)                                       
      EQUIVALENCE (PRO_VG,PRO_VT),(DIS_VG,DIS_VT),                      
     &            (TPG_VG,TPG_VT),(TDF_VG,TDF_VT),                      
     &            (RMDFVG,RMDFVT),(PTG_VG,PTG_VT),                      
     &            (PDF_VG,PDF_VT)                                       
      EQUIVALENCE (PRO_WG,PRO_WT),(DIS_WG,DIS_WT),                      
     &            (TPG_WG,TPG_WT),(TDF_WG,TDF_WT),                      
     &            (RMDFWG,RMDFWT),(PTG_WG,PTG_WT),                      
     &            (PDF_WG,PDF_WT)                                       
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K,ABE4,ABE5,ABE6,ABE7,ABE8,ABE9,ABE10,ABE11)
      DO 10 J=1,JG                                                      
      DO 10 K=1,KG                                                      
      DO 10 I=1,IG                                                      
C                                                                       
C --- BUDGET OF THE TEMPERATURE VARIANCE                                
C                                                                       
      PRO_TV(J)= PRO_TV(J)                                              
     &          + ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(  ( U(I,J,K,1)-EA_U(J) )                       
     &                    +( U(I-1,J,K,1)-EA_U(J) ) )                   
     &           *( 2.0D0*PTTL )                                        
     &          - ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(   ( U(I,J,K,2)-EA_V(J) )                      
     &                     *(  ( EA_T(J+1)-EA_T(J) )                    
     &                        *PDRR(J+1) )                              
     &                    + ( U(I,J-1,K,2)-EA_V(J-1) )                  
     &                     *(  ( EA_T(J)-EA_T(J-1) )                    
     &                        *PDRR(J) ) )                              
C                                                                       
C                                                                       
      TDF_TV(J)= TDF_TV(J)                                              
     &          -0.5D0*(                                                
     &          ((0.5D0*((T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J))))**2   
     &            *(U(I,J,K,1)-EA_U(J))-                                
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J))))**2   
     &            *(U(I-1,J,K,1)-EA_U(J)))*PDX                          
     &         +(((DR(J)*(T(I,J+1,K)-EA_T(J+1))+                        
     &                DR(J+1)*(T(I,J,K)-EA_T(J)))/(DR(J+1)+DR(J)))**2   
     &            *(U(I,J,K,2)-EA_V(J))-                                
     &           ((DR(J-1)*(T(I,J,K)-EA_T(J))+                          
     &              DR(J)*(T(I,J-1,K)-EA_T(J-1)))/(DR(J)+DR(J-1)))**2   
     &            *(U(I,J-1,K,2)-EA_V(J-1)))*PDR(J)                     
     &         +((0.5D0*((T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J))))**2   
     &            *(U(I,J,K,3)-EA_W(J))-                                
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J))))**2   
     &            *(U(I,J,K-1,3)-EA_W(J)))*PDZ                          
     &                  )                                               
C                                                                       
C                                                                       
      RMDFTV(J)= RMDFTV(J)                                              
     &          + 0.5D0*PPR                                             
     &           *(  CEN2_F(J,2)*( ( T(I,J+1,K)-EA_T(J+1) )**2 )        
     &              +CEN2_M(J,2)*( ( T(I,J,K)-EA_T(J) )**2 )            
     &              +CEN2_B(J,2)*( ( T(I,J-1,K)-EA_T(J-1) )**2 ) )      
C                                                                       
C                                                                       
      DIS_TV(J)= DIS_TV(J)                                              
     &          -PPR*(  0.5D0*(  (  (  ( T(I+1,J,K)-EA_T(J) )           
     &                                -( T(I,J,K)-EA_T(J) ) )           
     &                             *PDX )**2                            
     &                          +(  (  ( T(I,J,K)-EA_T(J) )             
     &                                -( T(I-1,J,K)-EA_T(J) ) )         
     &                             *PDX )**2 )                          
     &                 +0.5D0*(  (  (  ( T(I,J,K+1)-EA_T(J) )           
     &                                -( T(I,J,K)-EA_T(J) ) )           
     &                             *PDZ )**2                            
     &                          +(  (  ( T(I,J,K)-EA_T(J) )             
     &                                -( T(I,J,K-1)-EA_T(J) ) )         
     &                             *PDZ )**2 )                          
     &                 +0.5D0*(  (  (  ( T(I,J+1,K)-EA_T(J+1) )         
     &                                -( T(I,J,K)-EA_T(J) ) )           
     &                             *PDRR(J+1) )**2                      
     &                          +(  (  ( T(I,J,K)-EA_T(J) )             
     &                                -( T(I,J-1,K)-EA_T(J-1) ) )       
     &                             *PDRR(J) )**2 ) )                    
C                                                                       
C --- BUDGET OF THE STREAMWISE TURBULENT HEAT FLUX                      
C                                                                       
      PRO_UT(J)= PRO_UT(J)                                              
     &          + 0.5D0*(  ( U(I,J,K,1)-EA_U(J) )                       
     &                    +( U(I-1,J,K,1)-EA_U(J) ) )                   
     &           *0.5D0*(  ( U(I,J,K,1)-EA_U(J) )                       
     &                    +( U(I-1,J,K,1)-EA_U(J) ) )                   
     &           *( 2.0D0*PTTL )                                        
     &          - ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(  0.5D0*(   0.5D0*(  ( U(I+1,J,K,2)-EA_V(J) )  
     &                                       +( U(I,J,K,2)-EA_V(J) ) )  
     &                              *(  ( EA_U(J+1)-EA_U(J) )           
     &                                 *PDRR(J+1) )                     
     &                             + 0.5D0*(  (  U(I+1,J-1,K,2)         
     &                                          -EA_V(J-1) )            
     &                                       +(  U(I,J-1,K,2)           
     &                                          -EA_V(J-1) ) )          
     &                              *(  ( EA_U(J)-EA_U(J-1) )           
     &                                 *PDRR(J) ) )                     
     &                    +0.5D0*(   0.5D0*(  ( U(I,J,K,2)-EA_V(J) )    
     &                                       +( U(I-1,J,K,2)-EA_V(J) ) )
     &                              *(  ( EA_U(J+1)-EA_U(J) )           
     &                                 *PDRR(J+1) )                     
     &                             + 0.5D0*(  ( U(I,J-1,K,2)-EA_V(J-1) )
     &                                       +(  U(I-1,J-1,K,2)         
     &                                          -EA_V(J-1) ) )          
     &                              *(  ( EA_U(J)-EA_U(J-1) )           
     &                                 *PDRR(J) ) ) )                   
     &          - 0.5D0*(  ( U(I-1,J,K,1)-EA_U(J) )                     
     &                    +( U(I,J,K,1)-EA_U(J) ) )                     
     &           *0.5D0*(   ( U(I,J,K,2)-EA_V(J) )                      
     &                     *(  ( EA_T(J+1)-EA_T(J) )                    
     &                        *PDRR(J+1) )                              
     &                    + ( U(I,J-1,K,2)-EA_V(J-1) )                  
     &                     *(  ( EA_T(J)-EA_T(J-1) )                    
     &                        *PDRR(J) ) )                              
C                                                                       
C                                                                       
      TDF_UT(J)= TDF_UT(J)                                              
     &         -((0.5D0*((T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J))))      
     &           *(U(I,J,K,1)-EA_U(J))**2                               
     &         -(0.5D0*((T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J))))       
     &           *(U(I-1,J,K,1)-EA_U(J))**2)*PDX                        
     &         -(((DR(J)*(T(I,J+1,K)-EA_T(J+1))                         
     &              +DR(J+1)*(T(I,J,K)-EA_T(J)))/(DR(J+1)+DR(J)))       
     &           *0.5D0*((DR(J)*(U(I,J+1,K,1)-EA_U(J+1))                
     &               +DR(J+1)*(U(I,J,K,1)-EA_U(J)))/(DR(J+1)+DR(J))     
     &                  +(DR(J)*(U(I-1,J+1,K,1)-EA_U(J+1))              
     &               +DR(J+1)*(U(I-1,J,K,1)-EA_U(J)))/(DR(J+1)+DR(J)))  
     &           *(U(I,J,K,2)-EA_V(J))-                                 
     &           ((DR(J-1)*(T(I,J,K)-EA_T(J))                           
     &              +DR(J)*(T(I,J-1,K)-EA_T(J-1)))/(DR(J)+DR(J-1)))     
     &           *0.5D0*((DR(J-1)*(U(I,J,K,1)-EA_U(J))                  
     &               +DR(J)*(U(I,J-1,K,1)-EA_U(J-1)))/(DR(J)+DR(J-1))   
     &                  +(DR(J-1)*(U(I-1,J,K,1)-EA_U(J))                
     &               +DR(J)*(U(I-1,J-1,K,1)-EA_U(J-1)))/(DR(J)+DR(J-1)))
     &           *(U(I,J-1,K,2)-EA_V(J-1)))*PDR(J)                      
     &         -((0.5D0*((T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K+1,1)-EA_U(J))+(U(I,J,K,1)-EA_U(J))   
     &                +(U(I-1,J,K+1,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))) 
     &           *(U(I,J,K,3)-EA_W(J))-                                 
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K,1)-EA_U(J))+(U(I,J,K-1,1)-EA_U(J))   
     &                +(U(I-1,J,K,1)-EA_U(J))+(U(I-1,J,K-1,1)-EA_U(J))) 
     &           *(U(I,J,K-1,3)-EA_W(J)))*PDZ                           
C                                                                       
C                                                                       
C=============================================== TPG                    
C                                                                       
      TPG_UT(J)= TPG_UT(J)                                              
     &          -0.5D0*( 0.5D0*(( T(I+1,J,K)-EA_T(J) )                  
     &                         +( T(I,J,K)-EA_T(J) ))                   
     &                     *(  ( P(I+1,J,K)-EA_P(J) )                   
     &                        -( P(I,J,K)-EA_P(J) ) )                   
     &                     *PDX                                         
     &                  +0.5D0*(( T(I,J,K)-EA_T(J) )                    
     &                         +( T(I-1,J,K)-EA_T(J) ))                 
     &                     *(  ( P(I,J,K)-EA_P(J) )                     
     &                        -( P(I-1,J,K)-EA_P(J) ) )                 
     &                     *PDX )                                       
C                                                                       
C=============================================== PTG                    
C                                                                       
      PTG_UT(J)= PTG_UT(J)                                              
     &          +0.5D0*( 0.5D0*(( P(I+1,J,K)-EA_P(J) )                  
     &                         +( P(I,J,K)-EA_P(J) ))                   
     &                     *(  ( T(I+1,J,K)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDX                                         
     &                  +0.5D0*(( P(I,J,K)-EA_P(J) )                    
     &                         +( P(I-1,J,K)-EA_P(J) ))                 
     &                     *(  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I-1,J,K)-EA_T(J) ) )                 
     &                     *PDX )                                       
C                                                                       
C=============================================== PDF                    
C                                                                       
      PDF_UT(J)= PDF_UT(J)                                              
     &          -0.5D0*(                                                
     &                   ( ( P(I+1,J,K)-EA_P(J) )                       
     &                    *( T(I+1,J,K)-EA_T(J) )                       
     &                    -( P(I,J,K)-EA_P(J) )                         
     &                    *( T(I,J,K)-EA_T(J) ) )                       
     &                   *PDX                                           
     &                  +( ( P(I,J,K)-EA_P(J) )                         
     &                    *( T(I,J,K)-EA_T(J) )                         
     &                    -( P(I-1,J,K)-EA_P(J) )                       
     &                    *( T(I-1,J,K)-EA_T(J) ) )                     
     &                   *PDX                                           
     &                  )                                               
C                                                                       
C===============================================                        
C                                                                       
      ABE4=   PPR*( (U(I,J,K,1)-EA_U(J))*( (T(I+1,J,K)-EA_T(J))         
     &                                    -(T(I,J,K)-EA_T(J)))*PDX      
     &             -(U(I-1,J,K,1)-EA_U(J))*( (T(I,J,K)-EA_T(J))         
     &                              -(T(I-1,J,K)-EA_T(J)))*PDX )        
     &           *PDX                                                   
C                                                                       
C                                                                       
      ABE5=   PPR*(   (     0.5D0*(  (  U(I,J,K+1,1)                    
     &                                            -EA_U(J) )            
     &                                         +(  U(I-1,J,K+1,1)       
     &                                            -EA_U(J) ) )          
     &                      +0.5D0*(  (  U(I,J,K,1)                     
     &                                              -EA_U(J) )          
     &                                           +(  U(I-1,J,K,1)       
     &                                              -EA_U(J) ) ) )      
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K+1)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDZ )                                       
     &              -(     0.5D0*(  (  U(I,J,K,1)                       
     &                                            -EA_U(J) )            
     &                                         +(  U(I-1,J,K,1)         
     &                                            -EA_U(J) ) )          
     &                      +0.5D0*(  (  U(I,J,K-1,1)                   
     &                                              -EA_U(J) )          
     &                                           +(  U(I-1,J,K-1,1)     
     &                                              -EA_U(J) ) ) )      
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J,K-1)-EA_T(J) ) )                 
     &                     *PDZ ))*PDZ                                  
C                                                                       
C                                                                       
      ABE8=( ( (T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J)))*0.5D0*          
     &       ( (U(I+1,J,K,1)-EA_U(J))-(U(I-1,J,K,1)-EA_U(J)))           
     &       *0.5D0*PDX                                                 
     &      -( (T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J)))*0.5D0*          
     &       ( (U(I,J,K,1)-EA_U(J))-(U(I-2,J,K,1)-EA_U(J)))             
     &       *0.5D0*PDX )*PDX                                           
C                                                                       
C                                                                       
      ABE9=( ( (T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J)))*0.5D0*          
     &       (((U(I,J,K+1,1)-EA_U(J))-(U(I,J,K,1)-EA_U(J)))*PDZ         
     &        +((U(I-1,J,K+1,1)-EA_U(J))-(U(I-1,J,K,1)-EA_U(J)))        
     &          *PDZ)*0.5D0                                             
     &      -( (T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J)))*0.5D0*          
     &       (((U(I,J,K,1)-EA_U(J))-(U(I,J,K-1,1)-EA_U(J)))*PDZ         
     &        +((U(I-1,J,K,1)-EA_U(J))-(U(I-1,J,K-1,1)-EA_U(J)))        
     &          *PDZ)*0.5D0 )*PDZ                                       
C                                                                       
C                                                                       
      RMDFUT(J)= RMDFUT(J)                                              
     &          +(   (  (  DR(J)*( T(I,J+1,K)-EA_T(J+1) )               
     &                    +DR(J+1)*( T(I,J,K)-EA_T(J) ) )               
     &                 *( 0.5D0*PDRR(J+1) ) )                           
     &              *0.5D0*(   (  ( U(I,J+1,K,1)-EA_U(J+1) )            
     &                           -( U(I,J,K,1)-EA_U(J) ) )              
     &                        *PDRR(J+1)                                
     &                       + (  ( U(I-1,J+1,K,1)-EA_U(J+1) )          
     &                           -( U(I-1,J,K,1)-EA_U(J) ) )            
     &                        *PDRR(J+1) )                              
     &             - (  (  DR(J-1)*( T(I,J,K)-EA_T(J) )                 
     &                    +DR(J)*( T(I,J-1,K)-EA_T(J-1) ) )             
     &                 *( 0.5D0*PDRR(J) ) )                             
     &              *0.5D0*(   (  ( U(I,J,K,1)-EA_U(J) )                
     &                           -( U(I,J-1,K,1)-EA_U(J-1) ) )          
     &                        *PDRR(J)                                  
     &                       + (  ( U(I-1,J,K,1)-EA_U(J) )              
     &                           -( U(I-1,J-1,K,1)-EA_U(J-1) ) )        
     &                        *PDRR(J) )                                
     &           )*PDR(J)                                               
     &          +PPR*(   (  (  DR(J)*( 0.5D0*(  (  U(I-1,J+1,K,1)       
     &                                            -EA_U(J+1) )          
     &                                         +(  U(I,J+1,K,1)         
     &                                            -EA_U(J+1) ) ) )      
     &                        +DR(J+1)*( 0.5D0*(  (  U(I-1,J,K,1)       
     &                                              -EA_U(J) )          
     &                                           +(  U(I,J,K,1)         
     &                                              -EA_U(J) ) ) ) )    
     &                     *( 0.5D0*PDRR(J+1) ) )                       
     &                  *(  (  ( T(I,J+1,K)-EA_T(J+1) )                 
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDRR(J+1) )                                 
     &                 - (  (  DR(J-1)*( 0.5D0*(  (  U(I-1,J,K,1)       
     &                                              -EA_U(J) )          
     &                                           +(  U(I,J,K,1)         
     &                                              -EA_U(J) ) ) )      
     &                        +DR(J)*( 0.5D0*(  (  U(I-1,J-1,K,1)       
     &                                            -EA_U(J-1) )          
     &                                         +(  U(I,J-1,K,1)         
     &                                            -EA_U(J-1) ) ) ) )    
     &                     *( 0.5D0*PDRR(J) ) )                         
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J-1,K)-EA_T(J-1) ) )               
     &                     *PDRR(J) )                                   
     &               )*PDR(J)+ABE4+ABE5+ABE8+ABE9                       
C                                                                       
C                                                                       
      DIS_UT(J)= DIS_UT(J)                                              
     &          -0.5D0*(   (  (  ( U(I+1,J,K,1)-EA_U(J) )               
     &                          -( U(I-1,J,K,1)-EA_U(J) ) )             
     &                       *( 0.5D0*PDX ) )                           
     &                    *(  (  ( T(I+1,J,K)-EA_T(J) )                 
     &                          -( T(I,J,K)-EA_T(J) ) )                 
     &                       *PDX )                                     
     &                   + (  (  ( U(I,J,K,1)-EA_U(J) )                 
     &                          -( U(I-2,J,K,1)-EA_U(J) ) )             
     &                       *( 0.5D0*PDX ) )                           
     &                    *(  (  ( T(I,J,K)-EA_T(J) )                   
     &                          -( T(I-1,J,K)-EA_T(J) ) )               
     &                       *PDX ) )                                   
     &          - PPR*(  (  (  ( U(I,J,K,1)-EA_U(J) )                   
     &                        -( U(I-1,J,K,1)-EA_U(J) ) )               
     &                     *PDX )                                       
     &                  *(  (  ( T(I+1,J,K)-EA_T(J) )                   
     &                        -( T(I-1,J,K)-EA_T(J) ) )                 
     &                     *( 0.5D0*PDX ) ) )                           
     &          -COE_BD*(   0.5D0*(   (  ( U(I,J+1,K,1)-EA_U(J+1) )     
     &                                  -( U(I,J,K,1)-EA_U(J) ) )       
     &                               *PDRR(J+1)                         
     &                              + (  ( U(I-1,J+1,K,1)-EA_U(J+1) )   
     &                                  -( U(I-1,J,K,1)-EA_U(J) ) )     
     &                               *PDRR(J+1) )                       
     &                     *(  (  ( T(I,J+1,K)-EA_T(J+1) )              
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDRR(J+1) )                              
     &                    + 0.5D0*(   (  ( U(I,J,K,1)-EA_U(J) )         
     &                                  -( U(I,J-1,K,1)-EA_U(J-1) ) )   
     &                               *PDRR(J)                           
     &                              + (  ( U(I-1,J,K,1)-EA_U(J) )       
     &                                  -( U(I-1,J-1,K,1)-EA_U(J-1) ) ) 
     &                               *PDRR(J) )                         
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I,J-1,K)-EA_T(J-1) ) )            
     &                        *PDRR(J) ) )                              
     &          -COE_BD*(   0.5D0*(   (  ( U(I,J,K+1,1)-EA_U(J) )       
     &                                  -( U(I,J,K,1)-EA_U(J) ) )       
     &                               *PDZ                               
     &                              + (  ( U(I-1,J,K+1,1)-EA_U(J) )     
     &                                  -( U(I-1,J,K,1)-EA_U(J) ) )     
     &                               *PDZ )                             
     &                     *(  (  ( T(I,J,K+1)-EA_T(J) )                
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDZ )                                    
     &                    + 0.5D0*(   (  ( U(I,J,K,1)-EA_U(J) )         
     &                                  -( U(I,J,K-1,1)-EA_U(J) ) )     
     &                               *PDZ                               
     &                              + (  ( U(I-1,J,K,1)-EA_U(J) )       
     &                                  -( U(I-1,J,K-1,1)-EA_U(J) ) )   
     &                               *PDZ )                             
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I,J,K-1)-EA_T(J) ) )              
     &                        *PDZ ) )                                  
C                                                                       
C --- BUDGET OF THE WALL-NORMAL TURBULENT HEAT FLUX                     
C                                                                       
      PRO_VT(J)= PRO_VT(J)                                              
     &          + 0.5D0*(  ( U(I,J,K,2)-EA_V(J) )                       
     &                    +( U(I,J-1,K,2)-EA_V(J-1) ) )                 
     &           *0.5D0*(  ( U(I,J,K,1)-EA_U(J) )                       
     &                    +( U(I-1,J,K,1)-EA_U(J) ) )                   
     &           *( 2.0D0*PTTL )                                        
     &          - ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(  (  DR(J)*(  0.5D0*(  ( U(I,J,K,2)-EA_V(J) )  
     &                                         +(  U(I,J+1,K,2)         
     &                                            -EA_V(J+1) ) )        
     &                                *(  ( EA_V(J+1)-EA_V(J) )         
     &                                   *PDR(J+1) ) )                  
     &                       +DR(J+1)*(  0.5D0*(  (  U(I,J-1,K,2)       
     &                                              -EA_V(J-1) )        
     &                                           +(  U(I,J,K,2)         
     &                                              -EA_V(J) ) )        
     &                                  *(  ( EA_V(J)-EA_V(J-1) )       
     &                                     *PDR(J) ) )                  
     &                     )*( 0.5D0*PDRR(J+1) )                        
     &                    +(  DR(J-1)*(  0.5D0*(  (  U(I,J-1,K,2)       
     &                                              -EA_V(J-1) )        
     &                                           +(  U(I,J,K,2)         
     &                                              -EA_V(J) ) )        
     &                                  *(  ( EA_V(J)-EA_V(J-1) )       
     &                                     *PDR(J) ) )                  
     &                       +DR(J)*(  0.5D0*(  (  U(I,J-2,K,2)         
     &                                            -EA_V(J-2) )          
     &                                         +(  U(I,J-1,K,2)         
     &                                            -EA_V(J-1) ) )        
     &                                *(  ( EA_V(J-1)-EA_V(J-2) )       
     &                                   *PDR(J-1) ) )                  
     &                     )*( 0.5D0*PDRR(J) ) )                        
     &          - 0.5D0*(  ( U(I,J-1,K,2)-EA_V(J-1) )                   
     &                    +( U(I,J,K,2)-EA_V(J) ) )                     
     &           *0.5D0*(   ( U(I,J,K,2)-EA_V(J) )                      
     &                     *(  ( EA_T(J+1)-EA_T(J) )                    
     &                        *PDRR(J+1) )                              
     &                    + ( U(I,J-1,K,2)-EA_V(J-1) )                  
     &                     *(  ( EA_T(J)-EA_T(J-1) )                    
     &                        *PDRR(J) ) )                              
C                                                                       
C                                                                       
      TDF_VT(J)= TDF_VT(J)                                              
     &         -((0.5D0*((T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J))))      
     &           *0.25D0*((U(I+1,J,K,2)-EA_V(J))                        
     &                       +(U(I+1,J-1,K,2)-EA_V(J-1))                
     &                    +(U(I,J,K,2)-EA_V(J))                         
     &                       +(U(I,J-1,K,2)-EA_V(J-1)))                 
     &           *(U(I,J,K,1)-EA_U(J))-                                 
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)) 
     &               +(U(I-1,J,K,2)-EA_V(J))+(U(I-1,J-1,K,2)-EA_V(J-1)))
     &           *(U(I-1,J,K,1)-EA_U(J)))*PDX                           
     &         -(((DR(J)*(T(I,J+1,K)-EA_T(J+1))                         
     &              +DR(J+1)*(T(I,J,K)-EA_T(J)))/(DR(J+1)+DR(J)))       
     &           *(U(I,J,K,2)-EA_V(J))**2                               
     &           -((DR(J-1)*(T(I,J,K)-EA_T(J))                          
     &              +DR(J)*(T(I,J-1,K)-EA_T(J-1)))/(DR(J)+DR(J-1)))     
     &           *(U(I,J-1,K,2)-EA_V(J-1))**2)*PDR(J)                   
     &         -((0.5D0*((T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K+1,2)-EA_V(J))                        
     &                       +(U(I,J-1,K+1,2)-EA_V(J-1))                
     &                    +(U(I,J,K,2)-EA_V(J))                         
     &                       +(U(I,J-1,K,2)-EA_V(J-1)))                 
     &           *(U(I,J,K,3)-EA_W(J))-                                 
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)) 
     &              +(U(I,J,K-1,2)-EA_V(J))+(U(I,J-1,K-1,2)-EA_V(J-1))) 
     &           *(U(I,J,K-1,3)-EA_W(J)))*PDZ                           
C                                                                       
C                                                                       
C=============================================== TPG                    
C                                                                       
      TPG_VT(J)= TPG_VT(J)                                              
     &          - 1.0D0/DRR2(J)*(                                       
     &                   (0.5D0*(( T(I,J+1,K)-EA_T(J+1) )               
     &                         +( T(I,J,K)-EA_T(J) ))                   
     &                    *(  ( P(I,J+1,K)-EA_P(J+1) )                  
     &                       -( P(I,J,K)-EA_P(J) ) )                    
     &                     *PDRR(J+1)*DRR(J)                            
     &                    )                                             
     &                  +(0.5D0*(( T(I,J,K)-EA_T(J) )                   
     &                         +( T(I,J-1,K)-EA_T(J-1) ))               
     &                    *(  ( P(I,J,K)-EA_P(J) )                      
     &                       -( P(I,J-1,K)-EA_P(J-1) ) )                
     &                     *PDRR(J)*DRR(J+1)                            
     &                    )                                             
     &                          )                                       
C                                                                       
C=============================================== PTG                    
C                                                                       
      PTG_VT(J)= PTG_VT(J)                                              
     &           +1.0D0/DRR2(J)*(                                       
     &                   (0.5D0*(( P(I,J+1,K)-EA_P(J+1) )               
     &                         +( P(I,J,K)-EA_P(J) ))                   
     &                    *(  ( T(I,J+1,K)-EA_T(J+1) )                  
     &                       -( T(I,J,K)-EA_T(J) ) )                    
     &                     *PDRR(J+1)*DRR(J)                            
     &                    )                                             
     &                  +(0.5D0*(( P(I,J,K)-EA_P(J) )                   
     &                         +( P(I,J-1,K)-EA_P(J-1) ))               
     &                    *(  ( T(I,J,K)-EA_T(J) )                      
     &                       -( T(I,J-1,K)-EA_T(J-1) ) )                
     &                     *PDRR(J)*DRR(J+1)                            
     &                    )                                             
     &                          )                                       
C                                                                       
C=============================================== PDF                    
C                                                                       
      PDF_VT(J)= PDF_VT(J)                                              
     &           -1.0D0/DRR2(J)*(                                       
     &                     (  ( P(I,J+1,K)-EA_P(J+1) )                  
     &                       *( T(I,J+1,K)-EA_T(J+1) )                  
     &                       -( P(I,J,K)-EA_P(J) )                      
     &                       *( T(I,J,K)-EA_T(J) )                      
     &                      )*PDRR(J+1)*DRR(J)                          
     &                    +(  ( P(I,J,K)-EA_P(J) )                      
     &                       *( T(I,J,K)-EA_T(J) )                      
     &                       -( P(I,J-1,K)-EA_P(J-1) )                  
     &                       *( T(I,J-1,K)-EA_T(J-1) )                  
     &                      )*PDRR(J)*DRR(J+1)                          
     &                           )                                      
C                                                                       
C===============================================                        
C                                                                       
      ABE6=   PPR*(   (     0.5D0*(  (  U(I+1,J,K,2)                    
     &                                            -EA_V(J) )            
     &                                         +(  U(I+1,J-1,K,2)       
     &                                            -EA_V(J-1) ) )        
     &                      +0.5D0*(  (  U(I,J,K,2)                     
     &                                              -EA_V(J) )          
     &                                           +(  U(I,J-1,K,2)       
     &                                              -EA_V(J-1) ) ) )    
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I+1,J,K)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDX )                                       
     &              -(     0.5D0*(  (  U(I,J,K,2)                       
     &                                            -EA_V(J) )            
     &                                         +(  U(I,J-1,K,2)         
     &                                            -EA_V(J-1) ) )        
     &                      +0.5D0*(  (  U(I-1,J,K,2)                   
     &                                              -EA_V(J) )          
     &                                           +(  U(I-1,J-1,K,2)     
     &                                              -EA_V(J-1) ) ) )    
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I-1,J,K)-EA_T(J) ) )                 
     &                     *PDX ))*PDX                                  
C                                                                       
C                                                                       
      ABE7=   PPR*(   (     0.5D0*(  (  U(I,J,K+1,2)                    
     &                                            -EA_V(J) )            
     &                                         +(  U(I,J-1,K+1,2)       
     &                                            -EA_V(J-1) ) )        
     &                      +0.5D0*(  (  U(I,J,K,2)                     
     &                                              -EA_V(J) )          
     &                                           +(  U(I,J-1,K,2)       
     &                                              -EA_V(J-1) ) ) )    
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K+1)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDZ )                                       
     &              -(     0.5D0*(  (  U(I,J,K,2)                       
     &                                            -EA_V(J) )            
     &                                         +(  U(I,J-1,K,2)         
     &                                            -EA_V(J-1) ) )        
     &                      +0.5D0*(  (  U(I,J,K-1,2)                   
     &                                              -EA_V(J) )          
     &                                           +(  U(I,J-1,K-1,2)     
     &                                              -EA_V(J-1) ) ) )    
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J,K-1)-EA_T(J) ) )                 
     &                     *PDZ ))*PDZ                                  
C                                                                       
C                                                                       
      ABE10=( ( (T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J)))*0.5D0*         
     &        (((U(I+1,J,K,2)-EA_V(J))-(U(I,J,K,2)-EA_V(J)))*PDX        
     &         +((U(I+1,J-1,K,2)-EA_V(J-1))-(U(I,J-1,K,2)-EA_V(J-1)))   
     &          *PDX )*0.5D0                                            
     &       -( (T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J)))*0.5D0*         
     &        (((U(I,J,K,2)-EA_V(J))-(U(I-1,J,K,2)-EA_V(J)))*PDX        
     &         +((U(I,J-1,K,2)-EA_V(J-1))-(U(I-1,J-1,K,2)-EA_V(J-1)))   
     &          *PDX )*0.5D0 )*PDX                                      
C                                                                       
C                                                                       
      ABE11=( ( (T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J)))*0.5D0*         
     &        (((U(I,J,K+1,2)-EA_V(J))-(U(I,J,K,2)-EA_V(J)))*PDZ        
     &         +((U(I,J-1,K+1,2)-EA_V(J-1))-(U(I,J-1,K,2)-EA_V(J-1)))   
     &          *PDZ )*0.5D0                                            
     &       -( (T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J)))*0.5D0*         
     &        (((U(I,J,K,2)-EA_V(J))-(U(I,J,K-1,2)-EA_V(J)))*PDZ        
     &         +((U(I,J-1,K,2)-EA_V(J-1))-(U(I,J-1,K-1,2)-EA_V(J-1)))   
     &          *PDZ )*0.5D0 )*PDZ                                      
C                                                                       
C                                                                       
      RMDFVT(J)= RMDFVT(J)                                              
     &          +(   (  (  DR(J)*( T(I,J+1,K)-EA_T(J+1) )               
     &                    +DR(J+1)*( T(I,J,K)-EA_T(J) ) )               
     &                 *( 0.5D0*PDRR(J+1) ) )                           
     &              *(  CEN1_F(J,1)*( U(I,J+1,K,2)-EA_V(J+1) )          
     &                 +CEN1_M(J,1)*( U(I,J,K,2)-EA_V(J) )              
     &                 +CEN1_B(J,1)*( U(I,J-1,K,2)-EA_V(J-1) ) )        
     &             - (  (  DR(J-1)*( T(I,J,K)-EA_T(J) )                 
     &                    +DR(J)*( T(I,J-1,K)-EA_T(J-1) ) )             
     &                 *( 0.5D0*PDRR(J) ) )                             
     &              *(  CEN1_F(J-1,1)*( U(I,J,K,2)-EA_V(J) )            
     &                 +CEN1_M(J-1,1)*( U(I,J-1,K,2)-EA_V(J-1) )        
     &                 +CEN1_B(J-1,1)*( U(I,J-2,K,2)-EA_V(J-2) ) )      
     &           )*PDR(J)                                               
     &          +PPR*(   ( U(I,J,K,2)-EA_V(J) )                         
     &                  *(  (  ( T(I,J+1,K)-EA_T(J+1) )                 
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDRR(J+1) )                                 
     &                 - ( U(I,J-1,K,2)-EA_V(J-1) )                     
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J-1,K)-EA_T(J-1) ) )               
     &                     *PDRR(J) )                                   
     &               )*PDR(J)+ABE6+ABE7+ABE10+ABE11                     
C                                                                       
C                                                                       
      DIS_VT(J)= DIS_VT(J)                                              
     &          -COE_BD*(   0.5D0*(   (  ( U(I+1,J,K,2)-EA_V(J) )       
     &                                  -( U(I,J,K,2)-EA_V(J) ) )       
     &                               *PDX                               
     &                              + (  ( U(I+1,J-1,K,2)-EA_V(J-1) )   
     &                                  -( U(I,J-1,K,2)-EA_V(J-1) ) )   
     &                               *PDX )                             
     &                     *(  (  ( T(I+1,J,K)-EA_T(J) )                
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDX )                                    
     &                    + 0.5D0*(   (  ( U(I,J,K,2)-EA_V(J) )         
     &                                  -( U(I-1,J,K,2)-EA_V(J) ) )     
     &                               *PDX                               
     &                              + (  ( U(I,J-1,K,2)-EA_V(J-1) )     
     &                                  -( U(I-1,J-1,K,2)-EA_V(J-1) ) ) 
     &                               *PDX )                             
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I-1,J,K)-EA_T(J) ) )              
     &                        *PDX ) )                                  
     &          -0.5D0*(   (  CEN1_F(J,1)*( U(I,J+1,K,2)-EA_V(J+1) )    
     &                       +CEN1_M(J,1)*( U(I,J,K,2)-EA_V(J) )        
     &                       +CEN1_B(J,1)*( U(I,J-1,K,2)-EA_V(J-1) ) )  
     &                    *(  (  ( T(I,J+1,K)-EA_T(J+1) )               
     &                          -( T(I,J,K)-EA_T(J) ) )                 
     &                       *PDRR(J+1) )                               
     &                   + (  CEN1_F(J-1,1)*( U(I,J,K,2)-EA_V(J) )      
     &                       +CEN1_M(J-1,1)*( U(I,J-1,K,2)-EA_V(J-1) )  
     &                       +CEN1_B(J-1,1)*( U(I,J-2,K,2)-EA_V(J-2) ) )
     &                    *(  (  ( T(I,J,K)-EA_T(J) )                   
     &                          -( T(I,J-1,K)-EA_T(J-1) ) )             
     &                       *PDRR(J) ) )                               
     &          - PPR*(  (  (  ( U(I,J,K,2)-EA_V(J) )                   
     &                        -( U(I,J-1,K,2)-EA_V(J-1) ) )             
     &                     *PDR(J) )                                    
     &                  *(  CEN1_F(J,2)*( T(I,J+1,K)-EA_T(J+1) )        
     &                     +CEN1_M(J,2)*( T(I,J,K)-EA_T(J) )            
     &                     +CEN1_B(J,2)*( T(I,J-1,K)-EA_T(J-1) ) ) )    
     &          -COE_BD*(   0.5D0*(   (  ( U(I,J,K+1,2)-EA_V(J) )       
     &                                  -( U(I,J,K,2)-EA_V(J) ) )       
     &                               *PDZ                               
     &                              + (  ( U(I,J-1,K+1,2)-EA_V(J-1) )   
     &                                  -( U(I,J-1,K,2)-EA_V(J-1) ) )   
     &                               *PDZ )                             
     &                     *(  (  ( T(I,J,K+1)-EA_T(J) )                
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDZ )                                    
     &                    + 0.5D0*(   (  ( U(I,J,K,2)-EA_V(J) )         
     &                                  -( U(I,J,K-1,2)-EA_V(J) ) )     
     &                               *PDZ                               
     &                              + (  ( U(I,J-1,K,2)-EA_V(J-1) )     
     &                                  -( U(I,J-1,K-1,2)-EA_V(J-1) ) ) 
     &                               *PDZ )                             
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I,J,K-1)-EA_T(J) ) )              
     &                        *PDZ ) )                                  
C                                                                       
C --- BUDGET OF THE SPANWISE TURBULENT HEAT FLUX                        
C                                                                       
      PRO_WT(J)= PRO_WT(J)                                              
     &          + 0.5D0*(  ( U(I,J,K,3)-EA_W(J) )                       
     &                    +( U(I,J,K-1,3)-EA_W(J) ) )                   
     &           *0.5D0*(  ( U(I,J,K,1)-EA_U(J) )                       
     &                    +( U(I-1,J,K,1)-EA_U(J) ) )                   
     &           *( 2.0D0*PTTL )                                        
     &          - ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(  0.5D0*(   0.5D0*(  ( U(I,J,K+1,2)-EA_V(J) )  
     &                                       +( U(I,J,K,2)-EA_V(J) ) )  
     &                              *(  ( EA_W(J+1)-EA_W(J) )           
     &                                 *PDRR(J+1) )                     
     &                             + 0.5D0*(  (  U(I,J-1,K+1,2)         
     &                                          -EA_V(J-1) )            
     &                                       +(  U(I,J-1,K,2)           
     &                                          -EA_V(J-1) ) )          
     &                              *(  ( EA_W(J)-EA_W(J-1) )           
     &                                 *PDRR(J) ) )                     
     &                    +0.5D0*(   0.5D0*(  ( U(I,J,K,2)-EA_V(J) )    
     &                                       +( U(I,J,K-1,2)-EA_V(J) ) )
     &                              *(  ( EA_W(J+1)-EA_W(J) )           
     &                                 *PDRR(J+1) )                     
     &                             + 0.5D0*(  ( U(I,J-1,K,2)-EA_V(J-1) )
     &                                       +(  U(I,J-1,K-1,2)         
     &                                          -EA_V(J-1) ) )          
     &                              *(  ( EA_W(J)-EA_W(J-1) )           
     &                                 *PDRR(J) ) ) )                   
     &          - 0.5D0*(  ( U(I,J,K-1,3)-EA_W(J) )                     
     &                    +( U(I,J,K,3)-EA_W(J) ) )                     
     &           *0.5D0*(   ( U(I,J,K,2)-EA_V(J) )                      
     &                     *(  ( EA_T(J+1)-EA_T(J) )                    
     &                        *PDRR(J+1) )                              
     &                    + ( U(I,J-1,K,2)-EA_V(J-1) )                  
     &                     *(  ( EA_T(J)-EA_T(J-1) )                    
     &                        *PDRR(J) ) )                              
C                                                                       
C                                                                       
      TDF_WT(J)= TDF_WT(J)                                              
     &         -((0.5D0*((T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J))))*     
     &          0.25D0*((U(I+1,J,K,3)-EA_W(J))+(U(I+1,J,K-1,3)-EA_W(J)) 
     &           +(U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J)))          
     &          *(U(I,J,K,1)-EA_U(J))-                                  
     &         (0.5D0*((T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J))))*       
     &          0.25D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))     
     &           +(U(I-1,J,K,3)-EA_W(J))+(U(I-1,J,K-1,3)-EA_W(J)))      
     &          *(U(I-1,J,K,1)-EA_U(J)))*PDX                            
     &         -((DR(J)*(T(I,J+1,K)-EA_T(J+1))                          
     &                       +DR(J+1)*(T(I,J,K)-EA_T(J)))/              
     &           (DR(J+1)+DR(J))*0.5D0*(                                
     &          (DR(J)*(U(I,J+1,K,3)-EA_W(J+1))                         
     &                       +DR(J+1)*(U(I,J,K,3)-EA_W(J)))/            
     &           (DR(J+1)+DR(J))+                                       
     &          (DR(J)*(U(I,J+1,K-1,3)-EA_W(J+1))                       
     &                       +DR(J+1)*(U(I,J,K-1,3)-EA_W(J)))/          
     &           (DR(J+1)+DR(J)))*(U(I,J,K,2)-EA_V(J))-                 
     &          (DR(J-1)*(T(I,J,K)-EA_T(J))                             
     &                       +DR(J)*(T(I,J-1,K)-EA_T(J-1)))/            
     &           (DR(J)+DR(J-1))*0.5D0*(                                
     &          (DR(J-1)*(U(I,J,K,3)-EA_W(J))                           
     &                       +DR(J)*(U(I,J-1,K,3)-EA_W(J-1)))/          
     &           (DR(J)+DR(J-1))+                                       
     &          (DR(J-1)*(U(I,J,K-1,3)-EA_W(J))                         
     &                       +DR(J)*(U(I,J-1,K-1,3)-EA_W(J-1)))/        
     &           (DR(J)+DR(J-1)))*(U(I,J-1,K,2)-EA_V(J-1)))*PDR(J)      
     &         -((0.5D0*((T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J))))*     
     &          (U(I,J,K,3)-EA_W(J))**2                                 
     &         -(0.5D0*((T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J))))*      
     &          (U(I,J,K-1,3)-EA_W(J))**2)*PDZ                          
C                                                                       
C=============================================== TPG                    
C                                                                       
      TPG_WT(J)= TPG_WT(J)                                              
     &          -0.5D0*( 0.5D0*(( T(I,J,K+1)-EA_T(J) )                  
     &                         +( T(I,J,K)-EA_T(J) ))                   
     &                     *(  ( P(I,J,K+1)-EA_P(J) )                   
     &                        -( P(I,J,K)-EA_P(J) ) )                   
     &                     *PDZ                                         
     &                  +0.5D0*(( T(I,J,K)-EA_T(J) )                    
     &                         +( T(I,J,K-1)-EA_T(J) ))                 
     &                     *(  ( P(I,J,K)-EA_P(J) )                     
     &                        -( P(I,J,K-1)-EA_P(J) ) )                 
     &                     *PDZ )                                       
C                                                                       
C=============================================== PTG                    
C                                                                       
      PTG_WT(J)= PTG_WT(J)                                              
     &          +0.5D0*( 0.5D0*(( P(I,J,K+1)-EA_P(J) )                  
     &                         +( P(I,J,K)-EA_P(J) ))                   
     &                     *(  ( T(I,J,K+1)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDZ                                         
     &                  +0.5D0*(( P(I,J,K)-EA_P(J) )                    
     &                         +( P(I,J,K-1)-EA_P(J) ))                 
     &                     *(  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J,K-1)-EA_T(J) ) )                 
     &                     *PDZ )                                       
C                                                                       
C=============================================== PDF                    
C                                                                       
      PDF_WT(J)= PDF_WT(J)                                              
     &          -0.5D0*(                                                
     &                   ( ( P(I,J,K+1)-EA_P(J) )                       
     &                    *( T(I,J,K+1)-EA_T(J) )                       
     &                    -( P(I,J,K)-EA_P(J) )                         
     &                    *( T(I,J,K)-EA_T(J) ) )                       
     &                   *PDZ                                           
     &                  +( ( P(I,J,K)-EA_P(J) )                         
     &                    *( T(I,J,K)-EA_T(J) )                         
     &                    -( P(I,J,K-1)-EA_P(J) )                       
     &                    *( T(I,J,K-1)-EA_T(J) ) )                     
     &                   *PDZ                                           
     &                  )                                               
C                                                                       
C===============================================                        
C                                                                       
      RMDFWT(J)= RMDFWT(J)                                              
     &          +(   (  (  DR(J)*( T(I,J+1,K)-EA_T(J+1) )               
     &                    +DR(J+1)*( T(I,J,K)-EA_T(J) ) )               
     &                 *( 0.5D0*PDRR(J+1) ) )                           
     &              *0.5D0*(   (  ( U(I,J+1,K,3)-EA_W(J+1) )            
     &                           -( U(I,J,K,3)-EA_W(J) ) )              
     &                        *PDRR(J+1)                                
     &                       + (  ( U(I,J+1,K-1,3)-EA_W(J+1) )          
     &                           -( U(I,J,K-1,3)-EA_W(J) ) )            
     &                        *PDRR(J+1) )                              
     &             - (  (  DR(J-1)*( T(I,J,K)-EA_T(J) )                 
     &                    +DR(J)*( T(I,J-1,K)-EA_T(J-1) ) )             
     &                 *( 0.5D0*PDRR(J) ) )                             
     &              *0.5D0*(   (  ( U(I,J,K,3)-EA_W(J) )                
     &                           -( U(I,J-1,K,3)-EA_W(J-1) ) )          
     &                        *PDRR(J)                                  
     &                       + (  ( U(I,J,K-1,3)-EA_W(J) )              
     &                           -( U(I,J-1,K-1,3)-EA_W(J-1) ) )        
     &                        *PDRR(J) )                                
     &           )*PDR(J)                                               
     &          +PPR*(   (  (  DR(J)*( 0.5D0*(  (  U(I,J+1,K-1,3)       
     &                                            -EA_W(J+1) )          
     &                                         +(  U(I,J+1,K,3)         
     &                                            -EA_W(J+1) ) ) )      
     &                        +DR(J+1)*( 0.5D0*(  (  U(I,J,K-1,3)       
     &                                              -EA_W(J) )          
     &                                           +(  U(I,J,K,3)         
     &                                              -EA_W(J) ) ) ) )    
     &                     *( 0.5D0*PDRR(J+1) ) )                       
     &                  *(  (  ( T(I,J+1,K)-EA_T(J+1) )                 
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDRR(J+1) )                                 
     &                 - (  (  DR(J-1)*( 0.5D0*(  (  U(I,J,K-1,3)       
     &                                              -EA_W(J) )          
     &                                           +(  U(I,J,K,3)         
     &                                              -EA_W(J) ) ) )      
     &                        +DR(J)*( 0.5D0*(  (  U(I,J-1,K-1,3)       
     &                                            -EA_W(J-1) )          
     &                                         +(  U(I,J-1,K,3)         
     &                                            -EA_W(J-1) ) ) ) )    
     &                     *( 0.5D0*PDRR(J) ) )                         
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J-1,K)-EA_T(J-1) ) )               
     &                     *PDRR(J) )                                   
     &               )*PDR(J)                                           
C                                                                       
C                                                                       
      DIS_WT(J)= DIS_WT(J)                                              
     &          -COE_BD*(   0.5D0*(   (  ( U(I+1,J,K,3)-EA_W(J) )       
     &                                  -( U(I,J,K,3)-EA_W(J) ) )       
     &                               *PDX                               
     &                              + (  ( U(I+1,J,K-1,3)-EA_W(J) )     
     &                                  -( U(I,J,K-1,3)-EA_W(J) ) )     
     &                               *PDX )                             
     &                     *(  (  ( T(I+1,J,K)-EA_T(J) )                
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDX )                                    
     &                    + 0.5D0*(   (  ( U(I,J,K,3)-EA_W(J) )         
     &                                  -( U(I-1,J,K,3)-EA_W(J) ) )     
     &                               *PDX                               
     &                              + (  ( U(I,J,K-1,3)-EA_W(J) )       
     &                                  -( U(I-1,J,K-1,3)-EA_W(J) ) )   
     &                               *PDX )                             
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I-1,J,K)-EA_T(J) ) )              
     &                        *PDX ) )                                  
     &          -COE_BD*(   0.5D0*(   (  ( U(I,J+1,K,3)-EA_W(J+1) )     
     &                                  -( U(I,J,K,3)-EA_W(J) ) )       
     &                               *PDRR(J+1)                         
     &                              + (  ( U(I,J+1,K-1,3)-EA_W(J+1) )   
     &                                  -( U(I,J,K-1,3)-EA_W(J) ) )     
     &                               *PDRR(J+1) )                       
     &                     *(  (  ( T(I,J+1,K)-EA_T(J+1) )              
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDRR(J+1) )                              
     &                    + 0.5D0*(   (  ( U(I,J,K,3)-EA_W(J) )         
     &                                  -( U(I,J-1,K,3)-EA_W(J-1) ) )   
     &                               *PDRR(J)                           
     &                              + (  ( U(I,J,K-1,3)-EA_W(J) )       
     &                                  -( U(I,J-1,K-1,3)-EA_W(J-1) ) ) 
     &                               *PDRR(J) )                         
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I,J-1,K)-EA_T(J-1) ) )            
     &                        *PDRR(J) ) )                              
     &          -0.5D0*(   (  (  ( U(I,J,K+1,3)-EA_W(J) )               
     &                          -( U(I,J,K-1,3)-EA_W(J) ) )             
     &                       *( 0.5D0*PDZ ) )                           
     &                    *(  (  ( T(I,J,K+1)-EA_T(J) )                 
     &                          -( T(I,J,K)-EA_T(J) ) )                 
     &                       *PDZ )                                     
     &                   + (  (  ( U(I,J,K,3)-EA_W(J) )                 
     &                          -( U(I,J,K-2,3)-EA_W(J) ) )             
     &                       *( 0.5D0*PDZ ) )                           
     &                    *(  (  ( T(I,J,K)-EA_T(J) )                   
     &                          -( T(I,J,K-1)-EA_T(J) ) )               
     &                       *PDZ ) )                                   
     &          - PPR*(  (  (  ( U(I,J,K,3)-EA_W(J) )                   
     &                        -( U(I,J,K-1,3)-EA_W(J) ) )               
     &                     *PDZ )                                       
     &                  *(  (  ( T(I,J,K+1)-EA_T(J) )                   
     &                        -( T(I,J,K-1)-EA_T(J) ) )                 
     &                     *( 0.5D0*PDZ ) ) )                           
C                                                                       
   10 CONTINUE                                                          
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE BUDGEK2(PPR,COE_BD)                                    
C                                                                       
C     REVISED BY H.ABE (2000.10.15) DISSIPATION RATE (BUDGET OF VT)     
C     REVISED BY H.ABE (2000.10.15) ADD: PTG,PDF (BUDGET OF UT,VT,WT)   
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
C---- LOCAL VARIABLES --------------------------------------------------
C                                                                       
      DIMENSION U(-4:IG+4,-2:JG+2,-4:KG+4,3)                            
      DIMENSION P(-3:IG+3,-2:JG+2,-3:KG+3)                              
      DIMENSION T(-3:IG+3,-2:JG+2,-3:KG+3)                              
      DIMENSION EA_T(-2:JG+2)                                           
C                                                                       
      DIMENSION PRO_TV(JG),DIS_TV(JG),                                  
     &          TDF_TV(JG),RMDFTV(JG)                                   
      DIMENSION PRO_UT(JG),DIS_UT(JG),TPG_UT(JG),                       
     &          TDF_UT(JG),RMDFUT(JG),PTG_UT(JG),PDF_UT(JG)             
      DIMENSION PRO_VT(JG),DIS_VT(JG),TPG_VT(JG),                       
     &          TDF_VT(JG),RMDFVT(JG),PTG_VT(JG),PDF_VT(JG)             
      DIMENSION PRO_WT(JG),DIS_WT(JG),TPG_WT(JG),                       
     &          TDF_WT(JG),RMDFWT(JG),PTG_WT(JG),PDF_WT(JG)             
C                                                                       
      DIMENSION EA_U(-2:JG+2)                                           
      DIMENSION EA_V(-2:JG+2),EA_W(-2:JG+2),EA_P(-2:JG+2)               
C                                                                       
      COMMON /FD1C/ CEN1_F(0:JG,2),CEN1_M(0:JG,2),CEN1_B(0:JG,2)        
      COMMON /FD2C/ CEN2_F(0:JG,2),CEN2_M(0:JG,2),CEN2_B(0:JG,2)        
      COMMON /RVTL/ PTTL                                                
C                                                                       
C---- GLOBAL VARIABLES -------------------------------------------------
C                                                                       
      COMMON /VELO/ UG(-4:IG+4,-2:JG+2,-4:KG+4,3)                       
      COMMON /SCAL/ PG(-3:IG+3,-2:JG+2,-3:KG+3)                         
      COMMON /TEM2/ TG(-3:IG+3,-2:JG+2,-3:KG+3)                         
      COMMON /ETM2/ EATG(-2:JG+2)                                       
C                                                                       
      COMMON /EAVU/ EAGU(-2:JG+2)                                       
      COMMON /EAVE/ EAGV(-2:JG+2),EAGW(-2:JG+2),EAGP(-2:JG+2)           
C                                                                       
      COMMON /KON2/ PRO_TG(JG),DIS_TG(JG),                              
     &              TDF_TG(JG),RMDFTG(JG),                              
     &              PRO_UG(JG),DIS_UG(JG),TPG_UG(JG),                   
     &              TDF_UG(JG),RMDFUG(JG),PTG_UG(JG),PDF_UG(JG),        
     &              PRO_VG(JG),DIS_VG(JG),TPG_VG(JG),                   
     &              TDF_VG(JG),RMDFVG(JG),PTG_VG(JG),PDF_VG(JG),        
     &              PRO_WG(JG),DIS_WG(JG),TPG_WG(JG),                   
     &              TDF_WG(JG),RMDFWG(JG),PTG_WG(JG),PDF_WG(JG)         
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (UG,U),(PG,P)                                         
      EQUIVALENCE (TG,T)                                                
      EQUIVALENCE (EATG,EA_T)                                           
      EQUIVALENCE (EAGU,EA_U),(EAGV,EA_V),                              
     &            (EAGW,EA_W),(EAGP,EA_P)                               
      EQUIVALENCE (PRO_TG,PRO_TV),(DIS_TG,DIS_TV),                      
     &            (TDF_TG,TDF_TV),(RMDFTG,RMDFTV)                       
      EQUIVALENCE (PRO_UG,PRO_UT),(DIS_UG,DIS_UT),                      
     &            (TPG_UG,TPG_UT),(TDF_UG,TDF_UT),                      
     &            (RMDFUG,RMDFUT),(PTG_UG,PTG_UT),                      
     &            (PDF_UG,PDF_UT)                                       
      EQUIVALENCE (PRO_VG,PRO_VT),(DIS_VG,DIS_VT),                      
     &            (TPG_VG,TPG_VT),(TDF_VG,TDF_VT),                      
     &            (RMDFVG,RMDFVT),(PTG_VG,PTG_VT),                      
     &            (PDF_VG,PDF_VT)                                       
      EQUIVALENCE (PRO_WG,PRO_WT),(DIS_WG,DIS_WT),                      
     &            (TPG_WG,TPG_WT),(TDF_WG,TDF_WT),                      
     &            (RMDFWG,RMDFWT),(PTG_WG,PTG_WT),                      
     &            (PDF_WG,PDF_WT)                                       
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,K,ABE4,ABE5,ABE6,ABE7,ABE8,ABE9,ABE10,ABE11)
      DO 10 J=1,JG                                                      
      DO 10 K=1,KG                                                      
      DO 10 I=1,IG                                                      
C                                                                       
C --- BUDGET OF THE TEMPERATURE VARIANCE                                
C                                                                       
      PRO_TV(J)= PRO_TV(J)                                              
     &          - ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(  ( U(I,J,K,2)-EA_V(J) )                       
     &                    +( U(I,J-1,K,2)-EA_V(J-1) ) )                 
     &          - ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(   ( U(I,J,K,2)-EA_V(J) )                      
     &                     *(  ( EA_T(J+1)-EA_T(J) )                    
     &                        *PDRR(J+1) )                              
     &                    + ( U(I,J-1,K,2)-EA_V(J-1) )                  
     &                     *(  ( EA_T(J)-EA_T(J-1) )                    
     &                        *PDRR(J) ) )                              
C                                                                       
C                                                                       
      TDF_TV(J)= TDF_TV(J)                                              
     &          -0.5D0*(                                                
     &          ((0.5D0*((T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J))))**2   
     &            *(U(I,J,K,1)-EA_U(J))-                                
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J))))**2   
     &            *(U(I-1,J,K,1)-EA_U(J)))*PDX                          
     &         +(((DR(J)*(T(I,J+1,K)-EA_T(J+1))+                        
     &                DR(J+1)*(T(I,J,K)-EA_T(J)))/(DR(J+1)+DR(J)))**2   
     &            *(U(I,J,K,2)-EA_V(J))-                                
     &           ((DR(J-1)*(T(I,J,K)-EA_T(J))+                          
     &              DR(J)*(T(I,J-1,K)-EA_T(J-1)))/(DR(J)+DR(J-1)))**2   
     &            *(U(I,J-1,K,2)-EA_V(J-1)))*PDR(J)                     
     &         +((0.5D0*((T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J))))**2   
     &            *(U(I,J,K,3)-EA_W(J))-                                
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J))))**2   
     &            *(U(I,J,K-1,3)-EA_W(J)))*PDZ                          
     &                  )                                               
C                                                                       
C                                                                       
      RMDFTV(J)= RMDFTV(J)                                              
     &          + 0.5D0*PPR                                             
     &           *(  CEN2_F(J,2)*( ( T(I,J+1,K)-EA_T(J+1) )**2 )        
     &              +CEN2_M(J,2)*( ( T(I,J,K)-EA_T(J) )**2 )            
     &              +CEN2_B(J,2)*( ( T(I,J-1,K)-EA_T(J-1) )**2 ) )      
C                                                                       
C                                                                       
      DIS_TV(J)= DIS_TV(J)                                              
     &          -PPR*(  0.5D0*(  (  (  ( T(I+1,J,K)-EA_T(J) )           
     &                                -( T(I,J,K)-EA_T(J) ) )           
     &                             *PDX )**2                            
     &                          +(  (  ( T(I,J,K)-EA_T(J) )             
     &                                -( T(I-1,J,K)-EA_T(J) ) )         
     &                             *PDX )**2 )                          
     &                 +0.5D0*(  (  (  ( T(I,J,K+1)-EA_T(J) )           
     &                                -( T(I,J,K)-EA_T(J) ) )           
     &                             *PDZ )**2                            
     &                          +(  (  ( T(I,J,K)-EA_T(J) )             
     &                                -( T(I,J,K-1)-EA_T(J) ) )         
     &                             *PDZ )**2 )                          
     &                 +0.5D0*(  (  (  ( T(I,J+1,K)-EA_T(J+1) )         
     &                                -( T(I,J,K)-EA_T(J) ) )           
     &                             *PDRR(J+1) )**2                      
     &                          +(  (  ( T(I,J,K)-EA_T(J) )             
     &                                -( T(I,J-1,K)-EA_T(J-1) ) )       
     &                             *PDRR(J) )**2 ) )                    
C                                                                       
C --- BUDGET OF THE STREAMWISE TURBULENT HEAT FLUX                      
C                                                                       
      PRO_UT(J)= PRO_UT(J)                                              
     &          - 0.5D0*(  ( U(I,J,K,1)-EA_U(J) )                       
     &                    +( U(I-1,J,K,1)-EA_U(J) ) )                   
     &           *0.5D0*(  ( U(I,J,K,2)-EA_V(J) )                       
     &                    +( U(I,J-1,K,2)-EA_V(J-1) ) )                 
     &          - ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(  0.5D0*(   0.5D0*(  ( U(I+1,J,K,2)-EA_V(J) )  
     &                                       +( U(I,J,K,2)-EA_V(J) ) )  
     &                              *(  ( EA_U(J+1)-EA_U(J) )           
     &                                 *PDRR(J+1) )                     
     &                             + 0.5D0*(  (  U(I+1,J-1,K,2)         
     &                                          -EA_V(J-1) )            
     &                                       +(  U(I,J-1,K,2)           
     &                                          -EA_V(J-1) ) )          
     &                              *(  ( EA_U(J)-EA_U(J-1) )           
     &                                 *PDRR(J) ) )                     
     &                    +0.5D0*(   0.5D0*(  ( U(I,J,K,2)-EA_V(J) )    
     &                                       +( U(I-1,J,K,2)-EA_V(J) ) )
     &                              *(  ( EA_U(J+1)-EA_U(J) )           
     &                                 *PDRR(J+1) )                     
     &                             + 0.5D0*(  ( U(I,J-1,K,2)-EA_V(J-1) )
     &                                       +(  U(I-1,J-1,K,2)         
     &                                          -EA_V(J-1) ) )          
     &                              *(  ( EA_U(J)-EA_U(J-1) )           
     &                                 *PDRR(J) ) ) )                   
     &          - 0.5D0*(  ( U(I-1,J,K,1)-EA_U(J) )                     
     &                    +( U(I,J,K,1)-EA_U(J) ) )                     
     &           *0.5D0*(   ( U(I,J,K,2)-EA_V(J) )                      
     &                     *(  ( EA_T(J+1)-EA_T(J) )                    
     &                        *PDRR(J+1) )                              
     &                    + ( U(I,J-1,K,2)-EA_V(J-1) )                  
     &                     *(  ( EA_T(J)-EA_T(J-1) )                    
     &                        *PDRR(J) ) )                              
C                                                                       
C                                                                       
      TDF_UT(J)= TDF_UT(J)                                              
     &         -((0.5D0*((T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J))))      
     &           *(U(I,J,K,1)-EA_U(J))**2                               
     &         -(0.5D0*((T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J))))       
     &           *(U(I-1,J,K,1)-EA_U(J))**2)*PDX                        
     &         -(((DR(J)*(T(I,J+1,K)-EA_T(J+1))                         
     &              +DR(J+1)*(T(I,J,K)-EA_T(J)))/(DR(J+1)+DR(J)))       
     &           *0.5D0*((DR(J)*(U(I,J+1,K,1)-EA_U(J+1))                
     &               +DR(J+1)*(U(I,J,K,1)-EA_U(J)))/(DR(J+1)+DR(J))     
     &                  +(DR(J)*(U(I-1,J+1,K,1)-EA_U(J+1))              
     &               +DR(J+1)*(U(I-1,J,K,1)-EA_U(J)))/(DR(J+1)+DR(J)))  
     &           *(U(I,J,K,2)-EA_V(J))-                                 
     &           ((DR(J-1)*(T(I,J,K)-EA_T(J))                           
     &              +DR(J)*(T(I,J-1,K)-EA_T(J-1)))/(DR(J)+DR(J-1)))     
     &           *0.5D0*((DR(J-1)*(U(I,J,K,1)-EA_U(J))                  
     &               +DR(J)*(U(I,J-1,K,1)-EA_U(J-1)))/(DR(J)+DR(J-1))   
     &                  +(DR(J-1)*(U(I-1,J,K,1)-EA_U(J))                
     &               +DR(J)*(U(I-1,J-1,K,1)-EA_U(J-1)))/(DR(J)+DR(J-1)))
     &           *(U(I,J-1,K,2)-EA_V(J-1)))*PDR(J)                      
     &         -((0.5D0*((T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K+1,1)-EA_U(J))+(U(I,J,K,1)-EA_U(J))   
     &                +(U(I-1,J,K+1,1)-EA_U(J))+(U(I-1,J,K,1)-EA_U(J))) 
     &           *(U(I,J,K,3)-EA_W(J))-                                 
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K,1)-EA_U(J))+(U(I,J,K-1,1)-EA_U(J))   
     &                +(U(I-1,J,K,1)-EA_U(J))+(U(I-1,J,K-1,1)-EA_U(J))) 
     &           *(U(I,J,K-1,3)-EA_W(J)))*PDZ                           
C                                                                       
C                                                                       
C=============================================== TPG                    
C                                                                       
      TPG_UT(J)= TPG_UT(J)                                              
     &          -0.5D0*( 0.5D0*(( T(I+1,J,K)-EA_T(J) )                  
     &                         +( T(I,J,K)-EA_T(J) ))                   
     &                     *(  ( P(I+1,J,K)-EA_P(J) )                   
     &                        -( P(I,J,K)-EA_P(J) ) )                   
     &                     *PDX                                         
     &                  +0.5D0*(( T(I,J,K)-EA_T(J) )                    
     &                         +( T(I-1,J,K)-EA_T(J) ))                 
     &                     *(  ( P(I,J,K)-EA_P(J) )                     
     &                        -( P(I-1,J,K)-EA_P(J) ) )                 
     &                     *PDX )                                       
C                                                                       
C=============================================== PTG                    
C                                                                       
      PTG_UT(J)= PTG_UT(J)                                              
     &          +0.5D0*( 0.5D0*(( P(I+1,J,K)-EA_P(J) )                  
     &                         +( P(I,J,K)-EA_P(J) ))                   
     &                     *(  ( T(I+1,J,K)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDX                                         
     &                  +0.5D0*(( P(I,J,K)-EA_P(J) )                    
     &                         +( P(I-1,J,K)-EA_P(J) ))                 
     &                     *(  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I-1,J,K)-EA_T(J) ) )                 
     &                     *PDX )                                       
C                                                                       
C=============================================== PDF                    
C                                                                       
      PDF_UT(J)= PDF_UT(J)                                              
     &          -0.5D0*(                                                
     &                   ( ( P(I+1,J,K)-EA_P(J) )                       
     &                    *( T(I+1,J,K)-EA_T(J) )                       
     &                    -( P(I,J,K)-EA_P(J) )                         
     &                    *( T(I,J,K)-EA_T(J) ) )                       
     &                   *PDX                                           
     &                  +( ( P(I,J,K)-EA_P(J) )                         
     &                    *( T(I,J,K)-EA_T(J) )                         
     &                    -( P(I-1,J,K)-EA_P(J) )                       
     &                    *( T(I-1,J,K)-EA_T(J) ) )                     
     &                   *PDX                                           
     &                  )                                               
C                                                                       
C===============================================                        
C                                                                       
      ABE4=   PPR*( (U(I,J,K,1)-EA_U(J))*( (T(I+1,J,K)-EA_T(J))         
     &                                    -(T(I,J,K)-EA_T(J)))*PDX      
     &             -(U(I-1,J,K,1)-EA_U(J))*( (T(I,J,K)-EA_T(J))         
     &                              -(T(I-1,J,K)-EA_T(J)))*PDX )        
     &           *PDX                                                   
C                                                                       
C                                                                       
      ABE5=   PPR*(   (     0.5D0*(  (  U(I,J,K+1,1)                    
     &                                            -EA_U(J) )            
     &                                         +(  U(I-1,J,K+1,1)       
     &                                            -EA_U(J) ) )          
     &                      +0.5D0*(  (  U(I,J,K,1)                     
     &                                              -EA_U(J) )          
     &                                           +(  U(I-1,J,K,1)       
     &                                              -EA_U(J) ) ) )      
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K+1)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDZ )                                       
     &              -(     0.5D0*(  (  U(I,J,K,1)                       
     &                                            -EA_U(J) )            
     &                                         +(  U(I-1,J,K,1)         
     &                                            -EA_U(J) ) )          
     &                      +0.5D0*(  (  U(I,J,K-1,1)                   
     &                                              -EA_U(J) )          
     &                                           +(  U(I-1,J,K-1,1)     
     &                                              -EA_U(J) ) ) )      
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J,K-1)-EA_T(J) ) )                 
     &                     *PDZ ))*PDZ                                  
C                                                                       
C                                                                       
      ABE8=( ( (T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J)))*0.5D0*          
     &       ( (U(I+1,J,K,1)-EA_U(J))-(U(I-1,J,K,1)-EA_U(J)))           
     &       *0.5D0*PDX                                                 
     &      -( (T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J)))*0.5D0*          
     &       ( (U(I,J,K,1)-EA_U(J))-(U(I-2,J,K,1)-EA_U(J)))             
     &       *0.5D0*PDX )*PDX                                           
C                                                                       
C                                                                       
      ABE9=( ( (T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J)))*0.5D0*          
     &       (((U(I,J,K+1,1)-EA_U(J))-(U(I,J,K,1)-EA_U(J)))*PDZ         
     &        +((U(I-1,J,K+1,1)-EA_U(J))-(U(I-1,J,K,1)-EA_U(J)))        
     &          *PDZ)*0.5D0                                             
     &      -( (T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J)))*0.5D0*          
     &       (((U(I,J,K,1)-EA_U(J))-(U(I,J,K-1,1)-EA_U(J)))*PDZ         
     &        +((U(I-1,J,K,1)-EA_U(J))-(U(I-1,J,K-1,1)-EA_U(J)))        
     &          *PDZ)*0.5D0 )*PDZ                                       
C                                                                       
C                                                                       
      RMDFUT(J)= RMDFUT(J)                                              
     &          +(   (  (  DR(J)*( T(I,J+1,K)-EA_T(J+1) )               
     &                    +DR(J+1)*( T(I,J,K)-EA_T(J) ) )               
     &                 *( 0.5D0*PDRR(J+1) ) )                           
     &              *0.5D0*(   (  ( U(I,J+1,K,1)-EA_U(J+1) )            
     &                           -( U(I,J,K,1)-EA_U(J) ) )              
     &                        *PDRR(J+1)                                
     &                       + (  ( U(I-1,J+1,K,1)-EA_U(J+1) )          
     &                           -( U(I-1,J,K,1)-EA_U(J) ) )            
     &                        *PDRR(J+1) )                              
     &             - (  (  DR(J-1)*( T(I,J,K)-EA_T(J) )                 
     &                    +DR(J)*( T(I,J-1,K)-EA_T(J-1) ) )             
     &                 *( 0.5D0*PDRR(J) ) )                             
     &              *0.5D0*(   (  ( U(I,J,K,1)-EA_U(J) )                
     &                           -( U(I,J-1,K,1)-EA_U(J-1) ) )          
     &                        *PDRR(J)                                  
     &                       + (  ( U(I-1,J,K,1)-EA_U(J) )              
     &                           -( U(I-1,J-1,K,1)-EA_U(J-1) ) )        
     &                        *PDRR(J) )                                
     &           )*PDR(J)                                               
     &          +PPR*(   (  (  DR(J)*( 0.5D0*(  (  U(I-1,J+1,K,1)       
     &                                            -EA_U(J+1) )          
     &                                         +(  U(I,J+1,K,1)         
     &                                            -EA_U(J+1) ) ) )      
     &                        +DR(J+1)*( 0.5D0*(  (  U(I-1,J,K,1)       
     &                                              -EA_U(J) )          
     &                                           +(  U(I,J,K,1)         
     &                                              -EA_U(J) ) ) ) )    
     &                     *( 0.5D0*PDRR(J+1) ) )                       
     &                  *(  (  ( T(I,J+1,K)-EA_T(J+1) )                 
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDRR(J+1) )                                 
     &                 - (  (  DR(J-1)*( 0.5D0*(  (  U(I-1,J,K,1)       
     &                                              -EA_U(J) )          
     &                                           +(  U(I,J,K,1)         
     &                                              -EA_U(J) ) ) )      
     &                        +DR(J)*( 0.5D0*(  (  U(I-1,J-1,K,1)       
     &                                            -EA_U(J-1) )          
     &                                         +(  U(I,J-1,K,1)         
     &                                            -EA_U(J-1) ) ) ) )    
     &                     *( 0.5D0*PDRR(J) ) )                         
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J-1,K)-EA_T(J-1) ) )               
     &                     *PDRR(J) )                                   
     &               )*PDR(J)+ABE4+ABE5+ABE8+ABE9                       
C                                                                       
C                                                                       
      DIS_UT(J)= DIS_UT(J)                                              
     &          -0.5D0*(   (  (  ( U(I+1,J,K,1)-EA_U(J) )               
     &                          -( U(I-1,J,K,1)-EA_U(J) ) )             
     &                       *( 0.5D0*PDX ) )                           
     &                    *(  (  ( T(I+1,J,K)-EA_T(J) )                 
     &                          -( T(I,J,K)-EA_T(J) ) )                 
     &                       *PDX )                                     
     &                   + (  (  ( U(I,J,K,1)-EA_U(J) )                 
     &                          -( U(I-2,J,K,1)-EA_U(J) ) )             
     &                       *( 0.5D0*PDX ) )                           
     &                    *(  (  ( T(I,J,K)-EA_T(J) )                   
     &                          -( T(I-1,J,K)-EA_T(J) ) )               
     &                       *PDX ) )                                   
     &          - PPR*(  (  (  ( U(I,J,K,1)-EA_U(J) )                   
     &                        -( U(I-1,J,K,1)-EA_U(J) ) )               
     &                     *PDX )                                       
     &                  *(  (  ( T(I+1,J,K)-EA_T(J) )                   
     &                        -( T(I-1,J,K)-EA_T(J) ) )                 
     &                     *( 0.5D0*PDX ) ) )                           
     &          -COE_BD*(   0.5D0*(   (  ( U(I,J+1,K,1)-EA_U(J+1) )     
     &                                  -( U(I,J,K,1)-EA_U(J) ) )       
     &                               *PDRR(J+1)                         
     &                              + (  ( U(I-1,J+1,K,1)-EA_U(J+1) )   
     &                                  -( U(I-1,J,K,1)-EA_U(J) ) )     
     &                               *PDRR(J+1) )                       
     &                     *(  (  ( T(I,J+1,K)-EA_T(J+1) )              
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDRR(J+1) )                              
     &                    + 0.5D0*(   (  ( U(I,J,K,1)-EA_U(J) )         
     &                                  -( U(I,J-1,K,1)-EA_U(J-1) ) )   
     &                               *PDRR(J)                           
     &                              + (  ( U(I-1,J,K,1)-EA_U(J) )       
     &                                  -( U(I-1,J-1,K,1)-EA_U(J-1) ) ) 
     &                               *PDRR(J) )                         
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I,J-1,K)-EA_T(J-1) ) )            
     &                        *PDRR(J) ) )                              
     &          -COE_BD*(   0.5D0*(   (  ( U(I,J,K+1,1)-EA_U(J) )       
     &                                  -( U(I,J,K,1)-EA_U(J) ) )       
     &                               *PDZ                               
     &                              + (  ( U(I-1,J,K+1,1)-EA_U(J) )     
     &                                  -( U(I-1,J,K,1)-EA_U(J) ) )     
     &                               *PDZ )                             
     &                     *(  (  ( T(I,J,K+1)-EA_T(J) )                
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDZ )                                    
     &                    + 0.5D0*(   (  ( U(I,J,K,1)-EA_U(J) )         
     &                                  -( U(I,J,K-1,1)-EA_U(J) ) )     
     &                               *PDZ                               
     &                              + (  ( U(I-1,J,K,1)-EA_U(J) )       
     &                                  -( U(I-1,J,K-1,1)-EA_U(J) ) )   
     &                               *PDZ )                             
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I,J,K-1)-EA_T(J) ) )              
     &                        *PDZ ) )                                  
C                                                                       
C --- BUDGET OF THE WALL-NORMAL TURBULENT HEAT FLUX                     
C                                                                       
      PRO_VT(J)= PRO_VT(J)                                              
     &          - 0.5D0*(  ( U(I,J,K,2)-EA_V(J) )                       
     &                    +( U(I,J-1,K,2)-EA_V(J-1) ) )                 
     &           *0.5D0*(  ( U(I,J,K,2)-EA_V(J) )                       
     &                    +( U(I,J-1,K,2)-EA_V(J-1) ) )                 
     &          - ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(  (  DR(J)*(  0.5D0*(  ( U(I,J,K,2)-EA_V(J) )  
     &                                         +(  U(I,J+1,K,2)         
     &                                            -EA_V(J+1) ) )        
     &                                *(  ( EA_V(J+1)-EA_V(J) )         
     &                                   *PDR(J+1) ) )                  
     &                       +DR(J+1)*(  0.5D0*(  (  U(I,J-1,K,2)       
     &                                              -EA_V(J-1) )        
     &                                           +(  U(I,J,K,2)         
     &                                              -EA_V(J) ) )        
     &                                  *(  ( EA_V(J)-EA_V(J-1) )       
     &                                     *PDR(J) ) )                  
     &                     )*( 0.5D0*PDRR(J+1) )                        
     &                    +(  DR(J-1)*(  0.5D0*(  (  U(I,J-1,K,2)       
     &                                              -EA_V(J-1) )        
     &                                           +(  U(I,J,K,2)         
     &                                              -EA_V(J) ) )        
     &                                  *(  ( EA_V(J)-EA_V(J-1) )       
     &                                     *PDR(J) ) )                  
     &                       +DR(J)*(  0.5D0*(  (  U(I,J-2,K,2)         
     &                                            -EA_V(J-2) )          
     &                                         +(  U(I,J-1,K,2)         
     &                                            -EA_V(J-1) ) )        
     &                                *(  ( EA_V(J-1)-EA_V(J-2) )       
     &                                   *PDR(J-1) ) )                  
     &                     )*( 0.5D0*PDRR(J) ) )                        
     &          - 0.5D0*(  ( U(I,J-1,K,2)-EA_V(J-1) )                   
     &                    +( U(I,J,K,2)-EA_V(J) ) )                     
     &           *0.5D0*(   ( U(I,J,K,2)-EA_V(J) )                      
     &                     *(  ( EA_T(J+1)-EA_T(J) )                    
     &                        *PDRR(J+1) )                              
     &                    + ( U(I,J-1,K,2)-EA_V(J-1) )                  
     &                     *(  ( EA_T(J)-EA_T(J-1) )                    
     &                        *PDRR(J) ) )                              
C                                                                       
C                                                                       
      TDF_VT(J)= TDF_VT(J)                                              
     &         -((0.5D0*((T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J))))      
     &           *0.25D0*((U(I+1,J,K,2)-EA_V(J))                        
     &                       +(U(I+1,J-1,K,2)-EA_V(J-1))                
     &                    +(U(I,J,K,2)-EA_V(J))                         
     &                       +(U(I,J-1,K,2)-EA_V(J-1)))                 
     &           *(U(I,J,K,1)-EA_U(J))-                                 
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)) 
     &               +(U(I-1,J,K,2)-EA_V(J))+(U(I-1,J-1,K,2)-EA_V(J-1)))
     &           *(U(I-1,J,K,1)-EA_U(J)))*PDX                           
     &         -(((DR(J)*(T(I,J+1,K)-EA_T(J+1))                         
     &              +DR(J+1)*(T(I,J,K)-EA_T(J)))/(DR(J+1)+DR(J)))       
     &           *(U(I,J,K,2)-EA_V(J))**2                               
     &           -((DR(J-1)*(T(I,J,K)-EA_T(J))                          
     &              +DR(J)*(T(I,J-1,K)-EA_T(J-1)))/(DR(J)+DR(J-1)))     
     &           *(U(I,J-1,K,2)-EA_V(J-1))**2)*PDR(J)                   
     &         -((0.5D0*((T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K+1,2)-EA_V(J))                        
     &                       +(U(I,J-1,K+1,2)-EA_V(J-1))                
     &                    +(U(I,J,K,2)-EA_V(J))                         
     &                       +(U(I,J-1,K,2)-EA_V(J-1)))                 
     &           *(U(I,J,K,3)-EA_W(J))-                                 
     &           (0.5D0*((T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J))))      
     &           *0.25D0*((U(I,J,K,2)-EA_V(J))+(U(I,J-1,K,2)-EA_V(J-1)) 
     &              +(U(I,J,K-1,2)-EA_V(J))+(U(I,J-1,K-1,2)-EA_V(J-1))) 
     &           *(U(I,J,K-1,3)-EA_W(J)))*PDZ                           
C                                                                       
C                                                                       
C=============================================== TPG                    
C                                                                       
      TPG_VT(J)= TPG_VT(J)                                              
     &          - 1.0D0/DRR2(J)*(                                       
     &                   (0.5D0*(( T(I,J+1,K)-EA_T(J+1) )               
     &                         +( T(I,J,K)-EA_T(J) ))                   
     &                    *(  ( P(I,J+1,K)-EA_P(J+1) )                  
     &                       -( P(I,J,K)-EA_P(J) ) )                    
     &                     *PDRR(J+1)*DRR(J)                            
     &                    )                                             
     &                  +(0.5D0*(( T(I,J,K)-EA_T(J) )                   
     &                         +( T(I,J-1,K)-EA_T(J-1) ))               
     &                    *(  ( P(I,J,K)-EA_P(J) )                      
     &                       -( P(I,J-1,K)-EA_P(J-1) ) )                
     &                     *PDRR(J)*DRR(J+1)                            
     &                    )                                             
     &                          )                                       
C                                                                       
C=============================================== PTG                    
C                                                                       
      PTG_VT(J)= PTG_VT(J)                                              
     &           +1.0D0/DRR2(J)*(                                       
     &                   (0.5D0*(( P(I,J+1,K)-EA_P(J+1) )               
     &                         +( P(I,J,K)-EA_P(J) ))                   
     &                    *(  ( T(I,J+1,K)-EA_T(J+1) )                  
     &                       -( T(I,J,K)-EA_T(J) ) )                    
     &                     *PDRR(J+1)*DRR(J)                            
     &                    )                                             
     &                  +(0.5D0*(( P(I,J,K)-EA_P(J) )                   
     &                         +( P(I,J-1,K)-EA_P(J-1) ))               
     &                    *(  ( T(I,J,K)-EA_T(J) )                      
     &                       -( T(I,J-1,K)-EA_T(J-1) ) )                
     &                     *PDRR(J)*DRR(J+1)                            
     &                    )                                             
     &                          )                                       
C                                                                       
C=============================================== PDF                    
C                                                                       
      PDF_VT(J)= PDF_VT(J)                                              
     &           -1.0D0/DRR2(J)*(                                       
     &                     (  ( P(I,J+1,K)-EA_P(J+1) )                  
     &                       *( T(I,J+1,K)-EA_T(J+1) )                  
     &                       -( P(I,J,K)-EA_P(J) )                      
     &                       *( T(I,J,K)-EA_T(J) )                      
     &                      )*PDRR(J+1)*DRR(J)                          
     &                    +(  ( P(I,J,K)-EA_P(J) )                      
     &                       *( T(I,J,K)-EA_T(J) )                      
     &                       -( P(I,J-1,K)-EA_P(J-1) )                  
     &                       *( T(I,J-1,K)-EA_T(J-1) )                  
     &                      )*PDRR(J)*DRR(J+1)                          
     &                           )                                      
C                                                                       
C===============================================                        
C                                                                       
      ABE6=   PPR*(   (     0.5D0*(  (  U(I+1,J,K,2)                    
     &                                            -EA_V(J) )            
     &                                         +(  U(I+1,J-1,K,2)       
     &                                            -EA_V(J-1) ) )        
     &                      +0.5D0*(  (  U(I,J,K,2)                     
     &                                              -EA_V(J) )          
     &                                           +(  U(I,J-1,K,2)       
     &                                              -EA_V(J-1) ) ) )    
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I+1,J,K)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDX )                                       
     &              -(     0.5D0*(  (  U(I,J,K,2)                       
     &                                            -EA_V(J) )            
     &                                         +(  U(I,J-1,K,2)         
     &                                            -EA_V(J-1) ) )        
     &                      +0.5D0*(  (  U(I-1,J,K,2)                   
     &                                              -EA_V(J) )          
     &                                           +(  U(I-1,J-1,K,2)     
     &                                              -EA_V(J-1) ) ) )    
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I-1,J,K)-EA_T(J) ) )                 
     &                     *PDX ))*PDX                                  
C                                                                       
C                                                                       
      ABE7=   PPR*(   (     0.5D0*(  (  U(I,J,K+1,2)                    
     &                                            -EA_V(J) )            
     &                                         +(  U(I,J-1,K+1,2)       
     &                                            -EA_V(J-1) ) )        
     &                      +0.5D0*(  (  U(I,J,K,2)                     
     &                                              -EA_V(J) )          
     &                                           +(  U(I,J-1,K,2)       
     &                                              -EA_V(J-1) ) ) )    
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K+1)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDZ )                                       
     &              -(     0.5D0*(  (  U(I,J,K,2)                       
     &                                            -EA_V(J) )            
     &                                         +(  U(I,J-1,K,2)         
     &                                            -EA_V(J-1) ) )        
     &                      +0.5D0*(  (  U(I,J,K-1,2)                   
     &                                              -EA_V(J) )          
     &                                           +(  U(I,J-1,K-1,2)     
     &                                              -EA_V(J-1) ) ) )    
     &                     * 0.5D0                                      
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J,K-1)-EA_T(J) ) )                 
     &                     *PDZ ))*PDZ                                  
C                                                                       
C                                                                       
      ABE10=( ( (T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J)))*0.5D0*         
     &        (((U(I+1,J,K,2)-EA_V(J))-(U(I,J,K,2)-EA_V(J)))*PDX        
     &         +((U(I+1,J-1,K,2)-EA_V(J-1))-(U(I,J-1,K,2)-EA_V(J-1)))   
     &          *PDX )*0.5D0                                            
     &       -( (T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J)))*0.5D0*         
     &        (((U(I,J,K,2)-EA_V(J))-(U(I-1,J,K,2)-EA_V(J)))*PDX        
     &         +((U(I,J-1,K,2)-EA_V(J-1))-(U(I-1,J-1,K,2)-EA_V(J-1)))   
     &          *PDX )*0.5D0 )*PDX                                      
C                                                                       
C                                                                       
      ABE11=( ( (T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J)))*0.5D0*         
     &        (((U(I,J,K+1,2)-EA_V(J))-(U(I,J,K,2)-EA_V(J)))*PDZ        
     &         +((U(I,J-1,K+1,2)-EA_V(J-1))-(U(I,J-1,K,2)-EA_V(J-1)))   
     &          *PDZ )*0.5D0                                            
     &       -( (T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J)))*0.5D0*         
     &        (((U(I,J,K,2)-EA_V(J))-(U(I,J,K-1,2)-EA_V(J)))*PDZ        
     &         +((U(I,J-1,K,2)-EA_V(J-1))-(U(I,J-1,K-1,2)-EA_V(J-1)))   
     &          *PDZ )*0.5D0 )*PDZ                                      
C                                                                       
C                                                                       
      RMDFVT(J)= RMDFVT(J)                                              
     &          +(   (  (  DR(J)*( T(I,J+1,K)-EA_T(J+1) )               
     &                    +DR(J+1)*( T(I,J,K)-EA_T(J) ) )               
     &                 *( 0.5D0*PDRR(J+1) ) )                           
     &              *(  CEN1_F(J,1)*( U(I,J+1,K,2)-EA_V(J+1) )          
     &                 +CEN1_M(J,1)*( U(I,J,K,2)-EA_V(J) )              
     &                 +CEN1_B(J,1)*( U(I,J-1,K,2)-EA_V(J-1) ) )        
     &             - (  (  DR(J-1)*( T(I,J,K)-EA_T(J) )                 
     &                    +DR(J)*( T(I,J-1,K)-EA_T(J-1) ) )             
     &                 *( 0.5D0*PDRR(J) ) )                             
     &              *(  CEN1_F(J-1,1)*( U(I,J,K,2)-EA_V(J) )            
     &                 +CEN1_M(J-1,1)*( U(I,J-1,K,2)-EA_V(J-1) )        
     &                 +CEN1_B(J-1,1)*( U(I,J-2,K,2)-EA_V(J-2) ) )      
     &           )*PDR(J)                                               
     &          +PPR*(   ( U(I,J,K,2)-EA_V(J) )                         
     &                  *(  (  ( T(I,J+1,K)-EA_T(J+1) )                 
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDRR(J+1) )                                 
     &                 - ( U(I,J-1,K,2)-EA_V(J-1) )                     
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J-1,K)-EA_T(J-1) ) )               
     &                     *PDRR(J) )                                   
     &               )*PDR(J)+ABE6+ABE7+ABE10+ABE11                     
C                                                                       
C                                                                       
      DIS_VT(J)= DIS_VT(J)                                              
     &          -COE_BD*(   0.5D0*(   (  ( U(I+1,J,K,2)-EA_V(J) )       
     &                                  -( U(I,J,K,2)-EA_V(J) ) )       
     &                               *PDX                               
     &                              + (  ( U(I+1,J-1,K,2)-EA_V(J-1) )   
     &                                  -( U(I,J-1,K,2)-EA_V(J-1) ) )   
     &                               *PDX )                             
     &                     *(  (  ( T(I+1,J,K)-EA_T(J) )                
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDX )                                    
     &                    + 0.5D0*(   (  ( U(I,J,K,2)-EA_V(J) )         
     &                                  -( U(I-1,J,K,2)-EA_V(J) ) )     
     &                               *PDX                               
     &                              + (  ( U(I,J-1,K,2)-EA_V(J-1) )     
     &                                  -( U(I-1,J-1,K,2)-EA_V(J-1) ) ) 
     &                               *PDX )                             
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I-1,J,K)-EA_T(J) ) )              
     &                        *PDX ) )                                  
     &          -0.5D0*(   (  CEN1_F(J,1)*( U(I,J+1,K,2)-EA_V(J+1) )    
     &                       +CEN1_M(J,1)*( U(I,J,K,2)-EA_V(J) )        
     &                       +CEN1_B(J,1)*( U(I,J-1,K,2)-EA_V(J-1) ) )  
     &                    *(  (  ( T(I,J+1,K)-EA_T(J+1) )               
     &                          -( T(I,J,K)-EA_T(J) ) )                 
     &                       *PDRR(J+1) )                               
     &                   + (  CEN1_F(J-1,1)*( U(I,J,K,2)-EA_V(J) )      
     &                       +CEN1_M(J-1,1)*( U(I,J-1,K,2)-EA_V(J-1) )  
     &                       +CEN1_B(J-1,1)*( U(I,J-2,K,2)-EA_V(J-2) ) )
     &                    *(  (  ( T(I,J,K)-EA_T(J) )                   
     &                          -( T(I,J-1,K)-EA_T(J-1) ) )             
     &                       *PDRR(J) ) )                               
     &          - PPR*(  (  (  ( U(I,J,K,2)-EA_V(J) )                   
     &                        -( U(I,J-1,K,2)-EA_V(J-1) ) )             
     &                     *PDR(J) )                                    
     &                  *(  CEN1_F(J,2)*( T(I,J+1,K)-EA_T(J+1) )        
     &                     +CEN1_M(J,2)*( T(I,J,K)-EA_T(J) )            
     &                     +CEN1_B(J,2)*( T(I,J-1,K)-EA_T(J-1) ) ) )    
     &          -COE_BD*(   0.5D0*(   (  ( U(I,J,K+1,2)-EA_V(J) )       
     &                                  -( U(I,J,K,2)-EA_V(J) ) )       
     &                               *PDZ                               
     &                              + (  ( U(I,J-1,K+1,2)-EA_V(J-1) )   
     &                                  -( U(I,J-1,K,2)-EA_V(J-1) ) )   
     &                               *PDZ )                             
     &                     *(  (  ( T(I,J,K+1)-EA_T(J) )                
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDZ )                                    
     &                    + 0.5D0*(   (  ( U(I,J,K,2)-EA_V(J) )         
     &                                  -( U(I,J,K-1,2)-EA_V(J) ) )     
     &                               *PDZ                               
     &                              + (  ( U(I,J-1,K,2)-EA_V(J-1) )     
     &                                  -( U(I,J-1,K-1,2)-EA_V(J-1) ) ) 
     &                               *PDZ )                             
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I,J,K-1)-EA_T(J) ) )              
     &                        *PDZ ) )                                  
C                                                                       
C --- BUDGET OF THE SPANWISE TURBULENT HEAT FLUX                        
C                                                                       
      PRO_WT(J)= PRO_WT(J)                                              
     &          - 0.5D0*(  ( U(I,J,K,3)-EA_W(J) )                       
     &                    +( U(I,J,K-1,3)-EA_W(J) ) )                   
     &           *0.5D0*(  ( U(I,J,K,2)-EA_V(J) )                       
     &                    +( U(I,J-1,K,2)-EA_V(J-1) ) )                 
     &          - ( T(I,J,K)-EA_T(J) )                                  
     &           *0.5D0*(  0.5D0*(   0.5D0*(  ( U(I,J,K+1,2)-EA_V(J) )  
     &                                       +( U(I,J,K,2)-EA_V(J) ) )  
     &                              *(  ( EA_W(J+1)-EA_W(J) )           
     &                                 *PDRR(J+1) )                     
     &                             + 0.5D0*(  (  U(I,J-1,K+1,2)         
     &                                          -EA_V(J-1) )            
     &                                       +(  U(I,J-1,K,2)           
     &                                          -EA_V(J-1) ) )          
     &                              *(  ( EA_W(J)-EA_W(J-1) )           
     &                                 *PDRR(J) ) )                     
     &                    +0.5D0*(   0.5D0*(  ( U(I,J,K,2)-EA_V(J) )    
     &                                       +( U(I,J,K-1,2)-EA_V(J) ) )
     &                              *(  ( EA_W(J+1)-EA_W(J) )           
     &                                 *PDRR(J+1) )                     
     &                             + 0.5D0*(  ( U(I,J-1,K,2)-EA_V(J-1) )
     &                                       +(  U(I,J-1,K-1,2)         
     &                                          -EA_V(J-1) ) )          
     &                              *(  ( EA_W(J)-EA_W(J-1) )           
     &                                 *PDRR(J) ) ) )                   
     &          - 0.5D0*(  ( U(I,J,K-1,3)-EA_W(J) )                     
     &                    +( U(I,J,K,3)-EA_W(J) ) )                     
     &           *0.5D0*(   ( U(I,J,K,2)-EA_V(J) )                      
     &                     *(  ( EA_T(J+1)-EA_T(J) )                    
     &                        *PDRR(J+1) )                              
     &                    + ( U(I,J-1,K,2)-EA_V(J-1) )                  
     &                     *(  ( EA_T(J)-EA_T(J-1) )                    
     &                        *PDRR(J) ) )                              
C                                                                       
C                                                                       
      TDF_WT(J)= TDF_WT(J)                                              
     &         -((0.5D0*((T(I+1,J,K)-EA_T(J))+(T(I,J,K)-EA_T(J))))*     
     &          0.25D0*((U(I+1,J,K,3)-EA_W(J))+(U(I+1,J,K-1,3)-EA_W(J)) 
     &           +(U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J)))          
     &          *(U(I,J,K,1)-EA_U(J))-                                  
     &         (0.5D0*((T(I,J,K)-EA_T(J))+(T(I-1,J,K)-EA_T(J))))*       
     &          0.25D0*((U(I,J,K,3)-EA_W(J))+(U(I,J,K-1,3)-EA_W(J))     
     &           +(U(I-1,J,K,3)-EA_W(J))+(U(I-1,J,K-1,3)-EA_W(J)))      
     &          *(U(I-1,J,K,1)-EA_U(J)))*PDX                            
     &         -((DR(J)*(T(I,J+1,K)-EA_T(J+1))                          
     &                       +DR(J+1)*(T(I,J,K)-EA_T(J)))/              
     &           (DR(J+1)+DR(J))*0.5D0*(                                
     &          (DR(J)*(U(I,J+1,K,3)-EA_W(J+1))                         
     &                       +DR(J+1)*(U(I,J,K,3)-EA_W(J)))/            
     &           (DR(J+1)+DR(J))+                                       
     &          (DR(J)*(U(I,J+1,K-1,3)-EA_W(J+1))                       
     &                       +DR(J+1)*(U(I,J,K-1,3)-EA_W(J)))/          
     &           (DR(J+1)+DR(J)))*(U(I,J,K,2)-EA_V(J))-                 
     &          (DR(J-1)*(T(I,J,K)-EA_T(J))                             
     &                       +DR(J)*(T(I,J-1,K)-EA_T(J-1)))/            
     &           (DR(J)+DR(J-1))*0.5D0*(                                
     &          (DR(J-1)*(U(I,J,K,3)-EA_W(J))                           
     &                       +DR(J)*(U(I,J-1,K,3)-EA_W(J-1)))/          
     &           (DR(J)+DR(J-1))+                                       
     &          (DR(J-1)*(U(I,J,K-1,3)-EA_W(J))                         
     &                       +DR(J)*(U(I,J-1,K-1,3)-EA_W(J-1)))/        
     &           (DR(J)+DR(J-1)))*(U(I,J-1,K,2)-EA_V(J-1)))*PDR(J)      
     &         -((0.5D0*((T(I,J,K+1)-EA_T(J))+(T(I,J,K)-EA_T(J))))*     
     &          (U(I,J,K,3)-EA_W(J))**2                                 
     &         -(0.5D0*((T(I,J,K)-EA_T(J))+(T(I,J,K-1)-EA_T(J))))*      
     &          (U(I,J,K-1,3)-EA_W(J))**2)*PDZ                          
C                                                                       
C=============================================== TPG                    
C                                                                       
      TPG_WT(J)= TPG_WT(J)                                              
     &          -0.5D0*( 0.5D0*(( T(I,J,K+1)-EA_T(J) )                  
     &                         +( T(I,J,K)-EA_T(J) ))                   
     &                     *(  ( P(I,J,K+1)-EA_P(J) )                   
     &                        -( P(I,J,K)-EA_P(J) ) )                   
     &                     *PDZ                                         
     &                  +0.5D0*(( T(I,J,K)-EA_T(J) )                    
     &                         +( T(I,J,K-1)-EA_T(J) ))                 
     &                     *(  ( P(I,J,K)-EA_P(J) )                     
     &                        -( P(I,J,K-1)-EA_P(J) ) )                 
     &                     *PDZ )                                       
C                                                                       
C=============================================== PTG                    
C                                                                       
      PTG_WT(J)= PTG_WT(J)                                              
     &          +0.5D0*( 0.5D0*(( P(I,J,K+1)-EA_P(J) )                  
     &                         +( P(I,J,K)-EA_P(J) ))                   
     &                     *(  ( T(I,J,K+1)-EA_T(J) )                   
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDZ                                         
     &                  +0.5D0*(( P(I,J,K)-EA_P(J) )                    
     &                         +( P(I,J,K-1)-EA_P(J) ))                 
     &                     *(  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J,K-1)-EA_T(J) ) )                 
     &                     *PDZ )                                       
C                                                                       
C=============================================== PDF                    
C                                                                       
      PDF_WT(J)= PDF_WT(J)                                              
     &          -0.5D0*(                                                
     &                   ( ( P(I,J,K+1)-EA_P(J) )                       
     &                    *( T(I,J,K+1)-EA_T(J) )                       
     &                    -( P(I,J,K)-EA_P(J) )                         
     &                    *( T(I,J,K)-EA_T(J) ) )                       
     &                   *PDZ                                           
     &                  +( ( P(I,J,K)-EA_P(J) )                         
     &                    *( T(I,J,K)-EA_T(J) )                         
     &                    -( P(I,J,K-1)-EA_P(J) )                       
     &                    *( T(I,J,K-1)-EA_T(J) ) )                     
     &                   *PDZ                                           
     &                  )                                               
C                                                                       
C===============================================                        
C                                                                       
      RMDFWT(J)= RMDFWT(J)                                              
     &          +(   (  (  DR(J)*( T(I,J+1,K)-EA_T(J+1) )               
     &                    +DR(J+1)*( T(I,J,K)-EA_T(J) ) )               
     &                 *( 0.5D0*PDRR(J+1) ) )                           
     &              *0.5D0*(   (  ( U(I,J+1,K,3)-EA_W(J+1) )            
     &                           -( U(I,J,K,3)-EA_W(J) ) )              
     &                        *PDRR(J+1)                                
     &                       + (  ( U(I,J+1,K-1,3)-EA_W(J+1) )          
     &                           -( U(I,J,K-1,3)-EA_W(J) ) )            
     &                        *PDRR(J+1) )                              
     &             - (  (  DR(J-1)*( T(I,J,K)-EA_T(J) )                 
     &                    +DR(J)*( T(I,J-1,K)-EA_T(J-1) ) )             
     &                 *( 0.5D0*PDRR(J) ) )                             
     &              *0.5D0*(   (  ( U(I,J,K,3)-EA_W(J) )                
     &                           -( U(I,J-1,K,3)-EA_W(J-1) ) )          
     &                        *PDRR(J)                                  
     &                       + (  ( U(I,J,K-1,3)-EA_W(J) )              
     &                           -( U(I,J-1,K-1,3)-EA_W(J-1) ) )        
     &                        *PDRR(J) )                                
     &           )*PDR(J)                                               
     &          +PPR*(   (  (  DR(J)*( 0.5D0*(  (  U(I,J+1,K-1,3)       
     &                                            -EA_W(J+1) )          
     &                                         +(  U(I,J+1,K,3)         
     &                                            -EA_W(J+1) ) ) )      
     &                        +DR(J+1)*( 0.5D0*(  (  U(I,J,K-1,3)       
     &                                              -EA_W(J) )          
     &                                           +(  U(I,J,K,3)         
     &                                              -EA_W(J) ) ) ) )    
     &                     *( 0.5D0*PDRR(J+1) ) )                       
     &                  *(  (  ( T(I,J+1,K)-EA_T(J+1) )                 
     &                        -( T(I,J,K)-EA_T(J) ) )                   
     &                     *PDRR(J+1) )                                 
     &                 - (  (  DR(J-1)*( 0.5D0*(  (  U(I,J,K-1,3)       
     &                                              -EA_W(J) )          
     &                                           +(  U(I,J,K,3)         
     &                                              -EA_W(J) ) ) )      
     &                        +DR(J)*( 0.5D0*(  (  U(I,J-1,K-1,3)       
     &                                            -EA_W(J-1) )          
     &                                         +(  U(I,J-1,K,3)         
     &                                            -EA_W(J-1) ) ) ) )    
     &                     *( 0.5D0*PDRR(J) ) )                         
     &                  *(  (  ( T(I,J,K)-EA_T(J) )                     
     &                        -( T(I,J-1,K)-EA_T(J-1) ) )               
     &                     *PDRR(J) )                                   
     &               )*PDR(J)                                           
C                                                                       
C                                                                       
      DIS_WT(J)= DIS_WT(J)                                              
     &          -COE_BD*(   0.5D0*(   (  ( U(I+1,J,K,3)-EA_W(J) )       
     &                                  -( U(I,J,K,3)-EA_W(J) ) )       
     &                               *PDX                               
     &                              + (  ( U(I+1,J,K-1,3)-EA_W(J) )     
     &                                  -( U(I,J,K-1,3)-EA_W(J) ) )     
     &                               *PDX )                             
     &                     *(  (  ( T(I+1,J,K)-EA_T(J) )                
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDX )                                    
     &                    + 0.5D0*(   (  ( U(I,J,K,3)-EA_W(J) )         
     &                                  -( U(I-1,J,K,3)-EA_W(J) ) )     
     &                               *PDX                               
     &                              + (  ( U(I,J,K-1,3)-EA_W(J) )       
     &                                  -( U(I-1,J,K-1,3)-EA_W(J) ) )   
     &                               *PDX )                             
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I-1,J,K)-EA_T(J) ) )              
     &                        *PDX ) )                                  
     &          -COE_BD*(   0.5D0*(   (  ( U(I,J+1,K,3)-EA_W(J+1) )     
     &                                  -( U(I,J,K,3)-EA_W(J) ) )       
     &                               *PDRR(J+1)                         
     &                              + (  ( U(I,J+1,K-1,3)-EA_W(J+1) )   
     &                                  -( U(I,J,K-1,3)-EA_W(J) ) )     
     &                               *PDRR(J+1) )                       
     &                     *(  (  ( T(I,J+1,K)-EA_T(J+1) )              
     &                           -( T(I,J,K)-EA_T(J) ) )                
     &                        *PDRR(J+1) )                              
     &                    + 0.5D0*(   (  ( U(I,J,K,3)-EA_W(J) )         
     &                                  -( U(I,J-1,K,3)-EA_W(J-1) ) )   
     &                               *PDRR(J)                           
     &                              + (  ( U(I,J,K-1,3)-EA_W(J) )       
     &                                  -( U(I,J-1,K-1,3)-EA_W(J-1) ) ) 
     &                               *PDRR(J) )                         
     &                     *(  (  ( T(I,J,K)-EA_T(J) )                  
     &                           -( T(I,J-1,K)-EA_T(J-1) ) )            
     &                        *PDRR(J) ) )                              
     &          -0.5D0*(   (  (  ( U(I,J,K+1,3)-EA_W(J) )               
     &                          -( U(I,J,K-1,3)-EA_W(J) ) )             
     &                       *( 0.5D0*PDZ ) )                           
     &                    *(  (  ( T(I,J,K+1)-EA_T(J) )                 
     &                          -( T(I,J,K)-EA_T(J) ) )                 
     &                       *PDZ )                                     
     &                   + (  (  ( U(I,J,K,3)-EA_W(J) )                 
     &                          -( U(I,J,K-2,3)-EA_W(J) ) )             
     &                       *( 0.5D0*PDZ ) )                           
     &                    *(  (  ( T(I,J,K)-EA_T(J) )                   
     &                          -( T(I,J,K-1)-EA_T(J) ) )               
     &                       *PDZ ) )                                   
     &          - PPR*(  (  (  ( U(I,J,K,3)-EA_W(J) )                   
     &                        -( U(I,J,K-1,3)-EA_W(J) ) )               
     &                     *PDZ )                                       
     &                  *(  (  ( T(I,J,K+1)-EA_T(J) )                   
     &                        -( T(I,J,K-1)-EA_T(J) ) )                 
     &                     *( 0.5D0*PDZ ) ) )                           
C                                                                       
   10 CONTINUE                                                          
!XOCL END SPREAD                                                        
C                                                                       
C                                                                       
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE COEF_DEM(PR1,PR2,PPR1,PPR2,PPE1,PPE2,COE1BD,COE2BD)    
C                                                                       
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCDATA'                                         
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
C---  LOCAL VARIABLES  -------------------------------------------------
C                                                                       
      DIMENSION YPLS1(JG)                                               
      DIMENSION YPLS2(JG)                                               
C                                                                       
      COMMON /FD1C/ CEN1_F(0:JG,2),CEN1_M(0:JG,2),CEN1_B(0:JG,2)        
      COMMON /FD2C/ CEN2_F(0:JG,2),CEN2_M(0:JG,2),CEN2_B(0:JG,2)        
C                                                                       
      COMMON /RVTI/ PDT                                                 
C     COMMON /RVRE/ PRE                                                 
      COMMON /RVXZ/ PXZ                                                 
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /YPC1/ YPLS1G(JG)                                          
      COMMON /YPC2/ YPLS2G(JG)                                          
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (YPLS1G,YPLS1),(YPLS2G,YPLS2)                         
C                                                                       
C=======================================================================
C                                                                       
       PDT=1.0D0/DT                                                     
       PRE=1.0D0/RE                                                     
      PPE1=1.0D0/( RE*PR1 )                                             
      PPE2=1.0D0/( RE*PR2 )                                             
       PXZ=1.0D0/DBLE( IG*KG )                                          
      PPR1=1.0D0/PR1                                                    
      PPR2=1.0D0/PR2                                                    
      COE1BD=(1.0D0+PR1)/(2.0D0*PR1)                                    
      COE2BD=(1.0D0+PR2)/(2.0D0*PR2)                                    
C                                                                       
      DO 10 J=1,JG                                                      
C       YPLS1(J)=RE*( R(J)-9.0D0 )                                      
C       YPLS2(J)=RE*( RR(J)-9.0D0 )                                     
       YPLS1(J)=RE*( R(J) )                                             
       YPLS2(J)=RE*( RR(J) )                                            
   10 CONTINUE                                                          
C                                                                       
      DO 20 J=0,JG                                                      
       CEN1_F(J,1)=DR(J)/( DR(J+1)*( DR(J)+DR(J+1) ) )                  
       CEN1_F(J,2)=DRR(J)/( DRR(J+1)*( DRR(J)+DRR(J+1) ) )              
       CEN1_M(J,1)=( DR(J+1)-DR(J) )/( DR(J)*DR(J+1) )                  
       CEN1_M(J,2)=( DRR(J+1)-DRR(J) )/( DRR(J)*DRR(J+1) )              
       CEN1_B(J,1)=-DR(J+1)/( DR(J)*( DR(J)+DR(J+1) ) )                 
       CEN1_B(J,2)=-DRR(J+1)/( DRR(J)*( DRR(J)+DRR(J+1) ) )             
C                                                                       
       CEN2_F(J,1)=2.0D0/( DR(J+1)*( DR(J)+DR(J+1) ) )                  
       CEN2_F(J,2)=2.0D0/( DRR(J+1)*( DRR(J)+DRR(J+1) ) )               
       CEN2_M(J,1)=-2.0D0/( DR(J)*DR(J+1) )                             
       CEN2_M(J,2)=-2.0D0/( DRR(J)*DRR(J+1) )                           
       CEN2_B(J,1)=2.0D0/( DR(J)*( DR(J)+DR(J+1) ) )                    
       CEN2_B(J,2)=2.0D0/( DRR(J)*( DRR(J)+DRR(J+1) ) )                 
   20 CONTINUE                                                          
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE CLR                                                    
C                                                                       
C     REVISED ON 2001.03.04  BY H.ABE (QA-VT)                           
C     REVISED ON 2000.10.17  BY H.ABE (QUADRUPLE CORR.)                 
C     REVISED ON 2000.10.17  BY H.ABE (QUADRANT ANALYSIS: VT)           
C     REVISED BY H.ABE (2000.09.30) ADD: TSKEWVT & TFLATVT              
C     REVISED BY H.ABE (2000.09.30) ADD: 3-POINT CORR. (TTT,UTT,ETC)    
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
C                                                                       
      COMMON /SNUM/ NSTCS                                               
      COMMON /STIM/ STCSTM                                              
C                                                                       
C---  LOCAL VARIABLES  -------------------------------------------------
C                                                                       
      DIMENSION TA_U(JG),TA_V(JG),TA_W(JG),TA_P(JG),                    
     &          U_RMS(JG),V_RMS(JG),W_RMS(JG),P_RMS(JG)                 
C                                                                       
      DIMENSION TAT1(JG),TRMS1(JG)                                      
      DIMENSION FLXUT1(JG),FLXVT1(JG),FLXWT1(JG)                        
      DIMENSION ATHFV1(JG),ATOTAL1(JG)                                  
      DIMENSION TAT2(JG),TRMS2(JG)                                      
      DIMENSION FLXUT2(JG),FLXVT2(JG),FLXWT2(JG)                        
      DIMENSION ATHFV2(JG),ATOTAL2(JG)                                  
C                                                                       
      DIMENSION PRO1TV(JG),DIS1TV(JG),                                  
     &          TDF1TV(JG),RMD1TV(JG)                                   
      DIMENSION PRO2TV(JG),DIS2TV(JG),                                  
     &          TDF2TV(JG),RMD2TV(JG)                                   
      DIMENSION PRO1UT(JG),DIS1UT(JG),TPG1UT(JG),                       
     &          TDF1UT(JG),RMD1UT(JG)                                   
      DIMENSION PRO2UT(JG),DIS2UT(JG),TPG2UT(JG),                       
     &          TDF2UT(JG),RMD2UT(JG)                                   
      DIMENSION PRO1VT(JG),DIS1VT(JG),TPG1VT(JG),                       
     &          TDF1VT(JG),RMD1VT(JG)                                   
      DIMENSION PRO2VT(JG),DIS2VT(JG),TPG2VT(JG),                       
     &          TDF2VT(JG),RMD2VT(JG)                                   
      DIMENSION PRO1WT(JG),DIS1WT(JG),TPG1WT(JG),                       
     &          TDF1WT(JG),RMD1WT(JG)                                   
      DIMENSION PRO2WT(JG),DIS2WT(JG),TPG2WT(JG),                       
     &          TDF2WT(JG),RMD2WT(JG)                                   
      DIMENSION ATSTRM(IG,JG,4),ATSPAN(KG,JG,4)                         
      DIMENSION ATPC1T(IG,JG,2),ATPC3T(KG,JG,2)                         
C                                                                       
      DIMENSION TSKEWVT(JG,2),TFLATVT(JG,2)                             
C                                                                       
      DIMENSION AT1TRI(JG,10),AT1QUAD(JG,19),AQAVT1(JG,4)               
      DIMENSION AT2TRI(JG,10),AT2QUAD(JG,19),AQAVT2(JG,4)               
C                                                                       
      COMMON /NQAC/ NQACU,NQACT                                         
C                                                                       
      DIMENSION ANQAVT(JG,4,2)                                          
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /TAVE/ TAGU(JG),TAGV(JG),TAGW(JG),TAGP(JG),                
     &              UGRMS(JG),VGRMS(JG),WGRMS(JG),PGRMS(JG)             
C                                                                       
      COMMON /TTM1/ TAT1G(JG),TRMS1G(JG),                               
     &              FLXUT1G(JG),FLXVT1G(JG),FLXWT1G(JG)                 
C                                                                       
      COMMON /TTM2/ TAT2G(JG),TRMS2G(JG),                               
     &              FLXUT2G(JG),FLXVT2G(JG),FLXWT2G(JG)                 
C                                                                       
      COMMON /THF1/ ATHFV1G(JG),ATOTAL1G(JG)                            
      COMMON /THF2/ ATHFV2G(JG),ATOTAL2G(JG)                            
C                                                                       
      COMMON /KON1/ PRO1TG(JG),DIS1TG(JG),                              
     &              TDF1TG(JG),RMD1TG(JG),                              
     &              PRO1UG(JG),DIS1UG(JG),TPG1UG(JG),                   
     &              TDF1UG(JG),RMD1UG(JG),                              
     &              PRO1VG(JG),DIS1VG(JG),TPG1VG(JG),                   
     &              TDF1VG(JG),RMD1VG(JG),                              
     &              PRO1WG(JG),DIS1WG(JG),TPG1WG(JG),                   
     &              TDF1WG(JG),RMD1WG(JG)                               
      COMMON /KON2/ PRO2TG(JG),DIS2TG(JG),                              
     &              TDF2TG(JG),RMD2TG(JG),                              
     &              PRO2UG(JG),DIS2UG(JG),TPG2UG(JG),                   
     &              TDF2UG(JG),RMD2UG(JG),                              
     &              PRO2VG(JG),DIS2VG(JG),TPG2VG(JG),                   
     &              TDF2VG(JG),RMD2VG(JG),                              
     &              PRO2WG(JG),DIS2WG(JG),TPG2WG(JG),                   
     &              TDF2WG(JG),RMD2WG(JG)                               
C                                                                       
      COMMON /TSPE/ ATSTRMG(IG,JG,4),ATSPANG(KG,JG,4)                   
      COMMON /TCOR/ ATPC1TG(IG,JG,2),ATPC3TG(KG,JG,2)                   
C                                                                       
      COMMON /TSFVT/ TSKEWVTG(JG,2),TFLATVTG(JG,2)                      
C                                                                       
      COMMON /T1HOA/ AT1TRIG(JG,10),AT1QUADG(JG,19),AQAVT1G(JG,4)       
      COMMON /T2HOA/ AT2TRIG(JG,10),AT2QUADG(JG,19),AQAVT2G(JG,4)       
C                                                                       
      COMMON /NQAVT/ ANQAVTG(JG,4,2)                                    
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (TAGU,TA_U),(TAGV,TA_V),                              
     &            (TAGW,TA_W),(TAGP,TA_P)                               
      EQUIVALENCE (UGRMS,U_RMS),(VGRMS,V_RMS),                          
     &            (WGRMS,W_RMS),(PGRMS,P_RMS)                           
C                                                                       
      EQUIVALENCE (TAT1G,TAT1),(TRMS1G,TRMS1),                          
     &            (FLXUT1G,FLXUT1),(FLXVT1G,FLXVT1),(FLXWT1G,FLXWT1),   
     &            (ATHFV1G,ATHFV1),(ATOTAL1G,ATOTAL1)                   
      EQUIVALENCE (TAT2G,TAT2),(TRMS2G,TRMS2),                          
     &            (FLXUT2G,FLXUT2),(FLXVT2G,FLXVT2),(FLXWT2G,FLXWT2),   
     &            (ATHFV2G,ATHFV2),(ATOTAL2G,ATOTAL2)                   
C                                                                       
      EQUIVALENCE (PRO1TG,PRO1TV),(DIS1TG,DIS1TV),                      
     &            (TDF1TG,TDF1TV),(RMD1TG,RMD1TV)                       
      EQUIVALENCE (PRO2TG,PRO2TV),(DIS2TG,DIS2TV),                      
     &            (TDF2TG,TDF2TV),(RMD2TG,RMD2TV)                       
      EQUIVALENCE (PRO1UG,PRO1UT),(DIS1UG,DIS1UT),                      
     &            (TPG1UG,TPG1UT),(TDF1UG,TDF1UT),                      
     &            (RMD1UG,RMD1UT)                                       
      EQUIVALENCE (PRO2UG,PRO2UT),(DIS2UG,DIS2UT),                      
     &            (TPG2UG,TPG2UT),(TDF2UG,TDF2UT),                      
     &            (RMD2UG,RMD2UT)                                       
      EQUIVALENCE (PRO1VG,PRO1VT),(DIS1VG,DIS1VT),                      
     &            (TPG1VG,TPG1VT),(TDF1VG,TDF1VT),                      
     &            (RMD1VG,RMD1VT)                                       
      EQUIVALENCE (PRO2VG,PRO2VT),(DIS2VG,DIS2VT),                      
     &            (TPG2VG,TPG2VT),(TDF2VG,TDF2VT),                      
     &            (RMD2VG,RMD2VT)                                       
      EQUIVALENCE (PRO1WG,PRO1WT),(DIS1WG,DIS1WT),                      
     &            (TPG1WG,TPG1WT),(TDF1WG,TDF1WT),                      
     &            (RMD1WG,RMD1WT)                                       
      EQUIVALENCE (PRO2WG,PRO2WT),(DIS2WG,DIS2WT),                      
     &            (TPG2WG,TPG2WT),(TDF2WG,TDF2WT),                      
     &            (RMD2WG,RMD2WT)                                       
      EQUIVALENCE (ATSTRMG,ATSTRM),(ATSPANG,ATSPAN)                     
      EQUIVALENCE (ATPC1TG,ATPC1T),(ATPC3TG,ATPC3T)                     
C                                                                       
      EQUIVALENCE (TSKEWVTG,TSKEWVT),(TFLATVTG,TFLATVT)                 
C                                                                       
      EQUIVALENCE (AT1TRIG,AT1TRI),(AT1QUADG,AT1QUAD),                  
     &            (AQAVT1G,AQAVT1)                                      
      EQUIVALENCE (AT2TRIG,AT2TRI),(AT2QUADG,AT2QUAD),                  
     &            (AQAVT2G,AQAVT2)                                      
C                                                                       
      EQUIVALENCE (ANQAVTG,ANQAVT)                                      
C                                                                       
C=======================================================================
C----------------------------- TEMP.FIELD AVERAGE DATA STEP COUNTER     
      NSTCS=0                                                           
      STCSTM=0.0D0                                                      
C                                                                       
      DO 10 J=1,JG                                                      
       TA_U(J)=0.0D0                                                    
       TA_V(J)=0.0D0                                                    
       TA_W(J)=0.0D0                                                    
       TA_P(J)=0.0D0                                                    
       TAT1(J)=0.0D0                                                    
       TAT2(J)=0.0D0                                                    
C                                                                       
       U_RMS(J)=0.0D0                                                   
       V_RMS(J)=0.0D0                                                   
       W_RMS(J)=0.0D0                                                   
       P_RMS(J)=0.0D0                                                   
       TRMS1(J)=0.0D0                                                   
       TRMS2(J)=0.0D0                                                   
C                                                                       
       FLXUT1(J)=0.0D0                                                  
       FLXVT1(J)=0.0D0                                                  
       FLXWT1(J)=0.0D0                                                  
       FLXUT2(J)=0.0D0                                                  
       FLXVT2(J)=0.0D0                                                  
       FLXWT2(J)=0.0D0                                                  
C                                                                       
       ATHFV1(J)=0.0D0                                                  
       ATHFV2(J)=0.0D0                                                  
       ATOTAL1(J)=0.0D0                                                 
       ATOTAL2(J)=0.0D0                                                 
C                                                                       
       PRO1TV(J)=0.0D0                                                  
       DIS1TV(J)=0.0D0                                                  
       TDF1TV(J)=0.0D0                                                  
       RMD1TV(J)=0.0D0                                                  
       PRO2TV(J)=0.0D0                                                  
       DIS2TV(J)=0.0D0                                                  
       TDF2TV(J)=0.0D0                                                  
       RMD2TV(J)=0.0D0                                                  
C                                                                       
       PRO1UT(J)=0.0D0                                                  
       DIS1UT(J)=0.0D0                                                  
       TPG1UT(J)=0.0D0                                                  
       TDF1UT(J)=0.0D0                                                  
       RMD1UT(J)=0.0D0                                                  
       PRO2UT(J)=0.0D0                                                  
       DIS2UT(J)=0.0D0                                                  
       TPG2UT(J)=0.0D0                                                  
       TDF2UT(J)=0.0D0                                                  
       RMD2UT(J)=0.0D0                                                  
C                                                                       
       PRO1VT(J)=0.0D0                                                  
       DIS1VT(J)=0.0D0                                                  
       TPG1VT(J)=0.0D0                                                  
       TDF1VT(J)=0.0D0                                                  
       RMD1VT(J)=0.0D0                                                  
       PRO2VT(J)=0.0D0                                                  
       DIS2VT(J)=0.0D0                                                  
       TPG2VT(J)=0.0D0                                                  
       TDF2VT(J)=0.0D0                                                  
       RMD2VT(J)=0.0D0                                                  
C                                                                       
       PRO1WT(J)=0.0D0                                                  
       DIS1WT(J)=0.0D0                                                  
       TPG1WT(J)=0.0D0                                                  
       TDF1WT(J)=0.0D0                                                  
       RMD1WT(J)=0.0D0                                                  
       PRO2WT(J)=0.0D0                                                  
       DIS2WT(J)=0.0D0                                                  
       TPG2WT(J)=0.0D0                                                  
       TDF2WT(J)=0.0D0                                                  
       RMD2WT(J)=0.0D0                                                  
C                                                                       
       TSKEWVT(J,1)=0.0D0                                               
       TSKEWVT(J,2)=0.0D0                                               
       TFLATVT(J,1)=0.0D0                                               
       TFLATVT(J,2)=0.0D0                                               
C                                                                       
       AT1TRI(J,1)=0.0D0                                                
       AT1TRI(J,2)=0.0D0                                                
       AT1TRI(J,3)=0.0D0                                                
       AT1TRI(J,4)=0.0D0                                                
       AT1TRI(J,5)=0.0D0                                                
       AT1TRI(J,6)=0.0D0                                                
       AT1TRI(J,7)=0.0D0                                                
       AT1TRI(J,8)=0.0D0                                                
       AT1TRI(J,9)=0.0D0                                                
       AT1TRI(J,10)=0.0D0                                               
C                                                                       
       AT2TRI(J,1)=0.0D0                                                
       AT2TRI(J,2)=0.0D0                                                
       AT2TRI(J,3)=0.0D0                                                
       AT2TRI(J,4)=0.0D0                                                
       AT2TRI(J,5)=0.0D0                                                
       AT2TRI(J,6)=0.0D0                                                
       AT2TRI(J,7)=0.0D0                                                
       AT2TRI(J,8)=0.0D0                                                
       AT2TRI(J,9)=0.0D0                                                
       AT2TRI(J,10)=0.0D0                                               
C                                                                       
       AT1QUAD(J,1)=0.0D0                                               
       AT1QUAD(J,2)=0.0D0                                               
       AT1QUAD(J,3)=0.0D0                                               
       AT1QUAD(J,4)=0.0D0                                               
       AT1QUAD(J,5)=0.0D0                                               
       AT1QUAD(J,6)=0.0D0                                               
       AT1QUAD(J,7)=0.0D0                                               
       AT1QUAD(J,8)=0.0D0                                               
       AT1QUAD(J,9)=0.0D0                                               
       AT1QUAD(J,10)=0.0D0                                              
       AT1QUAD(J,12)=0.0D0                                              
       AT1QUAD(J,13)=0.0D0                                              
       AT1QUAD(J,14)=0.0D0                                              
       AT1QUAD(J,15)=0.0D0                                              
       AT1QUAD(J,16)=0.0D0                                              
       AT1QUAD(J,17)=0.0D0                                              
       AT1QUAD(J,18)=0.0D0                                              
       AT1QUAD(J,19)=0.0D0                                              
C                                                                       
       AT2QUAD(J,1)=0.0D0                                               
       AT2QUAD(J,2)=0.0D0                                               
       AT2QUAD(J,3)=0.0D0                                               
       AT2QUAD(J,4)=0.0D0                                               
       AT2QUAD(J,5)=0.0D0                                               
       AT2QUAD(J,6)=0.0D0                                               
       AT2QUAD(J,7)=0.0D0                                               
       AT2QUAD(J,8)=0.0D0                                               
       AT2QUAD(J,9)=0.0D0                                               
       AT2QUAD(J,10)=0.0D0                                              
       AT2QUAD(J,11)=0.0D0                                              
       AT2QUAD(J,12)=0.0D0                                              
       AT2QUAD(J,13)=0.0D0                                              
       AT2QUAD(J,14)=0.0D0                                              
       AT2QUAD(J,15)=0.0D0                                              
       AT2QUAD(J,16)=0.0D0                                              
       AT2QUAD(J,17)=0.0D0                                              
       AT2QUAD(J,18)=0.0D0                                              
       AT2QUAD(J,19)=0.0D0                                              
C                                                                       
       AQAVT1(J,1)=0.0D0                                                
       AQAVT1(J,2)=0.0D0                                                
       AQAVT1(J,3)=0.0D0                                                
       AQAVT1(J,4)=0.0D0                                                
C                                                                       
       AQAVT2(J,1)=0.0D0                                                
       AQAVT2(J,2)=0.0D0                                                
       AQAVT2(J,3)=0.0D0                                                
       AQAVT2(J,4)=0.0D0                                                
   10 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
      DO 16 J=1,JG                                                      
      DO 16 I=1,IG                                                      
       ATSTRM(I,J,1)=0.0D0                                              
       ATSTRM(I,J,2)=0.0D0                                              
       ATSTRM(I,J,3)=0.0D0                                              
       ATSTRM(I,J,4)=0.0D0                                              
       ATPC1T(I,J,1)=0.0D0                                              
       ATPC1T(I,J,2)=0.0D0                                              
   16 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
      DO 17 J=1,JG                                                      
      DO 17 K=1,KG                                                      
       ATSPAN(K,J,1)=0.0D0                                              
       ATSPAN(K,J,2)=0.0D0                                              
       ATSPAN(K,J,3)=0.0D0                                              
       ATSPAN(K,J,4)=0.0D0                                              
       ATPC3T(K,J,1)=0.0D0                                              
       ATPC3T(K,J,2)=0.0D0                                              
   17 CONTINUE                                                          
C                                                                       
C====================== QAVT-PDF ZERO STARTS                            
         NQACT=0                                                        
C                                                                       
      DO 50 J=1,JG                                                      
         ANQAVT(J,1,1)=0.0D0                                            
         ANQAVT(J,2,1)=0.0D0                                            
         ANQAVT(J,3,1)=0.0D0                                            
         ANQAVT(J,4,1)=0.0D0                                            
C                                                                       
         ANQAVT(J,1,2)=0.0D0                                            
         ANQAVT(J,2,2)=0.0D0                                            
         ANQAVT(J,3,2)=0.0D0                                            
         ANQAVT(J,4,2)=0.0D0                                            
   50 CONTINUE                                                          
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C     ENERGY SPECTRA (TEMPERATURE FIELD)                                
C     PROGRAMED BY H.ABE(2000.08.22)                                    
      SUBROUTINE TPOWSPE                                                
C     REVISED ON 2005.01.12 BY T.TSUKAHARA (ARRANGED FOR SX-7)          
C     REVISED ON 2001.03.05 BY H.ABE (JN=1)                             
C     REVISED ON 2001.01.08 BY H.ABE (JA TO JM)                         
C     REVISED ON 2000.10.22 BY H.ABE (ADD: VT)                          
C     2000.08.27 REVISED BY H.ABE (SPREAD REGION -> SPREAD DO)          
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
      COMMON /JAVE/ JA,JB,JC,JD,JE,JF,JH,JI,JJ,JK,JL                    
C                                                                       
C----LOCAL VARIABLES-------------------------------------------         
C                                                                       
      DIMENSION U(-4:IG+4,-2:JG+2,-4:KG+4,3)                            
      DIMENSION UT(-4:IG+4,-2:JG+2,-4:KG+4,3)                           
      DIMENSION T1(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION T2(-3:IG+3,-2:JG+2,-3:KG+3)                             
C                                                                       
      DIMENSION EA_V(-2:JG+2),EA_W(-2:JG+2),EA_P(-2:JG+2)               
      DIMENSION EAT1(-2:JG+2)                                           
      DIMENSION EAT2(-2:JG+2)                                           
C                                                                       
      DIMENSION TSTRM(IG,JG,4),TSPAN(KG,JG,4)                           
      DIMENSION ATSTRM(IG,JG,4),ATSPAN(KG,JG,4)                         
      DIMENSION CR1(LX,LZ),CI1(LX,LZ)                                   
     &         ,CR2(LX,LZ),CI2(LX,LZ)                                   
     &         ,CR3(LX,LZ),CI3(LX,LZ)                                   
      DIMENSION TRIGS(2*(IG+KG)),WK(2*LX*LZ),IFAX(40)                   
C                                                                       
C----GLOBAL VARIABLES------------------------------------------         
C                                                                       
      COMMON /VELO/ UG(-4:IG+4,-2:JG+2,-4:KG+4,3)                       
      COMMON /TEMP/ UTG(-4:IG+4,-2:JG+2,-4:KG+4,3)                      
      COMMON /TEM1/ T1G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /TEM2/ T2G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /EAVE/ EAGV(-2:JG+2),EAGW(-2:JG+2),EAGP(-2:JG+2)           
      COMMON /ETM1/ EAT1G(-2:JG+2)                                      
      COMMON /ETM2/ EAT2G(-2:JG+2)                                      
      COMMON /TSPE/ ATSTRMG(IG,JG,4),ATSPANG(KG,JG,4)                   
C                                                                       
C----COMBINATION------------------------------------------------        
C                                                                       
      EQUIVALENCE (UG,U),(UTG,UT)                                       
      EQUIVALENCE (EAGV,EA_V),                                          
     &            (EAGW,EA_W),(EAGP,EA_P)                               
      EQUIVALENCE (T1G,T1),(T2G,T2)                                     
      EQUIVALENCE (EAT1G,EAT1),(EAT2G,EAT2)                             
      EQUIVALENCE (ATSTRMG,ATSTRM),(ATSPANG,ATSPAN)                     
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
      PW=1.0/DBLE(IG*KG)                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
      DO 10 J=1,JG                                                      
      DO 10 I=1,IG                                                      
        TSTRM(I,J,1)=0.0D0                                              
        TSTRM(I,J,2)=0.0D0                                              
        TSTRM(I,J,3)=0.0D0                                              
        TSTRM(I,J,4)=0.0D0                                              
   10 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
      DO 11 J=1,JG                                                      
      DO 11 K=1,KG                                                      
        TSPAN(K,J,1)=0.0D0                                              
        TSPAN(K,J,2)=0.0D0                                              
        TSPAN(K,J,3)=0.0D0                                              
        TSPAN(K,J,4)=0.0D0                                              
   11 CONTINUE                                                          
C                                                                       
C-------------------------------------- U',V',W'                        
!$OMP PARALLEL DO PRIVATE(I,K)                                          
      DO 12 J=1,JG                                                      
      DO 12 K=1,KG                                                      
      DO 12 I=1,IG                                                      
        UT(I,J,K,1)=T1(I,J,K)-EAT1(J)                                   
        UT(I,J,K,2)=T2(I,J,K)-EAT2(J)                                   
        UT(I,J,K,3)=(U(I,J,K,2)-EA_V(J)                                 
     &              +U(I,J-1,K,2)-EA_V(J-1))*0.5D0                      
   12 CONTINUE                                                          
C                                                                       
C--- Y:JA                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 200 K=1,KG                                                   
        DO 200 I=1,IG                                                   
          CR1(I,K)=UT(I,JA,K,1)                                         
          CR2(I,K)=UT(I,JA,K,2)                                         
          CR3(I,K)=UT(I,JA,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  200   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2FB(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 201 I=1,IG                                                   
        DO 201 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JA,1)=TSTRM(I,JA,1)+TWA1                               
         TSTRM(I,JA,2)=TSTRM(I,JA,2)+TWA2                               
         TSTRM(I,JA,3)=TSTRM(I,JA,3)+TWA3                               
         TSTRM(I,JA,4)=TSTRM(I,JA,4)+TWA4                               
  201   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 202 K=1,KG                                                   
        DO 202 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JA,1)=TSPAN(K,JA,1)+TWA1                               
         TSPAN(K,JA,2)=TSPAN(K,JA,2)+TWA2                               
         TSPAN(K,JA,3)=TSPAN(K,JA,3)+TWA3                               
         TSPAN(K,JA,4)=TSPAN(K,JA,4)+TWA4                               
  202   CONTINUE                                                        
C                                                                       
C--- Y:JB                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 210 K=1,KG                                                   
        DO 210 I=1,IG                                                   
          CR1(I,K)=UT(I,JB,K,1)                                         
          CR2(I,K)=UT(I,JB,K,2)                                         
          CR3(I,K)=UT(I,JB,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  210   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 211 I=1,IG                                                   
        DO 211 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JB,1)=TSTRM(I,JB,1)+TWA1                               
         TSTRM(I,JB,2)=TSTRM(I,JB,2)+TWA2                               
         TSTRM(I,JB,3)=TSTRM(I,JB,3)+TWA3                               
         TSTRM(I,JB,4)=TSTRM(I,JB,4)+TWA4                               
  211   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 212 K=1,KG                                                   
        DO 212 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JB,1)=TSPAN(K,JB,1)+TWA1                               
         TSPAN(K,JB,2)=TSPAN(K,JB,2)+TWA2                               
         TSPAN(K,JB,3)=TSPAN(K,JB,3)+TWA3                               
         TSPAN(K,JB,4)=TSPAN(K,JB,4)+TWA4                               
  212   CONTINUE                                                        
C                                                                       
C--- Y:JC                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 220 K=1,KG                                                   
        DO 220 I=1,IG                                                   
          CR1(I,K)=UT(I,JC,K,1)                                         
          CR2(I,K)=UT(I,JC,K,2)                                         
          CR3(I,K)=UT(I,JC,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  220   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 221 I=1,IG                                                   
        DO 221 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JC,1)=TSTRM(I,JC,1)+TWA1                               
         TSTRM(I,JC,2)=TSTRM(I,JC,2)+TWA2                               
         TSTRM(I,JC,3)=TSTRM(I,JC,3)+TWA3                               
         TSTRM(I,JC,4)=TSTRM(I,JC,4)+TWA4                               
  221   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 222 K=1,KG                                                   
        DO 222 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JC,1)=TSPAN(K,JC,1)+TWA1                               
         TSPAN(K,JC,2)=TSPAN(K,JC,2)+TWA2                               
         TSPAN(K,JC,3)=TSPAN(K,JC,3)+TWA3                               
         TSPAN(K,JC,4)=TSPAN(K,JC,4)+TWA4                               
  222   CONTINUE                                                        
C                                                                       
C--- Y:JD                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 230 K=1,KG                                                   
        DO 230 I=1,IG                                                   
          CR1(I,K)=UT(I,JD,K,1)                                         
          CR2(I,K)=UT(I,JD,K,2)                                         
          CR3(I,K)=UT(I,JD,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  230   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 231 I=1,IG                                                   
        DO 231 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JD,1)=TSTRM(I,JD,1)+TWA1                               
         TSTRM(I,JD,2)=TSTRM(I,JD,2)+TWA2                               
         TSTRM(I,JD,3)=TSTRM(I,JD,3)+TWA3                               
         TSTRM(I,JD,4)=TSTRM(I,JD,4)+TWA4                               
  231   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 232 K=1,KG                                                   
        DO 232 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JD,1)=TSPAN(K,JD,1)+TWA1                               
         TSPAN(K,JD,2)=TSPAN(K,JD,2)+TWA2                               
         TSPAN(K,JD,3)=TSPAN(K,JD,3)+TWA3                               
         TSPAN(K,JD,4)=TSPAN(K,JD,4)+TWA4                               
  232   CONTINUE                                                        
C                                                                       
C--- Y:JE                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 240 K=1,KG                                                   
        DO 240 I=1,IG                                                   
          CR1(I,K)=UT(I,JE,K,1)                                         
          CR2(I,K)=UT(I,JE,K,2)                                         
          CR3(I,K)=UT(I,JE,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  240   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 241 I=1,IG                                                   
        DO 241 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JE,1)=TSTRM(I,JE,1)+TWA1                               
         TSTRM(I,JE,2)=TSTRM(I,JE,2)+TWA2                               
         TSTRM(I,JE,3)=TSTRM(I,JE,3)+TWA3                               
         TSTRM(I,JE,4)=TSTRM(I,JE,4)+TWA4                               
  241   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 242 K=1,KG                                                   
        DO 242 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JE,1)=TSPAN(K,JE,1)+TWA1                               
         TSPAN(K,JE,2)=TSPAN(K,JE,2)+TWA2                               
         TSPAN(K,JE,3)=TSPAN(K,JE,3)+TWA3                               
         TSPAN(K,JE,4)=TSPAN(K,JE,4)+TWA4                               
  242   CONTINUE                                                        
C                                                                       
C--- Y:JF                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 250 K=1,KG                                                   
        DO 250 I=1,IG                                                   
          CR1(I,K)=UT(I,JF,K,1)                                         
          CR2(I,K)=UT(I,JF,K,2)                                         
          CR3(I,K)=UT(I,JF,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  250   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 251 I=1,IG                                                   
        DO 251 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JF,1)=TSTRM(I,JF,1)+TWA1                               
         TSTRM(I,JF,2)=TSTRM(I,JF,2)+TWA2                               
         TSTRM(I,JF,3)=TSTRM(I,JF,3)+TWA3                               
         TSTRM(I,JF,4)=TSTRM(I,JF,4)+TWA4                               
  251   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 252 K=1,KG                                                   
        DO 252 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JF,1)=TSPAN(K,JF,1)+TWA1                               
         TSPAN(K,JF,2)=TSPAN(K,JF,2)+TWA2                               
         TSPAN(K,JF,3)=TSPAN(K,JF,3)+TWA3                               
         TSPAN(K,JF,4)=TSPAN(K,JF,4)+TWA4                               
  252   CONTINUE                                                        
C                                                                       
C--- Y:JH                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 260 K=1,KG                                                   
        DO 260 I=1,IG                                                   
          CR1(I,K)=UT(I,JH,K,1)                                         
          CR2(I,K)=UT(I,JH,K,2)                                         
          CR3(I,K)=UT(I,JH,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  260   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 261 I=1,IG                                                   
        DO 261 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JH,1)=TSTRM(I,JH,1)+TWA1                               
         TSTRM(I,JH,2)=TSTRM(I,JH,2)+TWA2                               
         TSTRM(I,JH,3)=TSTRM(I,JH,3)+TWA3                               
         TSTRM(I,JH,4)=TSTRM(I,JH,4)+TWA4                               
  261   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 262 K=1,KG                                                   
        DO 262 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JH,1)=TSPAN(K,JH,1)+TWA1                               
         TSPAN(K,JH,2)=TSPAN(K,JH,2)+TWA2                               
         TSPAN(K,JH,3)=TSPAN(K,JH,3)+TWA3                               
         TSPAN(K,JH,4)=TSPAN(K,JH,4)+TWA4                               
  262   CONTINUE                                                        
C                                                                       
C--- Y:JI                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 270 K=1,KG                                                   
        DO 270 I=1,IG                                                   
          CR1(I,K)=UT(I,JI,K,1)                                         
          CR2(I,K)=UT(I,JI,K,2)                                         
          CR3(I,K)=UT(I,JI,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  270   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 271 I=1,IG                                                   
        DO 271 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JI,1)=TSTRM(I,JI,1)+TWA1                               
         TSTRM(I,JI,2)=TSTRM(I,JI,2)+TWA2                               
         TSTRM(I,JI,3)=TSTRM(I,JI,3)+TWA3                               
         TSTRM(I,JI,4)=TSTRM(I,JI,4)+TWA4                               
  271   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 272 I=1,IG                                                   
        DO 272 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JI,1)=TSPAN(K,JI,1)+TWA1                               
         TSPAN(K,JI,2)=TSPAN(K,JI,2)+TWA2                               
         TSPAN(K,JI,3)=TSPAN(K,JI,3)+TWA3                               
         TSPAN(K,JI,4)=TSPAN(K,JI,4)+TWA4                               
  272   CONTINUE                                                        
C                                                                       
C--- Y:JJ                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 280 K=1,KG                                                   
        DO 280 I=1,IG                                                   
          CR1(I,K)=UT(I,JJ,K,1)                                         
          CR2(I,K)=UT(I,JJ,K,2)                                         
          CR3(I,K)=UT(I,JJ,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  280   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 281 I=1,IG                                                   
        DO 281 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JJ,1)=TSTRM(I,JJ,1)+TWA1                               
         TSTRM(I,JJ,2)=TSTRM(I,JJ,2)+TWA2                               
         TSTRM(I,JJ,3)=TSTRM(I,JJ,3)+TWA3                               
         TSTRM(I,JJ,4)=TSTRM(I,JJ,4)+TWA4                               
  281   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 282 K=1,KG                                                   
        DO 282 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JJ,1)=TSPAN(K,JJ,1)+TWA1                               
         TSPAN(K,JJ,2)=TSPAN(K,JJ,2)+TWA2                               
         TSPAN(K,JJ,3)=TSPAN(K,JJ,3)+TWA3                               
         TSPAN(K,JJ,4)=TSPAN(K,JJ,4)+TWA4                               
  282   CONTINUE                                                        
C                                                                       
C--- Y:JK                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 290 K=1,KG                                                   
        DO 290 I=1,IG                                                   
          CR1(I,K)=UT(I,JK,K,1)                                         
          CR2(I,K)=UT(I,JK,K,2)                                         
          CR3(I,K)=UT(I,JK,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  290   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 291 I=1,IG                                                   
        DO 291 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JK,1)=TSTRM(I,JK,1)+TWA1                               
         TSTRM(I,JK,2)=TSTRM(I,JK,2)+TWA2                               
         TSTRM(I,JK,3)=TSTRM(I,JK,3)+TWA3                               
         TSTRM(I,JK,4)=TSTRM(I,JK,4)+TWA4                               
  291   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 292 K=1,KG                                                   
        DO 292 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JK,1)=TSPAN(K,JK,1)+TWA1                               
         TSPAN(K,JK,2)=TSPAN(K,JK,2)+TWA2                               
         TSPAN(K,JK,3)=TSPAN(K,JK,3)+TWA3                               
         TSPAN(K,JK,4)=TSPAN(K,JK,4)+TWA4                               
  292   CONTINUE                                                        
C                                                                       
C--- Y:JL                                                               
C                                                                       
!$OMP PARALLEL DO PRIVATE(I)                                            
        DO 300 K=1,KG                                                   
        DO 300 I=1,IG                                                   
          CR1(I,K)=UT(I,JL,K,1)                                         
          CR2(I,K)=UT(I,JL,K,2)                                         
          CR3(I,K)=UT(I,JL,K,3)                                         
          CI1(I,K)=0.0D0                                                
          CI2(I,K)=0.0D0                                                
          CI3(I,K)=0.0D0                                                
  300   CONTINUE                                                        
C                                                                       
      ISW=1                                                             
C      CALL DFC2BF(IG,KG,CR1,CI1,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR2,CI2,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C      CALL DFC2BF(IG,KG,CR3,CI3,LX,LZ,ISW,IFAX,TRIGS,WK,IERR)           
      IF(IERR.NE.0) STOP                                                
C                                                                       
!$OMP PARALLEL DO PRIVATE(K,TWA1,TWA2,TWA3,TWA4)                        
        DO 301 I=1,IG                                                   
        DO 301 K=1,KG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSTRM(I,JL,1)=TSTRM(I,JL,1)+TWA1                               
         TSTRM(I,JL,2)=TSTRM(I,JL,2)+TWA2                               
         TSTRM(I,JL,3)=TSTRM(I,JL,3)+TWA3                               
         TSTRM(I,JL,4)=TSTRM(I,JL,4)+TWA4                               
  301   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(I,TWA1,TWA2,TWA3,TWA4)                        
        DO 302 K=1,KG                                                   
        DO 302 I=1,IG                                                   
         TWA1=(CR1(I,K)*PW)**2+(CI1(I,K)*PW)**2                         
         TWA2=(CR2(I,K)*PW)**2+(CI2(I,K)*PW)**2                         
         TWA3=CR1(I,K)*PW*CR3(I,K)*PW+CI1(I,K)*PW*CI3(I,K)*PW           
         TWA4=CR2(I,K)*PW*CR3(I,K)*PW+CI2(I,K)*PW*CI3(I,K)*PW           
C                                                                       
         TSPAN(K,JL,1)=TSPAN(K,JL,1)+TWA1                               
         TSPAN(K,JL,2)=TSPAN(K,JL,2)+TWA2                               
         TSPAN(K,JL,3)=TSPAN(K,JL,3)+TWA3                               
         TSPAN(K,JL,4)=TSPAN(K,JL,4)+TWA4                               
  302   CONTINUE                                                        
C                                                                       
C-------------------------------------- TIME AVE.                       
C====================================== STREAMWISE                      
C---- SPREAD REGION => SPREAD DO (2000.08.27, H.ABE)                    
        DO 60 I=1,IG                                                    
          ATSTRM(I,JA,1)=ATSTRM(I,JA,1)+TSTRM(I,JA,1)                   
          ATSTRM(I,JA,2)=ATSTRM(I,JA,2)+TSTRM(I,JA,2)                   
          ATSTRM(I,JA,3)=ATSTRM(I,JA,3)+TSTRM(I,JA,3)                   
          ATSTRM(I,JA,4)=ATSTRM(I,JA,4)+TSTRM(I,JA,4)                   
   60   CONTINUE                                                        
C                                                                       
        DO 61 I=1,IG                                                    
          ATSTRM(I,JB,1)=ATSTRM(I,JB,1)+TSTRM(I,JB,1)                   
          ATSTRM(I,JB,2)=ATSTRM(I,JB,2)+TSTRM(I,JB,2)                   
          ATSTRM(I,JB,3)=ATSTRM(I,JB,3)+TSTRM(I,JB,3)                   
          ATSTRM(I,JB,4)=ATSTRM(I,JB,4)+TSTRM(I,JB,4)                   
   61   CONTINUE                                                        
C                                                                       
        DO 62 I=1,IG                                                    
          ATSTRM(I,JC,1)=ATSTRM(I,JC,1)+TSTRM(I,JC,1)                   
          ATSTRM(I,JC,2)=ATSTRM(I,JC,2)+TSTRM(I,JC,2)                   
          ATSTRM(I,JC,3)=ATSTRM(I,JC,3)+TSTRM(I,JC,3)                   
          ATSTRM(I,JC,4)=ATSTRM(I,JC,4)+TSTRM(I,JC,4)                   
   62   CONTINUE                                                        
C                                                                       
        DO 63 I=1,IG                                                    
          ATSTRM(I,JD,1)=ATSTRM(I,JD,1)+TSTRM(I,JD,1)                   
          ATSTRM(I,JD,2)=ATSTRM(I,JD,2)+TSTRM(I,JD,2)                   
          ATSTRM(I,JD,3)=ATSTRM(I,JD,3)+TSTRM(I,JD,3)                   
          ATSTRM(I,JD,4)=ATSTRM(I,JD,4)+TSTRM(I,JD,4)                   
   63   CONTINUE                                                        
C                                                                       
        DO 64 I=1,IG                                                    
          ATSTRM(I,JE,1)=ATSTRM(I,JE,1)+TSTRM(I,JE,1)                   
          ATSTRM(I,JE,2)=ATSTRM(I,JE,2)+TSTRM(I,JE,2)                   
          ATSTRM(I,JE,3)=ATSTRM(I,JE,3)+TSTRM(I,JE,3)                   
          ATSTRM(I,JE,4)=ATSTRM(I,JE,4)+TSTRM(I,JE,4)                   
   64   CONTINUE                                                        
C                                                                       
        DO 65 I=1,IG                                                    
          ATSTRM(I,JF,1)=ATSTRM(I,JF,1)+TSTRM(I,JF,1)                   
          ATSTRM(I,JF,2)=ATSTRM(I,JF,2)+TSTRM(I,JF,2)                   
          ATSTRM(I,JF,3)=ATSTRM(I,JF,3)+TSTRM(I,JF,3)                   
          ATSTRM(I,JF,4)=ATSTRM(I,JF,4)+TSTRM(I,JF,4)                   
   65   CONTINUE                                                        
C                                                                       
        DO 66 I=1,IG                                                    
          ATSTRM(I,JH,1)=ATSTRM(I,JH,1)+TSTRM(I,JH,1)                   
          ATSTRM(I,JH,2)=ATSTRM(I,JH,2)+TSTRM(I,JH,2)                   
          ATSTRM(I,JH,3)=ATSTRM(I,JH,3)+TSTRM(I,JH,3)                   
          ATSTRM(I,JH,4)=ATSTRM(I,JH,4)+TSTRM(I,JH,4)                   
   66   CONTINUE                                                        
C                                                                       
        DO 67 I=1,IG                                                    
          ATSTRM(I,JI,1)=ATSTRM(I,JI,1)+TSTRM(I,JI,1)                   
          ATSTRM(I,JI,2)=ATSTRM(I,JI,2)+TSTRM(I,JI,2)                   
          ATSTRM(I,JI,3)=ATSTRM(I,JI,3)+TSTRM(I,JI,3)                   
          ATSTRM(I,JI,4)=ATSTRM(I,JI,4)+TSTRM(I,JI,4)                   
   67   CONTINUE                                                        
C                                                                       
        DO 68 I=1,IG                                                    
          ATSTRM(I,JJ,1)=ATSTRM(I,JJ,1)+TSTRM(I,JJ,1)                   
          ATSTRM(I,JJ,2)=ATSTRM(I,JJ,2)+TSTRM(I,JJ,2)                   
          ATSTRM(I,JJ,3)=ATSTRM(I,JJ,3)+TSTRM(I,JJ,3)                   
          ATSTRM(I,JJ,4)=ATSTRM(I,JJ,4)+TSTRM(I,JJ,4)                   
   68   CONTINUE                                                        
C                                                                       
        DO 69 I=1,IG                                                    
          ATSTRM(I,JK,1)=ATSTRM(I,JK,1)+TSTRM(I,JK,1)                   
          ATSTRM(I,JK,2)=ATSTRM(I,JK,2)+TSTRM(I,JK,2)                   
          ATSTRM(I,JK,3)=ATSTRM(I,JK,3)+TSTRM(I,JK,3)                   
          ATSTRM(I,JK,4)=ATSTRM(I,JK,4)+TSTRM(I,JK,4)                   
   69   CONTINUE                                                        
C                                                                       
        DO 70 I=1,IG                                                    
          ATSTRM(I,JL,1)=ATSTRM(I,JL,1)+TSTRM(I,JL,1)                   
          ATSTRM(I,JL,2)=ATSTRM(I,JL,2)+TSTRM(I,JL,2)                   
          ATSTRM(I,JL,3)=ATSTRM(I,JL,3)+TSTRM(I,JL,3)                   
          ATSTRM(I,JL,4)=ATSTRM(I,JL,4)+TSTRM(I,JL,4)                   
   70   CONTINUE                                                        
C                                                                       
C====================================== SPANWISE                        
C                                                                       
        DO 80 K=1,KG                                                    
          ATSPAN(K,JA,1)=ATSPAN(K,JA,1)+TSPAN(K,JA,1)                   
          ATSPAN(K,JA,2)=ATSPAN(K,JA,2)+TSPAN(K,JA,2)                   
          ATSPAN(K,JA,3)=ATSPAN(K,JA,3)+TSPAN(K,JA,3)                   
          ATSPAN(K,JA,4)=ATSPAN(K,JA,4)+TSPAN(K,JA,4)                   
   80   CONTINUE                                                        
C                                                                       
        DO 81 K=1,KG                                                    
          ATSPAN(K,JB,1)=ATSPAN(K,JB,1)+TSPAN(K,JB,1)                   
          ATSPAN(K,JB,2)=ATSPAN(K,JB,2)+TSPAN(K,JB,2)                   
          ATSPAN(K,JB,3)=ATSPAN(K,JB,3)+TSPAN(K,JB,3)                   
          ATSPAN(K,JB,4)=ATSPAN(K,JB,4)+TSPAN(K,JB,4)                   
   81   CONTINUE                                                        
C                                                                       
        DO 82 K=1,KG                                                    
          ATSPAN(K,JC,1)=ATSPAN(K,JC,1)+TSPAN(K,JC,1)                   
          ATSPAN(K,JC,2)=ATSPAN(K,JC,2)+TSPAN(K,JC,2)                   
          ATSPAN(K,JC,3)=ATSPAN(K,JC,3)+TSPAN(K,JC,3)                   
          ATSPAN(K,JC,4)=ATSPAN(K,JC,4)+TSPAN(K,JC,4)                   
   82   CONTINUE                                                        
C                                                                       
        DO 83 K=1,KG                                                    
          ATSPAN(K,JD,1)=ATSPAN(K,JD,1)+TSPAN(K,JD,1)                   
          ATSPAN(K,JD,2)=ATSPAN(K,JD,2)+TSPAN(K,JD,2)                   
          ATSPAN(K,JD,3)=ATSPAN(K,JD,3)+TSPAN(K,JD,3)                   
          ATSPAN(K,JD,4)=ATSPAN(K,JD,4)+TSPAN(K,JD,4)                   
   83   CONTINUE                                                        
C                                                                       
        DO 84 K=1,KG                                                    
          ATSPAN(K,JE,1)=ATSPAN(K,JE,1)+TSPAN(K,JE,1)                   
          ATSPAN(K,JE,2)=ATSPAN(K,JE,2)+TSPAN(K,JE,2)                   
          ATSPAN(K,JE,3)=ATSPAN(K,JE,3)+TSPAN(K,JE,3)                   
          ATSPAN(K,JE,4)=ATSPAN(K,JE,4)+TSPAN(K,JE,4)                   
   84   CONTINUE                                                        
C                                                                       
        DO 85 K=1,KG                                                    
          ATSPAN(K,JF,1)=ATSPAN(K,JF,1)+TSPAN(K,JF,1)                   
          ATSPAN(K,JF,2)=ATSPAN(K,JF,2)+TSPAN(K,JF,2)                   
          ATSPAN(K,JF,3)=ATSPAN(K,JF,3)+TSPAN(K,JF,3)                   
          ATSPAN(K,JF,4)=ATSPAN(K,JF,4)+TSPAN(K,JF,4)                   
   85   CONTINUE                                                        
C                                                                       
        DO 86 K=1,KG                                                    
          ATSPAN(K,JH,1)=ATSPAN(K,JH,1)+TSPAN(K,JH,1)                   
          ATSPAN(K,JH,2)=ATSPAN(K,JH,2)+TSPAN(K,JH,2)                   
          ATSPAN(K,JH,3)=ATSPAN(K,JH,3)+TSPAN(K,JH,3)                   
          ATSPAN(K,JH,4)=ATSPAN(K,JH,4)+TSPAN(K,JH,4)                   
   86   CONTINUE                                                        
C                                                                       
        DO 87 K=1,KG                                                    
          ATSPAN(K,JI,1)=ATSPAN(K,JI,1)+TSPAN(K,JI,1)                   
          ATSPAN(K,JI,2)=ATSPAN(K,JI,2)+TSPAN(K,JI,2)                   
          ATSPAN(K,JI,3)=ATSPAN(K,JI,3)+TSPAN(K,JI,3)                   
          ATSPAN(K,JI,4)=ATSPAN(K,JI,4)+TSPAN(K,JI,4)                   
   87   CONTINUE                                                        
C                                                                       
        DO 88 K=1,KG                                                    
          ATSPAN(K,JJ,1)=ATSPAN(K,JJ,1)+TSPAN(K,JJ,1)                   
          ATSPAN(K,JJ,2)=ATSPAN(K,JJ,2)+TSPAN(K,JJ,2)                   
          ATSPAN(K,JJ,3)=ATSPAN(K,JJ,3)+TSPAN(K,JJ,3)                   
          ATSPAN(K,JJ,4)=ATSPAN(K,JJ,4)+TSPAN(K,JJ,4)                   
   88   CONTINUE                                                        
C                                                                       
        DO 89 K=1,KG                                                    
          ATSPAN(K,JK,1)=ATSPAN(K,JK,1)+TSPAN(K,JK,1)                   
          ATSPAN(K,JK,2)=ATSPAN(K,JK,2)+TSPAN(K,JK,2)                   
          ATSPAN(K,JK,3)=ATSPAN(K,JK,3)+TSPAN(K,JK,3)                   
          ATSPAN(K,JK,4)=ATSPAN(K,JK,4)+TSPAN(K,JK,4)                   
   89   CONTINUE                                                        
C                                                                       
        DO 90 K=1,KG                                                    
          ATSPAN(K,JL,1)=ATSPAN(K,JL,1)+TSPAN(K,JL,1)                   
          ATSPAN(K,JL,2)=ATSPAN(K,JL,2)+TSPAN(K,JL,2)                   
          ATSPAN(K,JL,3)=ATSPAN(K,JL,3)+TSPAN(K,JL,3)                   
          ATSPAN(K,JL,4)=ATSPAN(K,JL,4)+TSPAN(K,JL,4)                   
   90   CONTINUE                                                        
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C     TWO-POINT CORRELATION (TEMPERATURE FIELD)                         
C     PROGRAMED BY H.ABE                                                
      SUBROUTINE TCORREL                                                
C     REVISED ON 2001.03.05 BY H.ABE (JN=1)                             
C     REVISED ON 2001.01.08 BY H.ABE (JA TO JM)                         
C     REVISED ON 2000.10.20 BY H.ABE (JI TO JQ)                         
C     2000.08.26 REVISED BY H.ABE (SPREAD REGION -> SPREAD DO)          
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
      COMMON /JAVE/ JA,JB,JC,JD,JE,JF,JH,JI,JJ,JK,JL                    
C                                                                       
C---  LOCAL VARIABLES  -------------------------------------------------
C                                                                       
      DIMENSION T1(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION T2(-3:IG+3,-2:JG+2,-3:KG+3)                             
C                                                                       
      DIMENSION EAT1(-2:JG+2)                                           
      DIMENSION EAT2(-2:JG+2)                                           
C                                                                       
      DIMENSION ATPC1T(IG,JG,2),ATPC3T(KG,JG,2)                         
C                                                                       
      DIMENSION RT1A1(IG,2),RT2A1(IG,2)                                 
     &         ,RT1B1(IG,2),RT2B1(IG,2)                                 
     &         ,RT1C1(IG,2),RT2C1(IG,2)                                 
     &         ,RT1D1(IG,2),RT2D1(IG,2)                                 
     &         ,RT1E1(IG,2),RT2E1(IG,2)                                 
     &         ,RT1F1(IG,2),RT2F1(IG,2)                                 
     &         ,RT1H1(IG,2),RT2H1(IG,2)                                 
     &         ,RT1I1(IG,2),RT2I1(IG,2)                                 
     &         ,RT1J1(IG,2),RT2J1(IG,2)                                 
     &         ,RT1K1(IG,2),RT2K1(IG,2)                                 
     &         ,RT1L1(IG,2),RT2L1(IG,2)                                 
     &         ,RT1A3(KG,2),RT2A3(KG,2)                                 
     &         ,RT1B3(KG,2),RT2B3(KG,2)                                 
     &         ,RT1C3(KG,2),RT2C3(KG,2)                                 
     &         ,RT1D3(KG,2),RT2D3(KG,2)                                 
     &         ,RT1E3(KG,2),RT2E3(KG,2)                                 
     &         ,RT1F3(KG,2),RT2F3(KG,2)                                 
     &         ,RT1H3(KG,2),RT2H3(KG,2)                                 
     &         ,RT1I3(KG,2),RT2I3(KG,2)                                 
     &         ,RT1J3(KG,2),RT2J3(KG,2)                                 
     &         ,RT1K3(KG,2),RT2K3(KG,2)                                 
     &         ,RT1L3(KG,2),RT2L3(KG,2)                                 
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /TEM1/ T1G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /TEM2/ T2G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /ETM1/ EAT1G(-2:JG+2)                                      
      COMMON /ETM2/ EAT2G(-2:JG+2)                                      
      COMMON /TCOR/ ATPC1TG(IG,JG,2),ATPC3TG(KG,JG,2)                   
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (T1G,T1),(T2G,T2)                                     
      EQUIVALENCE (EAT1G,EAT1),(EAT2G,EAT2)                             
      EQUIVALENCE (ATPC1TG,ATPC1T),(ATPC3TG,ATPC3T)                     
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
C----------------------------------- STREAMWISE                         
C                                                                       
        DO 10 I=1,IG                                                    
         RT1A1(I,1)=0.0D0                                               
         RT1A1(I,2)=0.0D0                                               
         RT2A1(I,1)=0.0D0                                               
         RT2A1(I,2)=0.0D0                                               
   10   CONTINUE                                                        
C                                                                       
        DO 11 I=1,IG                                                    
         RT1B1(I,1)=0.0D0                                               
         RT1B1(I,2)=0.0D0                                               
         RT2B1(I,1)=0.0D0                                               
         RT2B1(I,2)=0.0D0                                               
   11   CONTINUE                                                        
C                                                                       
        DO 12 I=1,IG                                                    
         RT1C1(I,1)=0.0D0                                               
         RT1C1(I,2)=0.0D0                                               
         RT2C1(I,1)=0.0D0                                               
         RT2C1(I,2)=0.0D0                                               
   12   CONTINUE                                                        
C                                                                       
        DO 13 I=1,IG                                                    
         RT1D1(I,1)=0.0D0                                               
         RT1D1(I,2)=0.0D0                                               
         RT2D1(I,1)=0.0D0                                               
         RT2D1(I,2)=0.0D0                                               
   13   CONTINUE                                                        
C                                                                       
        DO 14 I=1,IG                                                    
         RT1E1(I,1)=0.0D0                                               
         RT1E1(I,2)=0.0D0                                               
         RT2E1(I,1)=0.0D0                                               
         RT2E1(I,2)=0.0D0                                               
   14   CONTINUE                                                        
C                                                                       
        DO 15 I=1,IG                                                    
         RT1F1(I,1)=0.0D0                                               
         RT1F1(I,2)=0.0D0                                               
         RT2F1(I,1)=0.0D0                                               
         RT2F1(I,2)=0.0D0                                               
   15   CONTINUE                                                        
C                                                                       
        DO 16 I=1,IG                                                    
         RT1H1(I,1)=0.0D0                                               
         RT1H1(I,2)=0.0D0                                               
         RT2H1(I,1)=0.0D0                                               
         RT2H1(I,2)=0.0D0                                               
   16   CONTINUE                                                        
C                                                                       
        DO 17 I=1,IG                                                    
         RT1I1(I,1)=0.0D0                                               
         RT1I1(I,2)=0.0D0                                               
         RT2I1(I,1)=0.0D0                                               
         RT2I1(I,2)=0.0D0                                               
   17   CONTINUE                                                        
C                                                                       
        DO 18 I=1,IG                                                    
         RT1J1(I,1)=0.0D0                                               
         RT1J1(I,2)=0.0D0                                               
         RT2J1(I,1)=0.0D0                                               
         RT2J1(I,2)=0.0D0                                               
   18   CONTINUE                                                        
C                                                                       
        DO 19 I=1,IG                                                    
         RT1K1(I,1)=0.0D0                                               
         RT1K1(I,2)=0.0D0                                               
         RT2K1(I,1)=0.0D0                                               
         RT2K1(I,2)=0.0D0                                               
   19   CONTINUE                                                        
C                                                                       
        DO 20 I=1,IG                                                    
         RT1L1(I,1)=0.0D0                                               
         RT1L1(I,2)=0.0D0                                               
         RT2L1(I,1)=0.0D0                                               
         RT2L1(I,2)=0.0D0                                               
   20   CONTINUE                                                        
C                                                                       
C====== SPANWISE                                                        
C                                                                       
C                                                                       
        DO 30 K=1,KG                                                    
         RT1A3(K,1)=0.0D0                                               
         RT1A3(K,2)=0.0D0                                               
         RT2A3(K,1)=0.0D0                                               
         RT2A3(K,2)=0.0D0                                               
   30   CONTINUE                                                        
C                                                                       
        DO 31 K=1,KG                                                    
         RT1B3(K,1)=0.0D0                                               
         RT1B3(K,2)=0.0D0                                               
         RT2B3(K,1)=0.0D0                                               
         RT2B3(K,2)=0.0D0                                               
   31   CONTINUE                                                        
C                                                                       
        DO 32 K=1,KG                                                    
         RT1C3(K,1)=0.0D0                                               
         RT1C3(K,2)=0.0D0                                               
         RT2C3(K,1)=0.0D0                                               
         RT2C3(K,2)=0.0D0                                               
   32   CONTINUE                                                        
C                                                                       
        DO 33 K=1,KG                                                    
         RT1D3(K,1)=0.0D0                                               
         RT1D3(K,2)=0.0D0                                               
         RT2D3(K,1)=0.0D0                                               
         RT2D3(K,2)=0.0D0                                               
   33   CONTINUE                                                        
C                                                                       
        DO 34 K=1,KG                                                    
         RT1E3(K,1)=0.0D0                                               
         RT1E3(K,2)=0.0D0                                               
         RT2E3(K,1)=0.0D0                                               
         RT2E3(K,2)=0.0D0                                               
   34   CONTINUE                                                        
C                                                                       
        DO 35 K=1,KG                                                    
         RT1F3(K,1)=0.0D0                                               
         RT1F3(K,2)=0.0D0                                               
         RT2F3(K,1)=0.0D0                                               
         RT2F3(K,2)=0.0D0                                               
   35   CONTINUE                                                        
C                                                                       
        DO 36 K=1,KG                                                    
         RT1H3(K,1)=0.0D0                                               
         RT1H3(K,2)=0.0D0                                               
         RT2H3(K,1)=0.0D0                                               
         RT2H3(K,2)=0.0D0                                               
   36   CONTINUE                                                        
C                                                                       
        DO 37 K=1,KG                                                    
         RT1I3(K,1)=0.0D0                                               
         RT1I3(K,2)=0.0D0                                               
         RT2I3(K,1)=0.0D0                                               
         RT2I3(K,2)=0.0D0                                               
   37   CONTINUE                                                        
C                                                                       
        DO 38 K=1,KG                                                    
         RT1J3(K,1)=0.0D0                                               
         RT1J3(K,2)=0.0D0                                               
         RT2J3(K,1)=0.0D0                                               
         RT2J3(K,2)=0.0D0                                               
   38   CONTINUE                                                        
C                                                                       
        DO 39 K=1,KG                                                    
         RT1K3(K,1)=0.0D0                                               
         RT1K3(K,2)=0.0D0                                               
         RT2K3(K,1)=0.0D0                                               
         RT2K3(K,2)=0.0D0                                               
   39   CONTINUE                                                        
C                                                                       
        DO 40 K=1,KG                                                    
         RT1L3(K,1)=0.0D0                                               
         RT1L3(K,2)=0.0D0                                               
         RT2L3(K,1)=0.0D0                                               
         RT2L3(K,2)=0.0D0                                               
   40   CONTINUE                                                        
C                                                                       
C====== STREAMWISE                                                      
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 50 I=1,IG                                                    
        DO 50 K=1,KG                                                    
         RT1A1(I,1)=RT1A1(I,1)                                          
     &              +(T1(1,JA,K)-EAT1(JA))*(T1(I,JA,K)-EAT1(JA))        
         RT1A1(I,2)=RT1A1(I,2)+(T1(1,JA,K)-EAT1(JA))**2                 
         RT2A1(I,1)=RT2A1(I,1)                                          
     &              +(T2(1,JA,K)-EAT2(JA))*(T2(I,JA,K)-EAT2(JA))        
         RT2A1(I,2)=RT2A1(I,2)+(T2(1,JA,K)-EAT2(JA))**2                 
   50   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 51 I=1,IG                                                    
        DO 51 K=1,KG                                                    
         RT1B1(I,1)=RT1B1(I,1)                                          
     &              +(T1(1,JB,K)-EAT1(JB))*(T1(I,JB,K)-EAT1(JB))        
         RT1B1(I,2)=RT1B1(I,2)+(T1(1,JB,K)-EAT1(JB))**2                 
         RT2B1(I,1)=RT2B1(I,1)                                          
     &            +(T2(1,JB,K)-EAT2(JB))*(T2(I,JB,K)-EAT2(JB))          
         RT2B1(I,2)=RT2B1(I,2)+(T2(1,JB,K)-EAT2(JB))**2                 
   51   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 52 I=1,IG                                                    
        DO 52 K=1,KG                                                    
         RT1C1(I,1)=RT1C1(I,1)                                          
     &              +(T1(1,JC,K)-EAT1(JC))*(T1(I,JC,K)-EAT1(JC))        
         RT1C1(I,2)=RT1C1(I,2)+(T1(1,JC,K)-EAT1(JC))**2                 
         RT2C1(I,1)=RT2C1(I,1)                                          
     &              +(T2(1,JC,K)-EAT2(JC))*(T2(I,JC,K)-EAT2(JC))        
         RT2C1(I,2)=RT2C1(I,2)+(T2(1,JC,K)-EAT2(JC))**2                 
   52   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 53 I=1,IG                                                    
        DO 53 K=1,KG                                                    
         RT1D1(I,1)=RT1D1(I,1)                                          
     &              +(T1(1,JD,K)-EAT1(JD))*(T1(I,JD,K)-EAT1(JD))        
         RT1D1(I,2)=RT1D1(I,2)+(T1(1,JD,K)-EAT1(JD))**2                 
         RT2D1(I,1)=RT2D1(I,1)                                          
     &              +(T2(1,JD,K)-EAT2(JD))*(T2(I,JD,K)-EAT2(JD))        
         RT2D1(I,2)=RT2D1(I,2)+(T2(1,JD,K)-EAT2(JD))**2                 
   53   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 54 I=1,IG                                                    
        DO 54 K=1,KG                                                    
         RT1E1(I,1)=RT1E1(I,1)                                          
     &              +(T1(1,JE,K)-EAT1(JE))*(T1(I,JE,K)-EAT1(JE))        
         RT1E1(I,2)=RT1E1(I,2)+(T1(1,JE,K)-EAT1(JE))**2                 
         RT2E1(I,1)=RT2E1(I,1)                                          
     &              +(T2(1,JE,K)-EAT2(JE))*(T2(I,JE,K)-EAT2(JE))        
         RT2E1(I,2)=RT2E1(I,2)+(T2(1,JE,K)-EAT2(JE))**2                 
   54   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 55 I=1,IG                                                    
        DO 55 K=1,KG                                                    
         RT1F1(I,1)=RT1F1(I,1)                                          
     &              +(T1(1,JF,K)-EAT1(JF))*(T1(I,JF,K)-EAT1(JF))        
         RT1F1(I,2)=RT1F1(I,2)+(T1(1,JF,K)-EAT1(JF))**2                 
         RT2F1(I,1)=RT2F1(I,1)                                          
     &              +(T2(1,JF,K)-EAT2(JF))*(T2(I,JF,K)-EAT2(JF))        
         RT2F1(I,2)=RT2F1(I,2)+(T2(1,JF,K)-EAT2(JF))**2                 
   55   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 56 I=1,IG                                                    
        DO 56 K=1,KG                                                    
         RT1H1(I,1)=RT1H1(I,1)                                          
     &              +(T1(1,JH,K)-EAT1(JH))*(T1(I,JH,K)-EAT1(JH))        
         RT1H1(I,2)=RT1H1(I,2)+(T1(1,JH,K)-EAT1(JH))**2                 
         RT2H1(I,1)=RT2H1(I,1)                                          
     &              +(T2(1,JH,K)-EAT2(JH))*(T2(I,JH,K)-EAT2(JH))        
         RT2H1(I,2)=RT2H1(I,2)+(T2(1,JH,K)-EAT2(JH))**2                 
   56   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 57 I=1,IG                                                    
        DO 57 K=1,KG                                                    
         RT1I1(I,1)=RT1I1(I,1)                                          
     &              +(T1(1,JI,K)-EAT1(JI))*(T1(I,JI,K)-EAT1(JI))        
         RT1I1(I,2)=RT1I1(I,2)+(T1(1,JI,K)-EAT1(JI))**2                 
         RT2I1(I,1)=RT2I1(I,1)                                          
     &              +(T2(1,JI,K)-EAT2(JI))*(T2(I,JI,K)-EAT2(JI))        
         RT2I1(I,2)=RT2I1(I,2)+(T2(1,JI,K)-EAT2(JI))**2                 
   57   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 58 I=1,IG                                                    
        DO 58 K=1,KG                                                    
         RT1J1(I,1)=RT1J1(I,1)                                          
     &              +(T1(1,JJ,K)-EAT1(JJ))*(T1(I,JJ,K)-EAT1(JJ))        
         RT1J1(I,2)=RT1J1(I,2)+(T1(1,JJ,K)-EAT1(JJ))**2                 
         RT2J1(I,1)=RT2J1(I,1)                                          
     &              +(T2(1,JJ,K)-EAT2(JJ))*(T2(I,JJ,K)-EAT2(JJ))        
         RT2J1(I,2)=RT2J1(I,2)+(T2(1,JJ,K)-EAT2(JJ))**2                 
   58   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 59 I=1,IG                                                    
        DO 59 K=1,KG                                                    
         RT1K1(I,1)=RT1K1(I,1)                                          
     &              +(T1(1,JK,K)-EAT1(JK))*(T1(I,JK,K)-EAT1(JK))        
         RT1K1(I,2)=RT1K1(I,2)+(T1(1,JK,K)-EAT1(JK))**2                 
         RT2K1(I,1)=RT2K1(I,1)                                          
     &              +(T2(1,JK,K)-EAT2(JK))*(T2(I,JK,K)-EAT2(JK))        
         RT2K1(I,2)=RT2K1(I,2)+(T2(1,JK,K)-EAT2(JK))**2                 
   59   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 60 I=1,IG                                                    
        DO 60 K=1,KG                                                    
         RT1L1(I,1)=RT1L1(I,1)                                          
     &              +(T1(1,JL,K)-EAT1(JL))*(T1(I,JL,K)-EAT1(JL))        
         RT1L1(I,2)=RT1L1(I,2)+(T1(1,JL,K)-EAT1(JL))**2                 
         RT2L1(I,1)=RT2L1(I,1)                                          
     &              +(T2(1,JL,K)-EAT2(JL))*(T2(I,JL,K)-EAT2(JL))        
         RT2L1(I,2)=RT2L1(I,2)+(T2(1,JL,K)-EAT2(JL))**2                 
   60   CONTINUE                                                        
C                                                                       
C-------------------------------------- TIME AVE.                       
C                                                                       
        DO 70 I=1,IG                                                    
         ATPC1T(I,JA,1)=ATPC1T(I,JA,1)+RT1A1(I,1)/RT1A1(I,2)            
         ATPC1T(I,JA,2)=ATPC1T(I,JA,2)+RT2A1(I,1)/RT2A1(I,2)            
   70   CONTINUE                                                        
C                                                                       
        DO 71 I=1,IG                                                    
         ATPC1T(I,JB,1)=ATPC1T(I,JB,1)+RT1B1(I,1)/RT1B1(I,2)            
         ATPC1T(I,JB,2)=ATPC1T(I,JB,2)+RT2B1(I,1)/RT2B1(I,2)            
   71   CONTINUE                                                        
C                                                                       
        DO 72 I=1,IG                                                    
         ATPC1T(I,JC,1)=ATPC1T(I,JC,1)+RT1C1(I,1)/RT1C1(I,2)            
         ATPC1T(I,JC,2)=ATPC1T(I,JC,2)+RT2C1(I,1)/RT2C1(I,2)            
   72   CONTINUE                                                        
C                                                                       
        DO 73 I=1,IG                                                    
         ATPC1T(I,JD,1)=ATPC1T(I,JD,1)+RT1D1(I,1)/RT1D1(I,2)            
         ATPC1T(I,JD,2)=ATPC1T(I,JD,2)+RT2D1(I,1)/RT2D1(I,2)            
   73   CONTINUE                                                        
C                                                                       
        DO 74 I=1,IG                                                    
         ATPC1T(I,JE,1)=ATPC1T(I,JE,1)+RT1E1(I,1)/RT1E1(I,2)            
         ATPC1T(I,JE,2)=ATPC1T(I,JE,2)+RT2E1(I,1)/RT2E1(I,2)            
   74   CONTINUE                                                        
C                                                                       
        DO 75 I=1,IG                                                    
         ATPC1T(I,JF,1)=ATPC1T(I,JF,1)+RT1F1(I,1)/RT1F1(I,2)            
         ATPC1T(I,JF,2)=ATPC1T(I,JF,2)+RT2F1(I,1)/RT2F1(I,2)            
   75   CONTINUE                                                        
C                                                                       
        DO 76 I=1,IG                                                    
         ATPC1T(I,JH,1)=ATPC1T(I,JH,1)+RT1H1(I,1)/RT1H1(I,2)            
         ATPC1T(I,JH,2)=ATPC1T(I,JH,2)+RT2H1(I,1)/RT2H1(I,2)            
   76   CONTINUE                                                        
C                                                                       
        DO 77 I=1,IG                                                    
         ATPC1T(I,JI,1)=ATPC1T(I,JI,1)+RT1I1(I,1)/RT1I1(I,2)            
         ATPC1T(I,JI,2)=ATPC1T(I,JI,2)+RT2I1(I,1)/RT2I1(I,2)            
   77   CONTINUE                                                        
C                                                                       
        DO 78 I=1,IG                                                    
         ATPC1T(I,JJ,1)=ATPC1T(I,JJ,1)+RT1J1(I,1)/RT1J1(I,2)            
         ATPC1T(I,JJ,2)=ATPC1T(I,JJ,2)+RT2J1(I,1)/RT2J1(I,2)            
   78   CONTINUE                                                        
C                                                                       
        DO 79 I=1,IG                                                    
         ATPC1T(I,JK,1)=ATPC1T(I,JK,1)+RT1K1(I,1)/RT1K1(I,2)            
         ATPC1T(I,JK,2)=ATPC1T(I,JK,2)+RT2K1(I,1)/RT2K1(I,2)            
   79   CONTINUE                                                        
C                                                                       
        DO 80 I=1,IG                                                    
         ATPC1T(I,JL,1)=ATPC1T(I,JL,1)+RT1L1(I,1)/RT1L1(I,2)            
         ATPC1T(I,JL,2)=ATPC1T(I,JL,2)+RT2L1(I,1)/RT2L1(I,2)            
   80   CONTINUE                                                        
C                                                                       
C===== SPANWISE                                                         
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 90 I=1,IG                                                    
        DO 90 K=1,KG                                                    
         RT1A3(K,1)=RT1A3(K,1)                                          
     &              +(T1(I,JA,1)-EAT1(JA))*(T1(I,JA,K)-EAT1(JA))        
         RT1A3(K,2)=RT1A3(K,2)+(T1(I,JA,1)-EAT1(JA))**2                 
         RT2A3(K,1)=RT2A3(K,1)                                          
     &              +(T2(I,JA,1)-EAT2(JA))*(T2(I,JA,K)-EAT2(JA))        
         RT2A3(K,2)=RT2A3(K,2)+(T2(I,JA,1)-EAT2(JA))**2                 
   90   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 91 I=1,IG                                                    
        DO 91 K=1,KG                                                    
         RT1B3(K,1)=RT1B3(K,1)                                          
     &              +(T1(I,JB,1)-EAT1(JB))*(T1(I,JB,K)-EAT1(JB))        
         RT1B3(K,2)=RT1B3(K,2)+(T1(I,JB,1)-EAT1(JB))**2                 
         RT2B3(K,1)=RT2B3(K,1)                                          
     &              +(T2(I,JB,1)-EAT2(JB))*(T2(I,JB,K)-EAT2(JB))        
         RT2B3(K,2)=RT2B3(K,2)+(T2(I,JB,1)-EAT2(JB))**2                 
   91   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 92 I=1,IG                                                    
        DO 92 K=1,KG                                                    
         RT1C3(K,1)=RT1C3(K,1)                                          
     &              +(T1(I,JC,1)-EAT1(JC))*(T1(I,JC,K)-EAT1(JC))        
         RT1C3(K,2)=RT1C3(K,2)+(T1(I,JC,1)-EAT1(JC))**2                 
         RT2C3(K,1)=RT2C3(K,1)                                          
     &              +(T2(I,JC,1)-EAT2(JC))*(T2(I,JC,K)-EAT2(JC))        
         RT2C3(K,2)=RT2C3(K,2)+(T2(I,JC,1)-EAT2(JC))**2                 
   92   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 93 I=1,IG                                                    
        DO 93 K=1,KG                                                    
         RT1D3(K,1)=RT1D3(K,1)                                          
     &              +(T1(I,JD,1)-EAT1(JD))*(T1(I,JD,K)-EAT1(JD))        
         RT1D3(K,2)=RT1D3(K,2)+(T1(I,JD,1)-EAT1(JD))**2                 
         RT2D3(K,1)=RT2D3(K,1)                                          
     &              +(T2(I,JD,1)-EAT2(JD))*(T2(I,JD,K)-EAT2(JD))        
         RT2D3(K,2)=RT2D3(K,2)+(T2(I,JD,1)-EAT2(JD))**2                 
   93   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 94 I=1,IG                                                    
        DO 94 K=1,KG                                                    
         RT1E3(K,1)=RT1E3(K,1)                                          
     &              +(T1(I,JE,1)-EAT1(JE))*(T1(I,JE,K)-EAT1(JE))        
         RT1E3(K,2)=RT1E3(K,2)+(T1(I,JE,1)-EAT1(JE))**2                 
         RT2E3(K,1)=RT2E3(K,1)                                          
     &              +(T2(I,JE,1)-EAT2(JE))*(T2(I,JE,K)-EAT2(JE))        
         RT2E3(K,2)=RT2E3(K,2)+(T2(I,JE,1)-EAT2(JE))**2                 
   94 CONTINUE                                                          
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 95 I=1,IG                                                    
        DO 95 K=1,KG                                                    
         RT1F3(K,1)=RT1F3(K,1)                                          
     &              +(T1(I,JF,1)-EAT1(JF))*(T1(I,JF,K)-EAT1(JF))        
         RT1F3(K,2)=RT1F3(K,2)+(T1(I,JF,1)-EAT1(JF))**2                 
         RT2F3(K,1)=RT2F3(K,1)                                          
     &              +(T2(I,JF,1)-EAT2(JF))*(T2(I,JF,K)-EAT2(JF))        
         RT2F3(K,2)=RT2F3(K,2)+(T2(I,JF,1)-EAT2(JF))**2                 
   95   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 96 I=1,IG                                                    
        DO 96 K=1,KG                                                    
         RT1H3(K,1)=RT1H3(K,1)                                          
     &              +(T1(I,JH,1)-EAT1(JH))*(T1(I,JH,K)-EAT1(JH))        
         RT1H3(K,2)=RT1H3(K,2)+(T1(I,JH,1)-EAT1(JH))**2                 
         RT2H3(K,1)=RT2H3(K,1)                                          
     &              +(T2(I,JH,1)-EAT2(JH))*(T2(I,JH,K)-EAT2(JH))        
         RT2H3(K,2)=RT2H3(K,2)+(T2(I,JH,1)-EAT2(JH))**2                 
   96   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 97 I=1,IG                                                    
        DO 97 K=1,KG                                                    
         RT1I3(K,1)=RT1I3(K,1)                                          
     &              +(T1(I,JI,1)-EAT1(JI))*(T1(I,JI,K)-EAT1(JI))        
         RT1I3(K,2)=RT1I3(K,2)+(T1(I,JI,1)-EAT1(JI))**2                 
         RT2I3(K,1)=RT2I3(K,1)                                          
     &              +(T2(I,JI,1)-EAT2(JI))*(T2(I,JI,K)-EAT2(JI))        
         RT2I3(K,2)=RT2I3(K,2)+(T2(I,JI,1)-EAT2(JI))**2                 
   97   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 98 I=1,IG                                                    
        DO 98 K=1,KG                                                    
         RT1J3(K,1)=RT1J3(K,1)                                          
     &              +(T1(I,JJ,1)-EAT1(JJ))*(T1(I,JJ,K)-EAT1(JJ))        
         RT1J3(K,2)=RT1J3(K,2)+(T1(I,JJ,1)-EAT1(JJ))**2                 
         RT2J3(K,1)=RT2J3(K,1)                                          
     &              +(T2(I,JJ,1)-EAT2(JJ))*(T2(I,JJ,K)-EAT2(JJ))        
         RT2J3(K,2)=RT2J3(K,2)+(T2(I,JJ,1)-EAT2(JJ))**2                 
   98   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 99 I=1,IG                                                    
        DO 99 K=1,KG                                                    
         RT1K3(K,1)=RT1K3(K,1)                                          
     &              +(T1(I,JK,1)-EAT1(JK))*(T1(I,JK,K)-EAT1(JK))        
         RT1K3(K,2)=RT1K3(K,2)+(T1(I,JK,1)-EAT1(JK))**2                 
         RT2K3(K,1)=RT2K3(K,1)                                          
     &              +(T2(I,JK,1)-EAT2(JK))*(T2(I,JK,K)-EAT2(JK))        
         RT2K3(K,2)=RT2K3(K,2)+(T2(I,JK,1)-EAT2(JK))**2                 
   99   CONTINUE                                                        
C                                                                       
!$OMP PARALLEL DO PRIVATE(K)                                            
        DO 100 I=1,IG                                                   
        DO 100 K=1,KG                                                   
         RT1L3(K,1)=RT1L3(K,1)                                          
     &              +(T1(I,JL,1)-EAT1(JL))*(T1(I,JL,K)-EAT1(JL))        
         RT1L3(K,2)=RT1L3(K,2)+(T1(I,JL,1)-EAT1(JL))**2                 
         RT2L3(K,1)=RT2L3(K,1)                                          
     &              +(T2(I,JL,1)-EAT2(JL))*(T2(I,JL,K)-EAT2(JL))        
         RT2L3(K,2)=RT2L3(K,2)+(T2(I,JL,1)-EAT2(JL))**2                 
  100   CONTINUE                                                        
C                                                                       
C-------------------------------------- TIME AVE.                       
C                                                                       
        DO 110 K=1,KG                                                   
         ATPC3T(K,JA,1)=ATPC3T(K,JA,1)+RT1A3(K,1)/RT1A3(K,2)            
         ATPC3T(K,JA,2)=ATPC3T(K,JA,2)+RT2A3(K,1)/RT2A3(K,2)            
  110   CONTINUE                                                        
C                                                                       
        DO 111 K=1,KG                                                   
         ATPC3T(K,JB,1)=ATPC3T(K,JB,1)+RT1B3(K,1)/RT1B3(K,2)            
         ATPC3T(K,JB,2)=ATPC3T(K,JB,2)+RT2B3(K,1)/RT2B3(K,2)            
  111   CONTINUE                                                        
C                                                                       
        DO 112 K=1,KG                                                   
         ATPC3T(K,JC,1)=ATPC3T(K,JC,1)+RT1C3(K,1)/RT1C3(K,2)            
         ATPC3T(K,JC,2)=ATPC3T(K,JC,2)+RT2C3(K,1)/RT2C3(K,2)            
  112   CONTINUE                                                        
C                                                                       
        DO 113 K=1,KG                                                   
         ATPC3T(K,JD,1)=ATPC3T(K,JD,1)+RT1D3(K,1)/RT1D3(K,2)            
         ATPC3T(K,JD,2)=ATPC3T(K,JD,2)+RT2D3(K,1)/RT2D3(K,2)            
  113   CONTINUE                                                        
C                                                                       
        DO 114 K=1,KG                                                   
         ATPC3T(K,JE,1)=ATPC3T(K,JE,1)+RT1E3(K,1)/RT1E3(K,2)            
         ATPC3T(K,JE,2)=ATPC3T(K,JE,2)+RT2E3(K,1)/RT2E3(K,2)            
  114   CONTINUE                                                        
C                                                                       
        DO 115 K=1,KG                                                   
         ATPC3T(K,JF,1)=ATPC3T(K,JF,1)+RT1F3(K,1)/RT1F3(K,2)            
         ATPC3T(K,JF,2)=ATPC3T(K,JF,2)+RT2F3(K,1)/RT2F3(K,2)            
  115   CONTINUE                                                        
C                                                                       
        DO 116 K=1,KG                                                   
         ATPC3T(K,JH,1)=ATPC3T(K,JH,1)+RT1H3(K,1)/RT1H3(K,2)            
         ATPC3T(K,JH,2)=ATPC3T(K,JH,2)+RT2H3(K,1)/RT2H3(K,2)            
  116   CONTINUE                                                        
C                                                                       
        DO 117 K=1,KG                                                   
         ATPC3T(K,JI,1)=ATPC3T(K,JI,1)+RT1I3(K,1)/RT1I3(K,2)            
         ATPC3T(K,JI,2)=ATPC3T(K,JI,2)+RT2I3(K,1)/RT2I3(K,2)            
  117   CONTINUE                                                        
C                                                                       
        DO 118 K=1,KG                                                   
         ATPC3T(K,JJ,1)=ATPC3T(K,JJ,1)+RT1J3(K,1)/RT1J3(K,2)            
         ATPC3T(K,JJ,2)=ATPC3T(K,JJ,2)+RT2J3(K,1)/RT2J3(K,2)            
  118   CONTINUE                                                        
C                                                                       
        DO 119 K=1,KG                                                   
         ATPC3T(K,JK,1)=ATPC3T(K,JK,1)+RT1K3(K,1)/RT1K3(K,2)            
         ATPC3T(K,JK,2)=ATPC3T(K,JK,2)+RT2K3(K,1)/RT2K3(K,2)            
  119   CONTINUE                                                        
C                                                                       
        DO 120 K=1,KG                                                   
         ATPC3T(K,JL,1)=ATPC3T(K,JL,1)+RT1L3(K,1)/RT1L3(K,2)            
         ATPC3T(K,JL,2)=ATPC3T(K,JL,2)+RT2L3(K,1)/RT2L3(K,2)            
  120   CONTINUE                                                        
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE TSEEDIN                                                
C                                                                       
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
C                                                                       
      DIMENSION T1(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION T2(-3:IG+3,-2:JG+2,-3:KG+3)                             
      COMMON /TEM1/ T1G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /TEM2/ T2G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /SCNM/ NCALC                                               
      COMMON /SCTM/ CALTIM                                              
C                                                                       
      DIMENSION T1ASDIN(-3:IG/2,-2:JG+2,-3:KG+3)                        
      DIMENSION T1BSDIN( IG/2+3,-2:JG+2,-3:KG+3)                        
      DIMENSION T2ASDIN(-3:IG/2,-2:JG+2,-3:KG+3)                        
      DIMENSION T2BSDIN( IG/2+3,-2:JG+2,-3:KG+3)                        
      DIMENSION T1ASDING(-3:IG/2,-2:JG+2,-3:KG+3)                       
      DIMENSION T1BSDING( IG/2+3,-2:JG+2,-3:KG+3)                       
      DIMENSION T2ASDING(-3:IG/2,-2:JG+2,-3:KG+3)                       
      DIMENSION T2BSDING( IG/2+3,-2:JG+2,-3:KG+3)                       
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (T1G,T1),(T2G,T2)                                     
      EQUIVALENCE (T1ASDING,T1ASDIN),(T1BSDING,T1BSDIN),                
     &            (T2ASDING,T2ASDIN),(T2BSDING,T2BSDIN)                 
C                                                                       
C=======================================================================
C                                                                       
C      OPEN(32)                                                         
      READ(32) NCALC,CALTIM                                             
      READ(32) T1ASDING                                                 
      READ(33) T1BSDING                                                 
      READ(34) T2ASDING                                                 
      READ(35) T2BSDING                                                 
C      CLOSE(32)                                                        
C                                                                       
      DO 10 J= -2, JG+2                                                 
      DO 10 I= -3, IG/2                                                 
      DO 10 K= -3, KG+3                                                 
        T1(I,J,K)=T1ASDIN(I,J,K)                                        
        T2(I,J,K)=T2ASDIN(I,J,K)                                        
   10 CONTINUE                                                          
C                                                                       
      DO 11 J= -2, JG+2                                                 
      DO 11 I= IG/2+1, IG+3                                             
      DO 11 K= -3, KG+3                                                 
        T1(I,J,K)=T1BSDIN(I-IG/2,J,K)                                   
        T2(I,J,K)=T2BSDIN(I-IG/2,J,K)                                   
   11 CONTINUE                                                          
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE TSEEDOUT                                               
C                                                                       
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
C                                                                       
      DIMENSION T1(-3:IG+3,-2:JG+2,-3:KG+3)                             
      DIMENSION T2(-3:IG+3,-2:JG+2,-3:KG+3)                             
      COMMON /TEM1/ T1G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /TEM2/ T2G(-3:IG+3,-2:JG+2,-3:KG+3)                        
      COMMON /SCNM/ NCALC                                               
      COMMON /SCTM/ CALTIM                                              
C                                                                       
      DIMENSION T1ASDOUT(-3:IG/2,-2:JG+2,-3:KG+3)                       
      DIMENSION T1BSDOUT( IG/2+3,-2:JG+2,-3:KG+3)                       
      DIMENSION T2ASDOUT(-3:IG/2,-2:JG+2,-3:KG+3)                       
      DIMENSION T2BSDOUT( IG/2+3,-2:JG+2,-3:KG+3)                       
      DIMENSION T1ASDOUTG(-3:IG/2,-2:JG+2,-3:KG+3)                      
      DIMENSION T1BSDOUTG( IG/2+3,-2:JG+2,-3:KG+3)                      
      DIMENSION T2ASDOUTG(-3:IG/2,-2:JG+2,-3:KG+3)                      
      DIMENSION T2BSDOUTG( IG/2+3,-2:JG+2,-3:KG+3)                      
C                                                                       
C---  COMBINATION  -----------------------------------------------------
C                                                                       
      EQUIVALENCE (T1G,T1),(T2G,T2)                                     
      EQUIVALENCE (T1ASDOUTG,T1ASDOUT),(T1BSDOUTG,T1BSDOUT),            
     &            (T2ASDOUTG,T2ASDOUT),(T2BSDOUTG,T2BSDOUT)             
C                                                                       
C=======================================================================
C                                                                       
      DO 10 J= -2, JG+2                                                 
      DO 10 I= -3, IG/2                                                 
      DO 10 K= -3, KG+3                                                 
        T1ASDOUT(I,J,K)=T1(I,J,K)                                       
        T2ASDOUT(I,J,K)=T2(I,J,K)                                       
   10 CONTINUE                                                          
C                                                                       
      DO 11 J= -2, JG+2                                                 
      DO 11 I= IG/2+1, IG+3                                             
      DO 11 K= -3, KG+3                                                 
        T1BSDOUT(I-IG/2,J,K)=T1(I,J,K)                                  
        T2BSDOUT(I-IG/2,J,K)=T2(I,J,K)                                  
   11 CONTINUE                                                          
C                                                                       
C------------------------------- DATAOUT                                
C      OPEN(36)                                                         
      WRITE(36) NCALC,CALTIM                                            
      WRITE(36) T1ASDOUTG                                               
      WRITE(37) T1BSDOUTG                                               
      WRITE(38) T2ASDOUTG                                               
      WRITE(39) T2BSDOUTG                                               
C      CLOSE(36)                                                        
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE TAVEIN                                                 
C                                                                       
C     REVISED ON 2001.03.04  BY H.ABE (QA-UV)                           
C     REVISED ON 2000.10.17  BY H.ABE (QUADRUPLE CORR.)                 
C     REVISED ON 2000.10.17  BY H.ABE (QUADRANT ANALYSIS: VT)           
C     REVISED BY H.ABE (2000.09.30) ADD: TSKEWVT & TFLATVT              
C     REVISED BY H.ABE (2000.09.30) ADD: 3-POINT CORR. (TTT,UTT,ETC)    
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
C                                                                       
C---  LOCAL  VARIABLES  ------------------------------------------------
C                                                                       
      COMMON /SNUM/ NSTCS                                               
      COMMON /STIM/ STCSTM                                              
C                                                                       
      COMMON /NQAC/ NQACU,NQACT                                         
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /TAVE/ TAGU(JG),TAGV(JG),TAGW(JG),TAGP(JG),                
     &              UGRMS(JG),VGRMS(JG),WGRMS(JG),PGRMS(JG)             
C                                                                       
      COMMON /TTM1/ TAT1G(JG),TRMS1G(JG),                               
     &              FLXUT1G(JG),FLXVT1G(JG),FLXWT1G(JG)                 
C                                                                       
      COMMON /TTM2/ TAT2G(JG),TRMS2G(JG),                               
     &              FLXUT2G(JG),FLXVT2G(JG),FLXWT2G(JG)                 
C                                                                       
      COMMON /THF1/ ATHFV1G(JG),ATOTAL1G(JG)                            
      COMMON /THF2/ ATHFV2G(JG),ATOTAL2G(JG)                            
C                                                                       
      COMMON /KON1/ PRO1TG(JG),DIS1TG(JG),                              
     &              TDF1TG(JG),RMD1TG(JG),                              
     &              PRO1UG(JG),DIS1UG(JG),TPG1UG(JG),                   
     &              TDF1UG(JG),RMD1UG(JG),PTG1UG(JG),PDF1UG(JG),        
     &              PRO1VG(JG),DIS1VG(JG),TPG1VG(JG),                   
     &              TDF1VG(JG),RMD1VG(JG),PTG1VG(JG),PDF1VG(JG),        
     &              PRO1WG(JG),DIS1WG(JG),TPG1WG(JG),                   
     &              TDF1WG(JG),RMD1WG(JG),PTG1WG(JG),PDF1WG(JG)         
      COMMON /KON2/ PRO2TG(JG),DIS2TG(JG),                              
     &              TDF2TG(JG),RMD2TG(JG),                              
     &              PRO2UG(JG),DIS2UG(JG),TPG2UG(JG),                   
     &              TDF2UG(JG),RMD2UG(JG),PTG2UG(JG),PDF2UG(JG),        
     &              PRO2VG(JG),DIS2VG(JG),TPG2VG(JG),                   
     &              TDF2VG(JG),RMD2VG(JG),PTG2VG(JG),PDF2VG(JG),        
     &              PRO2WG(JG),DIS2WG(JG),TPG2WG(JG),                   
     &              TDF2WG(JG),RMD2WG(JG),PTG2WG(JG),PDF2WG(JG)         
C                                                                       
      COMMON /TSPE/ ATSTRMG(IG,JG,4),ATSPANG(KG,JG,4)                   
      COMMON /TCOR/ ATPC1TG(IG,JG,2),ATPC3TG(KG,JG,2)                   
C                                                                       
      COMMON /TSFVT/ TSKEWVTG(JG,2),TFLATVTG(JG,2)                      
C                                                                       
      COMMON /T1HOA/ AT1TRIG(JG,10),AT1QUADG(JG,19),AQAVT1G(JG,4)       
      COMMON /T2HOA/ AT2TRIG(JG,10),AT2QUADG(JG,19),AQAVT2G(JG,4)       
C                                                                       
      COMMON /NQAVT/ ANQAVTG(JG,4,2)                                    
C                                                                       
C=======================================================================
C                                                                       
C      OPEN(12)                                                         
      READ(12) NSTCS,STCSTM                                             
      READ(12) TAGU,TAGV,TAGW                                           
      READ(12) TAGP,TAT1G,TAT2G                                         
      READ(12) UGRMS,VGRMS,WGRMS                                        
      READ(12) PGRMS,TRMS1G,TRMS2G                                      
      READ(12) FLXUT1G,FLXVT1G,FLXWT1G                                  
      READ(12) FLXUT2G,FLXVT2G,FLXWT2G                                  
      READ(12) ATOTAL1G,ATHFV1G                                         
      READ(12) ATOTAL2G,ATHFV2G                                         
C                                                                       
      READ(12) PRO1TG,DIS1TG,TDF1TG,RMD1TG                              
      READ(12) PRO1UG,DIS1UG,TPG1UG                                     
      READ(12) TDF1UG,RMD1UG                                            
      READ(12) PTG1UG,PDF1UG                                            
      READ(12) PRO1VG,DIS1VG,TPG1VG                                     
      READ(12) TDF1VG,RMD1VG                                            
      READ(12) PTG1VG,PDF1VG                                            
      READ(12) PRO1WG,DIS1WG,TPG1WG                                     
      READ(12) TDF1WG,RMD1WG                                            
      READ(12) PTG1WG,PDF1WG                                            
      READ(12) PRO2TG,DIS2TG,TDF2TG,RMD2TG                              
      READ(12) PRO2UG,DIS2UG,TPG2UG                                     
      READ(12) TDF2UG,RMD2UG                                            
      READ(12) PTG2UG,PDF2UG                                            
      READ(12) PRO2VG,DIS2VG,TPG2VG                                     
      READ(12) TDF2VG,RMD2VG                                            
      READ(12) PTG2VG,PDF2VG                                            
      READ(12) PRO2WG,DIS2WG,TPG2WG                                     
      READ(12) TDF2WG,RMD2WG                                            
      READ(12) PTG2WG,PDF2WG                                            
C                                                                       
      READ(12) ATSTRMG,ATSPANG                                          
      READ(12) ATPC1TG,ATPC3TG                                          
      READ(12) TSKEWVTG,TFLATVTG                                        
      READ(12) AT1TRIG,AT1QUADG,AQAVT1G                                 
      READ(12) AT2TRIG,AT2QUADG,AQAVT2G                                 
      READ(12) NQACT                                                    
      READ(12) ANQAVTG                                                  
C      CLOSE(12)                                                        
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE TAVEOUT                                                
C                                                                       
C     REVISED ON 2001.03.04  BY H.ABE (QA-UV)                           
C     REVISED ON 2000.10.17  BY H.ABE (QUADRUPLE CORR.)                 
C     REVISED ON 2000.10.17  BY H.ABE (QUADRANT ANALYSIS: VT)           
C     REVISED BY H.ABE (2000.09.30) ADD: TSKEWVT & TFLATVT              
C     REVISED BY H.ABE (2000.09.30) ADD: 3-POINT CORR. (TTT,UTT,ETC)    
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
C                                                                       
C---  LOCAL  VARIABLES  ------------------------------------------------
C                                                                       
      COMMON /SNUM/ NSTCS                                               
      COMMON /STIM/ STCSTM                                              
C                                                                       
      COMMON /NQAC/ NQACU,NQACT                                         
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /TAVE/ TAGU(JG),TAGV(JG),TAGW(JG),TAGP(JG),                
     &              UGRMS(JG),VGRMS(JG),WGRMS(JG),PGRMS(JG)             
C                                                                       
      COMMON /TTM1/ TAT1G(JG),TRMS1G(JG),                               
     &              FLXUT1G(JG),FLXVT1G(JG),FLXWT1G(JG)                 
C                                                                       
      COMMON /TTM2/ TAT2G(JG),TRMS2G(JG),                               
     &              FLXUT2G(JG),FLXVT2G(JG),FLXWT2G(JG)                 
C                                                                       
      COMMON /THF1/ ATHFV1G(JG),ATOTAL1G(JG)                            
      COMMON /THF2/ ATHFV2G(JG),ATOTAL2G(JG)                            
C                                                                       
      COMMON /KON1/ PRO1TG(JG),DIS1TG(JG),                              
     &              TDF1TG(JG),RMD1TG(JG),                              
     &              PRO1UG(JG),DIS1UG(JG),TPG1UG(JG),                   
     &              TDF1UG(JG),RMD1UG(JG),PTG1UG(JG),PDF1UG(JG),        
     &              PRO1VG(JG),DIS1VG(JG),TPG1VG(JG),                   
     &              TDF1VG(JG),RMD1VG(JG),PTG1VG(JG),PDF1VG(JG),        
     &              PRO1WG(JG),DIS1WG(JG),TPG1WG(JG),                   
     &              TDF1WG(JG),RMD1WG(JG),PTG1WG(JG),PDF1WG(JG)         
      COMMON /KON2/ PRO2TG(JG),DIS2TG(JG),                              
     &              TDF2TG(JG),RMD2TG(JG),                              
     &              PRO2UG(JG),DIS2UG(JG),TPG2UG(JG),                   
     &              TDF2UG(JG),RMD2UG(JG),PTG2UG(JG),PDF2UG(JG),        
     &              PRO2VG(JG),DIS2VG(JG),TPG2VG(JG),                   
     &              TDF2VG(JG),RMD2VG(JG),PTG2VG(JG),PDF2VG(JG),        
     &              PRO2WG(JG),DIS2WG(JG),TPG2WG(JG),                   
     &              TDF2WG(JG),RMD2WG(JG),PTG2WG(JG),PDF2WG(JG)         
C                                                                       
      COMMON /TSPE/ ATSTRMG(IG,JG,4),ATSPANG(KG,JG,4)                   
      COMMON /TCOR/ ATPC1TG(IG,JG,2),ATPC3TG(KG,JG,2)                   
C                                                                       
      COMMON /TSFVT/ TSKEWVTG(JG,2),TFLATVTG(JG,2)                      
C                                                                       
      COMMON /T1HOA/ AT1TRIG(JG,10),AT1QUADG(JG,19),AQAVT1G(JG,4)       
      COMMON /T2HOA/ AT2TRIG(JG,10),AT2QUADG(JG,19),AQAVT2G(JG,4)       
C                                                                       
      COMMON /NQAVT/ ANQAVTG(JG,4,2)                                    
C                                                                       
C=======================================================================
C                                                                       
C      OPEN(13)                                                         
      WRITE(13) NSTCS,STCSTM                                            
      WRITE(13) TAGU,TAGV,TAGW                                          
      WRITE(13) TAGP,TAT1G,TAT2G                                        
      WRITE(13) UGRMS,VGRMS,WGRMS                                       
      WRITE(13) PGRMS,TRMS1G,TRMS2G                                     
      WRITE(13) FLXUT1G,FLXVT1G,FLXWT1G                                 
      WRITE(13) FLXUT2G,FLXVT2G,FLXWT2G                                 
      WRITE(13) ATOTAL1G,ATHFV1G                                        
      WRITE(13) ATOTAL2G,ATHFV2G                                        
C                                                                       
      WRITE(13) PRO1TG,DIS1TG,TDF1TG,RMD1TG                             
      WRITE(13) PRO1UG,DIS1UG,TPG1UG                                    
      WRITE(13) TDF1UG,RMD1UG                                           
      WRITE(13) PTG1UG,PDF1UG                                           
      WRITE(13) PRO1VG,DIS1VG,TPG1VG                                    
      WRITE(13) TDF1VG,RMD1VG                                           
      WRITE(13) PTG1VG,PDF1VG                                           
      WRITE(13) PRO1WG,DIS1WG,TPG1WG                                    
      WRITE(13) TDF1WG,RMD1WG                                           
      WRITE(13) PTG1WG,PDF1WG                                           
      WRITE(13) PRO2TG,DIS2TG,TDF2TG,RMD2TG                             
      WRITE(13) PRO2UG,DIS2UG,TPG2UG                                    
      WRITE(13) TDF2UG,RMD2UG                                           
      WRITE(13) PTG2UG,PDF2UG                                           
      WRITE(13) PRO2VG,DIS2VG,TPG2VG                                    
      WRITE(13) TDF2VG,RMD2VG                                           
      WRITE(13) PTG2VG,PDF2VG                                           
      WRITE(13) PRO2WG,DIS2WG,TPG2WG                                    
      WRITE(13) TDF2WG,RMD2WG                                           
      WRITE(13) PTG2WG,PDF2WG                                           
C                                                                       
      WRITE(13) ATSTRMG,ATSPANG                                         
      WRITE(13) ATPC1TG,ATPC3TG                                         
      WRITE(13) TSKEWVTG,TFLATVTG                                       
      WRITE(13) AT1TRIG,AT1QUADG,AQAVT1G                                
      WRITE(13) AT2TRIG,AT2QUADG,AQAVT2G                                
      WRITE(13) NQACT                                                   
      WRITE(13) ANQAVTG                                                 
C      CLOSE(13)                                                        
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE TAVE_OUTPUT(PPE1,PPE2)                                 
C                                                                       
C     REVISED ON 2001.03.04  BY H.ABE (QA-UV)                           
C     REVISED BY H.ABE (2000.09.30) ADD: TSKEWVT & TFLATVT              
C     REVISED BY H.ABE (2000.09.30) ADD: 3-POINT CORR. (TTT,UTT,ETC)    
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCMESH'                                         
      INCLUDE './INCFILE/INCDATA'                                         
C                                                                       
      CHARACTER*72 TL(3),CM(2),CM1(23),CM2(72)                          
      CHARACTER*53 CMSP(2),CMCR(2)                                      
C                                                                       
      COMMON /ANUM/ NAVE                                                
      COMMON /ATIM/ AVETIM                                              
      COMMON /SCNM/ NCALC                                               
      COMMON /SCTM/ CALTIM                                              
      COMMON /SNUM/ NSTCS                                               
      COMMON /STIM/ STCSTM                                              
C                                                                       
      COMMON /UTAU/ AUTUB,AUTUT                                         
      COMMON /UTAU2/ AUTUB2,AUTUT2                                      
      COMMON /JAVE/ JA,JB,JC,JD,JE,JF,JH,JI,JJ,JK,JL                    
C                                                                       
      COMMON /RVXZ/ PXZ                                                 
C                                                                       
C---  LOCAL  VARIABLES  ------------------------------------------------
C                                                                       
      DIMENSION TSKEW(JG,2),TFLAT(JG,2)                                 
      DIMENSION AKT1G(JG),AKT2G(JG)                                     
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /TTM1/ TAT1G(JG),TRMS1G(JG),                               
     &              FLXUT1G(JG),FLXVT1G(JG),FLXWT1G(JG)                 
C                                                                       
      COMMON /TTM2/ TAT2G(JG),TRMS2G(JG),                               
     &              FLXUT2G(JG),FLXVT2G(JG),FLXWT2G(JG)                 
C                                                                       
      COMMON /THF1/ ATHFV1G(JG),ATOTAL1G(JG)                            
      COMMON /THF2/ ATHFV2G(JG),ATOTAL2G(JG)                            
C                                                                       
      COMMON /TSPE/ ATSTRMG(IG,JG,4),ATSPANG(KG,JG,4)                   
      COMMON /TCOR/ ATPC1TG(IG,JG,2),ATPC3TG(KG,JG,2)                   
C                                                                       
      COMMON /TSFVT/ TSKEWVTG(JG,2),TFLATVTG(JG,2)                      
C                                                                       
      COMMON /T1HOA/ AT1TRIG(JG,10),AT1QUADG(JG,19),AQAVT1G(JG,4)       
      COMMON /T2HOA/ AT2TRIG(JG,10),AT2QUADG(JG,19),AQAVT2G(JG,4)       
C                                                                       
      COMMON /NQAVT/ ANQAVTG(JG,4,2)                                    
      COMMON /NQAC/ NQACU,NQACT                                         
C                                                                       
      COMMON /TAVE/ TAGU(JG),TAGV(JG),TAGW(JG),TAGP(JG),                
     &              UGRMS(JG),VGRMS(JG),WGRMS(JG),PGRMS(JG)             
C                                                                       
      COMMON /YPC1/ YPLS1G(JG)                                          
      COMMON /YPC2/ YPLS2G(JG)                                          
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
      PNSTCS=1.0D0/DBLE(NSTCS)                                          
      PAVE=1.0D0/DBLE(NAVE)                                             
      PPE1=PPE1                                                         
C                                                                       
      PVISC=(AUTUT+AUTUB)*0.5D0*RE                                      
C                                                                       
      DO 300 J=1,JG                                                     
        AKT1G(J)=0.5D0*TRMS1G(J)*PXZ*PNSTCS                             
        AKT2G(J)=0.5D0*TRMS2G(J)*PXZ*PNSTCS                             
  300 CONTINUE                                                          
C                                                                       
      DO 301 J=1,JG                                                     
        TAT1G(J)=TAT1G(J)*PNSTCS                                        
        TAT2G(J)=TAT2G(J)*PNSTCS                                        
C                                                                       
        UGRMS(J)=DSQRT(UGRMS(J)*PXZ*PNSTCS)                             
        TRMS1G(J)=DSQRT(TRMS1G(J)*PXZ*PNSTCS)                           
        TRMS2G(J)=DSQRT(TRMS2G(J)*PXZ*PNSTCS)                           
C                                                                       
        FLXUT1G(J)=FLXUT1G(J)*PXZ*PNSTCS                                
        FLXVT1G(J)=FLXVT1G(J)*PXZ*PNSTCS                                
        FLXWT1G(J)=FLXWT1G(J)*PXZ*PNSTCS                                
        FLXUT2G(J)=FLXUT2G(J)*PXZ*PNSTCS                                
        FLXVT2G(J)=FLXVT2G(J)*PXZ*PNSTCS                                
        FLXWT2G(J)=FLXWT2G(J)*PXZ*PNSTCS                                
C                                                                       
        ATHFV1G(J)=ATHFV1G(J)*PNSTCS                                    
        ATHFV2G(J)=ATHFV2G(J)*PNSTCS                                    
C---------------------------------------------CONST.WALL-HEAT FLUX      
        ATOTAL1G(J)=ATOTAL1G(J)*PNSTCS                                  
C        ATOTAL2G(J)=ATOTAL2G(J)*PNSTCS                                 
C---------------------------------------------CONST.WALL-TEMP DIFFERENCE
C        ATOTAL1G(J)=ATOTAL1G(J)*PNSTCS-PPE1                            
        ATOTAL2G(J)=ATOTAL2G(J)*PNSTCS-PPE2                             
C--------------------------------------------                           
        TSKEWVTG(J,1)=TSKEWVTG(J,1)*PNSTCS                              
        TSKEWVTG(J,2)=TSKEWVTG(J,2)*PNSTCS                              
        TFLATVTG(J,1)=TFLATVTG(J,1)*PNSTCS                              
        TFLATVTG(J,2)=TFLATVTG(J,2)*PNSTCS                              
C                                                                       
        AT1TRIG(J,1)=AT1TRIG(J,1)*PXZ*PNSTCS                            
        AT1TRIG(J,2)=AT1TRIG(J,2)*PXZ*PNSTCS                            
        AT1TRIG(J,3)=AT1TRIG(J,3)*PXZ*PNSTCS                            
        AT1TRIG(J,4)=AT1TRIG(J,4)*PXZ*PNSTCS                            
        AT1TRIG(J,5)=AT1TRIG(J,5)*PXZ*PNSTCS                            
        AT1TRIG(J,6)=AT1TRIG(J,6)*PXZ*PNSTCS                            
        AT1TRIG(J,7)=AT1TRIG(J,7)*PXZ*PNSTCS                            
        AT1TRIG(J,8)=AT1TRIG(J,8)*PXZ*PNSTCS                            
        AT1TRIG(J,9)=AT1TRIG(J,9)*PXZ*PNSTCS                            
        AT1TRIG(J,10)=AT1TRIG(J,10)*PXZ*PNSTCS                          
C                                                                       
        AT2TRIG(J,1)=AT2TRIG(J,1)*PXZ*PNSTCS                            
        AT2TRIG(J,2)=AT2TRIG(J,2)*PXZ*PNSTCS                            
        AT2TRIG(J,3)=AT2TRIG(J,3)*PXZ*PNSTCS                            
        AT2TRIG(J,4)=AT2TRIG(J,4)*PXZ*PNSTCS                            
        AT2TRIG(J,5)=AT2TRIG(J,5)*PXZ*PNSTCS                            
        AT2TRIG(J,6)=AT2TRIG(J,6)*PXZ*PNSTCS                            
        AT2TRIG(J,7)=AT2TRIG(J,7)*PXZ*PNSTCS                            
        AT2TRIG(J,8)=AT2TRIG(J,8)*PXZ*PNSTCS                            
        AT2TRIG(J,9)=AT2TRIG(J,9)*PXZ*PNSTCS                            
        AT2TRIG(J,10)=AT2TRIG(J,10)*PXZ*PNSTCS                          
C                                                                       
        AT1QUADG(J,1)=AT1QUADG(J,1)*PXZ*PNSTCS                          
        AT1QUADG(J,2)=AT1QUADG(J,2)*PXZ*PNSTCS                          
        AT1QUADG(J,3)=AT1QUADG(J,3)*PXZ*PNSTCS                          
        AT1QUADG(J,4)=AT1QUADG(J,4)*PXZ*PNSTCS                          
        AT1QUADG(J,5)=AT1QUADG(J,5)*PXZ*PNSTCS                          
        AT1QUADG(J,6)=AT1QUADG(J,6)*PXZ*PNSTCS                          
        AT1QUADG(J,7)=AT1QUADG(J,7)*PXZ*PNSTCS                          
        AT1QUADG(J,8)=AT1QUADG(J,8)*PXZ*PNSTCS                          
        AT1QUADG(J,9)=AT1QUADG(J,9)*PXZ*PNSTCS                          
        AT1QUADG(J,10)=AT1QUADG(J,10)*PXZ*PNSTCS                        
        AT1QUADG(J,11)=AT1QUADG(J,11)*PXZ*PNSTCS                        
        AT1QUADG(J,12)=AT1QUADG(J,12)*PXZ*PNSTCS                        
        AT1QUADG(J,13)=AT1QUADG(J,13)*PXZ*PNSTCS                        
        AT1QUADG(J,14)=AT1QUADG(J,14)*PXZ*PNSTCS                        
        AT1QUADG(J,15)=AT1QUADG(J,15)*PXZ*PNSTCS                        
        AT1QUADG(J,16)=AT1QUADG(J,16)*PXZ*PNSTCS                        
        AT1QUADG(J,17)=AT1QUADG(J,17)*PXZ*PNSTCS                        
        AT1QUADG(J,18)=AT1QUADG(J,18)*PXZ*PNSTCS                        
        AT1QUADG(J,19)=AT1QUADG(J,19)*PXZ*PNSTCS                        
C                                                                       
        AT2QUADG(J,1)=AT2QUADG(J,1)*PXZ*PNSTCS                          
        AT2QUADG(J,2)=AT2QUADG(J,2)*PXZ*PNSTCS                          
        AT2QUADG(J,3)=AT2QUADG(J,3)*PXZ*PNSTCS                          
        AT2QUADG(J,4)=AT2QUADG(J,4)*PXZ*PNSTCS                          
        AT2QUADG(J,5)=AT2QUADG(J,5)*PXZ*PNSTCS                          
        AT2QUADG(J,6)=AT2QUADG(J,6)*PXZ*PNSTCS                          
        AT2QUADG(J,7)=AT2QUADG(J,7)*PXZ*PNSTCS                          
        AT2QUADG(J,8)=AT2QUADG(J,8)*PXZ*PNSTCS                          
        AT2QUADG(J,9)=AT2QUADG(J,9)*PXZ*PNSTCS                          
        AT2QUADG(J,10)=AT2QUADG(J,10)*PXZ*PNSTCS                        
        AT2QUADG(J,11)=AT2QUADG(J,11)*PXZ*PNSTCS                        
        AT2QUADG(J,12)=AT2QUADG(J,12)*PXZ*PNSTCS                        
        AT2QUADG(J,13)=AT2QUADG(J,13)*PXZ*PNSTCS                        
        AT2QUADG(J,14)=AT2QUADG(J,14)*PXZ*PNSTCS                        
        AT2QUADG(J,15)=AT2QUADG(J,15)*PXZ*PNSTCS                        
        AT2QUADG(J,16)=AT2QUADG(J,16)*PXZ*PNSTCS                        
        AT2QUADG(J,17)=AT2QUADG(J,17)*PXZ*PNSTCS                        
        AT2QUADG(J,18)=AT2QUADG(J,18)*PXZ*PNSTCS                        
        AT2QUADG(J,19)=AT2QUADG(J,19)*PXZ*PNSTCS                        
C                                                                       
        AQAVT1G(J,1)=AQAVT1G(J,1)*PXZ*PNSTCS                            
        AQAVT1G(J,2)=AQAVT1G(J,2)*PXZ*PNSTCS                            
        AQAVT1G(J,3)=AQAVT1G(J,3)*PXZ*PNSTCS                            
        AQAVT1G(J,4)=AQAVT1G(J,4)*PXZ*PNSTCS                            
C                                                                       
        AQAVT2G(J,1)=AQAVT2G(J,1)*PXZ*PNSTCS                            
        AQAVT2G(J,2)=AQAVT2G(J,2)*PXZ*PNSTCS                            
        AQAVT2G(J,3)=AQAVT2G(J,3)*PXZ*PNSTCS                            
        AQAVT2G(J,4)=AQAVT2G(J,4)*PXZ*PNSTCS                            
C                                                                       
        ANQAVTG(J,1,1)=ANQAVTG(J,1,1)/DBLE(NQACT)                       
        ANQAVTG(J,2,1)=ANQAVTG(J,2,1)/DBLE(NQACT)                       
        ANQAVTG(J,3,1)=ANQAVTG(J,3,1)/DBLE(NQACT)                       
        ANQAVTG(J,4,1)=ANQAVTG(J,4,1)/DBLE(NQACT)                       
        ANQAVTG(J,1,2)=ANQAVTG(J,1,2)/DBLE(NQACT)                       
        ANQAVTG(J,2,2)=ANQAVTG(J,2,2)/DBLE(NQACT)                       
        ANQAVTG(J,3,2)=ANQAVTG(J,3,2)/DBLE(NQACT)                       
        ANQAVTG(J,4,2)=ANQAVTG(J,4,2)/DBLE(NQACT)                       
  301 CONTINUE                                                          
C                                                                       
      DO 302 I=1,IG                                                     
        ATSTRMG(I,JA,1)=ATSTRMG(I,JA,1)*PNSTCS                          
        ATSTRMG(I,JA,2)=ATSTRMG(I,JA,2)*PNSTCS                          
        ATSTRMG(I,JA,3)=ATSTRMG(I,JA,3)*PNSTCS                          
        ATSTRMG(I,JA,4)=ATSTRMG(I,JA,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JB,1)=ATSTRMG(I,JB,1)*PNSTCS                          
        ATSTRMG(I,JB,2)=ATSTRMG(I,JB,2)*PNSTCS                          
        ATSTRMG(I,JB,3)=ATSTRMG(I,JB,3)*PNSTCS                          
        ATSTRMG(I,JB,4)=ATSTRMG(I,JB,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JC,1)=ATSTRMG(I,JC,1)*PNSTCS                          
        ATSTRMG(I,JC,2)=ATSTRMG(I,JC,2)*PNSTCS                          
        ATSTRMG(I,JC,3)=ATSTRMG(I,JC,3)*PNSTCS                          
        ATSTRMG(I,JC,4)=ATSTRMG(I,JC,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JD,1)=ATSTRMG(I,JD,1)*PNSTCS                          
        ATSTRMG(I,JD,2)=ATSTRMG(I,JD,2)*PNSTCS                          
        ATSTRMG(I,JD,3)=ATSTRMG(I,JD,3)*PNSTCS                          
        ATSTRMG(I,JD,4)=ATSTRMG(I,JD,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JE,1)=ATSTRMG(I,JE,1)*PNSTCS                          
        ATSTRMG(I,JE,2)=ATSTRMG(I,JE,2)*PNSTCS                          
        ATSTRMG(I,JE,3)=ATSTRMG(I,JE,3)*PNSTCS                          
        ATSTRMG(I,JE,4)=ATSTRMG(I,JE,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JF,1)=ATSTRMG(I,JF,1)*PNSTCS                          
        ATSTRMG(I,JF,2)=ATSTRMG(I,JF,2)*PNSTCS                          
        ATSTRMG(I,JF,3)=ATSTRMG(I,JF,3)*PNSTCS                          
        ATSTRMG(I,JF,4)=ATSTRMG(I,JF,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JH,1)=ATSTRMG(I,JH,1)*PNSTCS                          
        ATSTRMG(I,JH,2)=ATSTRMG(I,JH,2)*PNSTCS                          
        ATSTRMG(I,JH,3)=ATSTRMG(I,JH,3)*PNSTCS                          
        ATSTRMG(I,JH,4)=ATSTRMG(I,JH,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JI,1)=ATSTRMG(I,JI,1)*PNSTCS                          
        ATSTRMG(I,JI,2)=ATSTRMG(I,JI,2)*PNSTCS                          
        ATSTRMG(I,JI,3)=ATSTRMG(I,JI,3)*PNSTCS                          
        ATSTRMG(I,JI,4)=ATSTRMG(I,JI,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JJ,1)=ATSTRMG(I,JJ,1)*PNSTCS                          
        ATSTRMG(I,JJ,2)=ATSTRMG(I,JJ,2)*PNSTCS                          
        ATSTRMG(I,JJ,3)=ATSTRMG(I,JJ,3)*PNSTCS                          
        ATSTRMG(I,JJ,4)=ATSTRMG(I,JJ,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JK,1)=ATSTRMG(I,JK,1)*PNSTCS                          
        ATSTRMG(I,JK,2)=ATSTRMG(I,JK,2)*PNSTCS                          
        ATSTRMG(I,JK,3)=ATSTRMG(I,JK,3)*PNSTCS                          
        ATSTRMG(I,JK,4)=ATSTRMG(I,JK,4)*PNSTCS                          
C                                                                       
        ATSTRMG(I,JL,1)=ATSTRMG(I,JL,1)*PNSTCS                          
        ATSTRMG(I,JL,2)=ATSTRMG(I,JL,2)*PNSTCS                          
        ATSTRMG(I,JL,3)=ATSTRMG(I,JL,3)*PNSTCS                          
        ATSTRMG(I,JL,4)=ATSTRMG(I,JL,4)*PNSTCS                          
C                                                                       
        ATPC1TG(I,JA,1)=ATPC1TG(I,JA,1)*PNSTCS                          
        ATPC1TG(I,JB,1)=ATPC1TG(I,JB,1)*PNSTCS                          
        ATPC1TG(I,JC,1)=ATPC1TG(I,JC,1)*PNSTCS                          
        ATPC1TG(I,JD,1)=ATPC1TG(I,JD,1)*PNSTCS                          
        ATPC1TG(I,JE,1)=ATPC1TG(I,JE,1)*PNSTCS                          
        ATPC1TG(I,JF,1)=ATPC1TG(I,JF,1)*PNSTCS                          
        ATPC1TG(I,JH,1)=ATPC1TG(I,JH,1)*PNSTCS                          
        ATPC1TG(I,JI,1)=ATPC1TG(I,JI,1)*PNSTCS                          
        ATPC1TG(I,JJ,1)=ATPC1TG(I,JJ,1)*PNSTCS                          
        ATPC1TG(I,JK,1)=ATPC1TG(I,JK,1)*PNSTCS                          
        ATPC1TG(I,JL,1)=ATPC1TG(I,JL,1)*PNSTCS                          
C                                                                       
        ATPC1TG(I,JA,2)=ATPC1TG(I,JA,2)*PNSTCS                          
        ATPC1TG(I,JB,2)=ATPC1TG(I,JB,2)*PNSTCS                          
        ATPC1TG(I,JC,2)=ATPC1TG(I,JC,2)*PNSTCS                          
        ATPC1TG(I,JD,2)=ATPC1TG(I,JD,2)*PNSTCS                          
        ATPC1TG(I,JE,2)=ATPC1TG(I,JE,2)*PNSTCS                          
        ATPC1TG(I,JF,2)=ATPC1TG(I,JF,2)*PNSTCS                          
        ATPC1TG(I,JH,2)=ATPC1TG(I,JH,2)*PNSTCS                          
        ATPC1TG(I,JI,2)=ATPC1TG(I,JI,2)*PNSTCS                          
        ATPC1TG(I,JJ,2)=ATPC1TG(I,JJ,2)*PNSTCS                          
        ATPC1TG(I,JK,2)=ATPC1TG(I,JK,2)*PNSTCS                          
        ATPC1TG(I,JL,2)=ATPC1TG(I,JL,2)*PNSTCS                          
  302 CONTINUE                                                          
C                                                                       
      DO 303 K=1,KG                                                     
        ATSPANG(K,JA,1)=ATSPANG(K,JA,1)*PNSTCS                          
        ATSPANG(K,JA,2)=ATSPANG(K,JA,2)*PNSTCS                          
        ATSPANG(K,JA,3)=ATSPANG(K,JA,3)*PNSTCS                          
        ATSPANG(K,JA,4)=ATSPANG(K,JA,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JB,1)=ATSPANG(K,JB,1)*PNSTCS                          
        ATSPANG(K,JB,2)=ATSPANG(K,JB,2)*PNSTCS                          
        ATSPANG(K,JB,3)=ATSPANG(K,JB,3)*PNSTCS                          
        ATSPANG(K,JB,4)=ATSPANG(K,JB,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JC,1)=ATSPANG(K,JC,1)*PNSTCS                          
        ATSPANG(K,JC,2)=ATSPANG(K,JC,2)*PNSTCS                          
        ATSPANG(K,JC,3)=ATSPANG(K,JC,3)*PNSTCS                          
        ATSPANG(K,JC,4)=ATSPANG(K,JC,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JD,1)=ATSPANG(K,JD,1)*PNSTCS                          
        ATSPANG(K,JD,2)=ATSPANG(K,JD,2)*PNSTCS                          
        ATSPANG(K,JD,3)=ATSPANG(K,JD,3)*PNSTCS                          
        ATSPANG(K,JD,4)=ATSPANG(K,JD,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JE,1)=ATSPANG(K,JE,1)*PNSTCS                          
        ATSPANG(K,JE,2)=ATSPANG(K,JE,2)*PNSTCS                          
        ATSPANG(K,JE,3)=ATSPANG(K,JE,3)*PNSTCS                          
        ATSPANG(K,JE,4)=ATSPANG(K,JE,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JF,1)=ATSPANG(K,JF,1)*PNSTCS                          
        ATSPANG(K,JF,2)=ATSPANG(K,JF,2)*PNSTCS                          
        ATSPANG(K,JF,3)=ATSPANG(K,JF,3)*PNSTCS                          
        ATSPANG(K,JF,4)=ATSPANG(K,JF,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JH,1)=ATSPANG(K,JH,1)*PNSTCS                          
        ATSPANG(K,JH,2)=ATSPANG(K,JH,2)*PNSTCS                          
        ATSPANG(K,JH,3)=ATSPANG(K,JH,3)*PNSTCS                          
        ATSPANG(K,JH,4)=ATSPANG(K,JH,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JI,1)=ATSPANG(K,JI,1)*PNSTCS                          
        ATSPANG(K,JI,2)=ATSPANG(K,JI,2)*PNSTCS                          
        ATSPANG(K,JI,3)=ATSPANG(K,JI,3)*PNSTCS                          
        ATSPANG(K,JI,4)=ATSPANG(K,JI,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JJ,1)=ATSPANG(K,JJ,1)*PNSTCS                          
        ATSPANG(K,JJ,2)=ATSPANG(K,JJ,2)*PNSTCS                          
        ATSPANG(K,JJ,3)=ATSPANG(K,JJ,3)*PNSTCS                          
        ATSPANG(K,JJ,4)=ATSPANG(K,JJ,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JK,1)=ATSPANG(K,JK,1)*PNSTCS                          
        ATSPANG(K,JK,2)=ATSPANG(K,JK,2)*PNSTCS                          
        ATSPANG(K,JK,3)=ATSPANG(K,JK,3)*PNSTCS                          
        ATSPANG(K,JK,4)=ATSPANG(K,JK,4)*PNSTCS                          
C                                                                       
        ATSPANG(K,JL,1)=ATSPANG(K,JL,1)*PNSTCS                          
        ATSPANG(K,JL,2)=ATSPANG(K,JL,2)*PNSTCS                          
        ATSPANG(K,JL,3)=ATSPANG(K,JL,3)*PNSTCS                          
        ATSPANG(K,JL,4)=ATSPANG(K,JL,4)*PNSTCS                          
C                                                                       
        ATPC3TG(K,JA,1)=ATPC3TG(K,JA,1)*PNSTCS                          
        ATPC3TG(K,JB,1)=ATPC3TG(K,JB,1)*PNSTCS                          
        ATPC3TG(K,JC,1)=ATPC3TG(K,JC,1)*PNSTCS                          
        ATPC3TG(K,JD,1)=ATPC3TG(K,JD,1)*PNSTCS                          
        ATPC3TG(K,JE,1)=ATPC3TG(K,JE,1)*PNSTCS                          
        ATPC3TG(K,JF,1)=ATPC3TG(K,JF,1)*PNSTCS                          
        ATPC3TG(K,JH,1)=ATPC3TG(K,JH,1)*PNSTCS                          
        ATPC3TG(K,JI,1)=ATPC3TG(K,JI,1)*PNSTCS                          
        ATPC3TG(K,JJ,1)=ATPC3TG(K,JJ,1)*PNSTCS                          
        ATPC3TG(K,JK,1)=ATPC3TG(K,JK,1)*PNSTCS                          
        ATPC3TG(K,JL,1)=ATPC3TG(K,JL,1)*PNSTCS                          
C                                                                       
        ATPC3TG(K,JA,2)=ATPC3TG(K,JA,2)*PNSTCS                          
        ATPC3TG(K,JB,2)=ATPC3TG(K,JB,2)*PNSTCS                          
        ATPC3TG(K,JC,2)=ATPC3TG(K,JC,2)*PNSTCS                          
        ATPC3TG(K,JD,2)=ATPC3TG(K,JD,2)*PNSTCS                          
        ATPC3TG(K,JE,2)=ATPC3TG(K,JE,2)*PNSTCS                          
        ATPC3TG(K,JF,2)=ATPC3TG(K,JF,2)*PNSTCS                          
        ATPC3TG(K,JH,2)=ATPC3TG(K,JH,2)*PNSTCS                          
        ATPC3TG(K,JI,2)=ATPC3TG(K,JI,2)*PNSTCS                          
        ATPC3TG(K,JJ,2)=ATPC3TG(K,JJ,2)*PNSTCS                          
        ATPC3TG(K,JK,2)=ATPC3TG(K,JK,2)*PNSTCS                          
        ATPC3TG(K,JL,2)=ATPC3TG(K,JL,2)*PNSTCS                          
  303 CONTINUE                                                          
C                                                                       
C-----------------SKEWNESS & FLATNESS FACTOR                            
C                                                                       
      DO 304 J=1,JG                                                     
        TSKEW(J,1)=AT1TRIG(J,1)/TRMS1G(J)**3                            
        TSKEW(J,2)=AT2TRIG(J,1)/TRMS2G(J)**3                            
        TFLAT(J,1)=AT1QUADG(J,1)/TRMS1G(J)**4                           
        TFLAT(J,2)=AT2QUADG(J,1)/TRMS2G(J)**4                           
  304 CONTINUE                                                          
C                                                                       
      TL(1)  ='# DIRECT NUMERICAL SIMULATION OF TURBULENT CHANNEL FLOW' 
      TL(2)  ='#   PASSIVE SCALAR FIELD ( B.C. / ISOFLUX CONDITION )'   
      TL(3)  ='#              TURBULENT STATISTICS'                     
      CM(1)  ='#     2ND-CONSISTENT SCHEME & CONSISTENT FORM'           
      CM(2)  ='#CALC.NUM.         CALC.TIME STCS NUM.         STCS TIME'
      CM1( 1)='#    YPLUS  T1-AVE            T2-AVE'                    
      CM1( 2)='#    YPLUS  T1-RMS            T2-RMS'                    
      CM1( 3)='#    YPLUS             TOTAL               THF   FOR PR1'
      CM1( 4)='#    YPLUS             TOTAL               THF   FOR PR2'
      CM1( 5)='#    YPLUS  KT (PR1)          KT (PR2)'                  
      CM1( 6)='#    YPLUS    UT      VT      WT            FOR PR1'     
      CM1( 7)='#    YPLUS    UT      VT      WT            FOR PR2'     
      CM1( 8)='#    YPLUS    TTT     UTT     VTT      WTT  FOR PR1'     
      CM1( 9)='#    YPLUS    TTT     UTT     VTT      WTT  FOR PR2'     
      CM1(10)='#    YPLUS    UUT     VVT     WWT           FOR PR1'     
      CM1(11)='#    YPLUS    UUT     VVT     WWT           FOR PR2'     
      CM1(12)='#    YPLUS    UVT     VWT     VWT           FOR PR1'     
      CM1(13)='#    YPLUS    UVT     VWT     VWT           FOR PR2'     
      CM1(14)='#    YPLUS    TTTT    UTTT    VTTT    WTTT  FOR PR1'     
      CM1(15)='#    YPLUS    TTTT    UTTT    VTTT    WTTT  FOR PR2'     
      CM1(16)='#    YPLUS    UUTT    VVTT    WWTT    UVTT  FOR PR1'     
      CM1(17)='#    YPLUS    UUTT    VVTT    WWTT    UVTT  FOR PR2'     
      CM1(18)='#    YPLUS    UWTT    VWTT    UUUT    UVVT  FOR PR1'     
      CM1(19)='#    YPLUS    UWTT    VWTT    UUUT    UVVT  FOR PR2'     
      CM1(20)='#    YPLUS    UWWT    UUVT    UUWT    UVWT  FOR PR1'     
      CM1(21)='#    YPLUS    UWWT    UUVT    UUWT    UVWT  FOR PR2'     
      CM1(22)='#    YPLUS    VVVT    VWWT    VVWT          FOR PR1'     
      CM1(23)='#    YPLUS    VVVT    VWWT    VVWT          FOR PR2'     
C                                                                       
      CMSP(1)='# I STRM-T1 STRM-T2 STRM-VT1 STRM-VT2 ENE.SPE. Y+='      
      CMSP(2)='# K SPAN-T1 SPAN-T2 SPAN-VT1 SPAN-VT2 ENE.SPE. Y+='      
      CMCR(1)='#   XPLUS    STRM-T1  STRM-T2  TWO-POINT CORR. Y+='      
      CMCR(2)='#   ZPLUS    SPAN-T1  SPAN-T2  TWO-POINT CORR. Y+='      
C                                                                       
      CM2(65)='#    YPLUS  SKEW-T1           SKEW-T2    SKEWNESS FACTOR'
      CM2(66)='#    YPLUS  FLAT-T1           FLAT-T2    FLATNESS FACTOR'
      CM2(67)='#    YPLUS  SKEW-VT1          SKEW-VT2   SKEWNESS FACTOR'
      CM2(68)='#    YPLUS  FLAT-VT1          FLAT-VT2   FLATNESS FACTOR'
      CM2(69)='#    YPLUS  VT1-1 VT1-2 VT1-3 VT1-4 QUADRANT ANALYSIS'   
      CM2(70)='#    YPLUS  VT2-1 VT2-2 VT2-3 VT2-4 QUADRANT ANALYSIS'   
      CM2(71)='#    YPLUS  VT1-1 VT1-2 VT1-3 VT1-4 QA-PDF'              
      CM2(72)='#    YPLUS  VT2-1 VT2-2 VT2-3 VT2-4 QA-PDF'              
C                                                                       
C      OPEN(17)                                                         
      WRITE(17,'(A72)') TL(1)                                           
      WRITE(17,'(A72)') TL(2)                                           
      WRITE(17,'(A72)') TL(3)                                           
      WRITE(17,'(A72)') CM(1)                                           
      WRITE(17,'(A72)') CM(2)                                           
      WRITE(17,'(I10,E18.10,I10,E18.10)') NCALC,CALTIM,NSTCS,STCSTM     
C                                                                       
      WRITE(17,'(A72)') CM1(1)                                          
      DO 10 J=1,JG                                                      
       WRITE(17,'(F10.5,2E18.10)') YPLS2G(J),TAT1G(J),TAT2G(J)          
   10 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(2)                                          
      DO 20 J=1,JG                                                      
       WRITE(17,'(F10.5,2E18.10)') YPLS2G(J),TRMS1G(J),TRMS2G(J)        
   20 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(3)                                          
      DO 30 J=1,JG                                                      
       WRITE(17,'(F10.5,2E18.10)') YPLS1G(J),ATOTAL1G(J),ATHFV1G(J)     
   30 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(4)                                          
      DO 40 J=1,JG                                                      
       WRITE(17,'(F10.5,2E18.10)') YPLS1G(J),ATOTAL2G(J),ATHFV2G(J)     
   40 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(5)                                          
      DO 50 J=1,JG                                                      
       WRITE(17,'(F10.5,2E18.10)') YPLS2G(J),AKT1G(J),AKT2G(J)          
   50 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(6)                                          
      DO 60 J=1,JG                                                      
       WRITE(17,'(F10.5,3E18.10)') YPLS2G(J),FLXUT1G(J),                
     &                              FLXVT1G(J),FLXWT1G(J)               
   60 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(7)                                          
      DO 70 J=1,JG                                                      
       WRITE(17,'(F10.5,3E18.10)') YPLS2G(J),FLXUT2G(J),                
     &                              FLXVT2G(J),FLXWT2G(J)               
   70 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JA)*PVISC                       
      DO 80 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JA,1),ATSTRMG(I,JA,2)    
     &                           ,ATSTRMG(I,JA,3),ATSTRMG(I,JA,4)       
   80 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JB)*PVISC                       
      DO 81 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JB,1),ATSTRMG(I,JB,2)    
     &                           ,ATSTRMG(I,JB,3),ATSTRMG(I,JB,4)       
   81 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JC)*PVISC                       
      DO 82 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JC,1),ATSTRMG(I,JC,2)    
     &                           ,ATSTRMG(I,JC,3),ATSTRMG(I,JC,4)       
   82 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JD)*PVISC                       
      DO 83 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JD,1),ATSTRMG(I,JD,2)    
     &                           ,ATSTRMG(I,JD,3),ATSTRMG(I,JD,4)       
   83 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JE)*PVISC                       
      DO 84 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JE,1),ATSTRMG(I,JE,2)    
     &                           ,ATSTRMG(I,JE,3),ATSTRMG(I,JE,4)       
   84 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JF)*PVISC                       
      DO 85 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JF,1),ATSTRMG(I,JF,2)    
     &                           ,ATSTRMG(I,JF,3),ATSTRMG(I,JF,4)       
   85 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JH)*PVISC                       
      DO 86 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JH,1),ATSTRMG(I,JH,2)    
     &                           ,ATSTRMG(I,JH,3),ATSTRMG(I,JH,4)       
   86 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JI)*PVISC                       
      DO 87 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JI,1),ATSTRMG(I,JI,2)    
     &                           ,ATSTRMG(I,JI,3),ATSTRMG(I,JI,4)       
   87 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JJ)*PVISC                       
      DO 88 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JJ,1),ATSTRMG(I,JJ,2)    
     &                           ,ATSTRMG(I,JJ,3),ATSTRMG(I,JJ,4)       
   88 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JK)*PVISC                       
      DO 89 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JK,1),ATSTRMG(I,JK,2)    
     &                           ,ATSTRMG(I,JK,3),ATSTRMG(I,JK,4)       
   89 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(1),RR(JL)*PVISC                       
      DO 90 I=2,IG/2+1                                                  
       WRITE(17,'(I3,4E18.10)')  I-1,ATSTRMG(I,JL,1),ATSTRMG(I,JL,2)    
     &                           ,ATSTRMG(I,JL,3),ATSTRMG(I,JL,4)       
   90 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JA)*PVISC                       
      DO 100 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JA,1),ATSPANG(K,JA,2)    
     &                           ,ATSPANG(K,JA,3),ATSPANG(K,JA,4)       
  100 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JB)*PVISC                       
      DO 101 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JB,1),ATSPANG(K,JB,2)    
     &                           ,ATSPANG(K,JB,3),ATSPANG(K,JB,4)       
  101 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JC)*PVISC                       
      DO 102 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JC,1),ATSPANG(K,JC,2)    
     &                           ,ATSPANG(K,JC,3),ATSPANG(K,JC,4)       
  102 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JD)*PVISC                       
      DO 103 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JD,1),ATSPANG(K,JD,2)    
     &                           ,ATSPANG(K,JD,3),ATSPANG(K,JD,4)       
  103 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JE)*PVISC                       
      DO 104 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JE,1),ATSPANG(K,JE,2)    
     &                           ,ATSPANG(K,JE,3),ATSPANG(K,JE,4)       
  104 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JF)*PVISC                       
      DO 105 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JF,1),ATSPANG(K,JF,2)    
     &                           ,ATSPANG(K,JF,3),ATSPANG(K,JF,4)       
  105 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JH)*PVISC                       
      DO 106 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JH,1),ATSPANG(K,JH,2)    
     &                           ,ATSPANG(K,JH,3),ATSPANG(K,JH,4)       
  106 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JI)*PVISC                       
      DO 107 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JI,1),ATSPANG(K,JI,2)    
     &                           ,ATSPANG(K,JI,3),ATSPANG(K,JI,4)       
  107 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JJ)*PVISC                       
      DO 108 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JJ,1),ATSPANG(K,JJ,2)    
     &                           ,ATSPANG(K,JJ,3),ATSPANG(K,JJ,4)       
  108 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JK)*PVISC                       
      DO 109 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JK,1),ATSPANG(K,JK,2)    
     &                           ,ATSPANG(K,JK,3),ATSPANG(K,JK,4)       
  109 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMSP(2),RR(JL)*PVISC                       
      DO 110 K=2,KG/2+1                                                 
       WRITE(17,'(I3,4E18.10)')  K-1,ATSPANG(K,JL,1),ATSPANG(K,JL,2)    
     &                           ,ATSPANG(K,JL,3),ATSPANG(K,JL,4)       
  110 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JA)*PVISC                       
      DO 120 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JA,1)      
     &                            ,ATPC1TG(I,JA,2)                      
  120 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JB)*PVISC                       
      DO 121 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JB,1)      
     &                            ,ATPC1TG(I,JB,2)                      
  121 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JC)*PVISC                       
      DO 122 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JC,1)      
     &                            ,ATPC1TG(I,JC,2)                      
  122 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JD)*PVISC                       
      DO 123 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JD,1)      
     &                            ,ATPC1TG(I,JD,2)                      
  123 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JE)*PVISC                       
      DO 124 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JE,1)      
     &                            ,ATPC1TG(I,JE,2)                      
  124 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JF)*PVISC                       
      DO 125 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JF,1)      
     &                            ,ATPC1TG(I,JF,2)                      
  125 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JH)*PVISC                       
      DO 126 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JH,1)      
     &                            ,ATPC1TG(I,JH,2)                      
  126 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JI)*PVISC                       
      DO 127 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JI,1)      
     &                            ,ATPC1TG(I,JI,2)                      
  127 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JJ)*PVISC                       
      DO 128 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JJ,1)      
     &                            ,ATPC1TG(I,JJ,2)                      
  128 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JK)*PVISC                       
      DO 129 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JK,1)      
     &                            ,ATPC1TG(I,JK,2)                      
  129 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(1),RR(JL)*PVISC                       
      DO 130 I=1,IG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(I-1)*DX*RE,ATPC1TG(I,JL,1)      
     &                            ,ATPC1TG(I,JL,2)                      
  130 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JA)*PVISC                       
      DO 140 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JA,1)      
     &                            ,ATPC3TG(K,JA,2)                      
  140 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JB)*PVISC                       
      DO 141 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JB,1)      
     &                            ,ATPC3TG(K,JB,2)                      
  141 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JC)*PVISC                       
      DO 142 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JC,1)      
     &                            ,ATPC3TG(K,JC,2)                      
  142 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JD)*PVISC                       
      DO 143 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JD,1)      
     &                            ,ATPC3TG(K,JD,2)                      
  143 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JE)*PVISC                       
      DO 144 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JE,1)      
     &                            ,ATPC3TG(K,JE,2)                      
  144 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JF)*PVISC                       
      DO 145 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JF,1)      
     &                            ,ATPC3TG(K,JF,2)                      
  145 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JH)*PVISC                       
      DO 146 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JH,1)      
     &                            ,ATPC3TG(K,JH,2)                      
  146 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JI)*PVISC                       
      DO 147 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JI,1)      
     &                            ,ATPC3TG(K,JI,2)                      
  147 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JJ)*PVISC                       
      DO 148 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JJ,1)      
     &                            ,ATPC3TG(K,JJ,2)                      
  148 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JK)*PVISC                       
      DO 149 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JK,1)      
     &                            ,ATPC3TG(K,JK,2)                      
  149 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A50,F8.3)') CMCR(2),RR(JL)*PVISC                       
      DO 150 K=1,KG/2+1                                                 
       WRITE(17,'(F10.5,2E18.10)') DBLE(K-1)*DZ*RE,ATPC3TG(K,JL,1)      
     &                            ,ATPC3TG(K,JL,2)                      
  150 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM2(65)                                         
      DO 160 J=1,JG                                                     
       WRITE(17,'(3E15.6)') YPLS2G(J),TSKEW(J,1),TSKEW(J,2)             
  160 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM2(66)                                         
      DO 161 J=1,JG                                                     
       WRITE(17,'(3E15.6)') YPLS2G(J),TFLAT(J,1),TFLAT(J,2)             
  161 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM2(67)                                         
      DO 162 J=1,JG                                                     
       WRITE(17,'(3E15.6)') YPLS1G(J),TSKEWVTG(J,1),TSKEWVTG(J,2)       
  162 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM2(68)                                         
      DO 164 J=1,JG                                                     
       WRITE(17,'(3E15.6)') YPLS1G(J),TFLATVTG(J,1),TFLATVTG(J,2)       
  164 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(8)                                          
      DO 170 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT1TRIG(J,1),AT1TRIG(J,2)         
     &                     ,AT1TRIG(J,3),AT1TRIG(J,4)                   
  170 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(9)                                          
      DO 171 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT2TRIG(J,1),AT2TRIG(J,2)         
     &                     ,AT2TRIG(J,3),AT2TRIG(J,4)                   
  171 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(10)                                         
      DO 172 J=1,JG                                                     
       WRITE(17,'(4E15.6)') YPLS2G(J),AT1TRIG(J,5),AT1TRIG(J,6)         
     &                     ,AT1TRIG(J,7)                                
  172 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(11)                                         
      DO 173 J=1,JG                                                     
       WRITE(17,'(4E15.6)') YPLS2G(J),AT2TRIG(J,5),AT2TRIG(J,6)         
     &                     ,AT2TRIG(J,7)                                
  173 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(12)                                         
      DO 174 J=1,JG                                                     
       WRITE(17,'(4E15.6)') YPLS2G(J),AT1TRIG(J,8),AT1TRIG(J,9)         
     &                     ,AT1TRIG(J,10)                               
  174 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(13)                                         
      DO 175 J=1,JG                                                     
       WRITE(17,'(4E15.6)') YPLS2G(J),AT2TRIG(J,8),AT2TRIG(J,9)         
     &                     ,AT2TRIG(J,10)                               
  175 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(14)                                         
      DO 176 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT1QUADG(J,1),AT1QUADG(J,2)       
     &                     ,AT1QUADG(J,3),AT1QUADG(J,4)                 
  176 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(15)                                         
      DO 177 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT2QUADG(J,1),AT2QUADG(J,2)       
     &                     ,AT2QUADG(J,3),AT2QUADG(J,4)                 
  177 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(16)                                         
      DO 178 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT1QUADG(J,5),AT1QUADG(J,6)       
     &                     ,AT1QUADG(J,7),AT1QUADG(J,8)                 
  178 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(17)                                         
      DO 179 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT2QUADG(J,5),AT2QUADG(J,6)       
     &                     ,AT2QUADG(J,7),AT2QUADG(J,8)                 
  179 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(18)                                         
      DO 180 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT1QUADG(J,9),AT1QUADG(J,10)      
     &                     ,AT1QUADG(J,11),AT1QUADG(J,12)               
  180 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(17)                                         
      DO 181 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT2QUADG(J,9),AT2QUADG(J,10)      
     &                     ,AT2QUADG(J,11),AT2QUADG(J,12)               
  181 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(20)                                         
      DO 182 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT1QUADG(J,13),AT1QUADG(J,14)     
     &                     ,AT1QUADG(J,15),AT1QUADG(J,16)               
  182 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(21)                                         
      DO 183 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AT2QUADG(J,13),AT2QUADG(J,14)     
     &                     ,AT2QUADG(J,15),AT2QUADG(J,16)               
  183 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(22)                                         
      DO 184 J=1,JG                                                     
       WRITE(17,'(4E15.6)') YPLS2G(J),AT1QUADG(J,17),AT1QUADG(J,18)     
     &                     ,AT1QUADG(J,19)                              
  184 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM1(23)                                         
      DO 185 J=1,JG                                                     
       WRITE(17,'(4E15.6)') YPLS2G(J),AT2QUADG(J,17),AT2QUADG(J,18)     
     &                     ,AT2QUADG(J,19)                              
  185 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM2(69)                                         
      DO 186 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AQAVT1G(J,1),AQAVT1G(J,2)         
     &                     ,AQAVT1G(J,3),AQAVT1G(J,4)                   
  186 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM2(70)                                         
      DO 187 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),AQAVT2G(J,1),AQAVT2G(J,2)         
     &                     ,AQAVT2G(J,3),AQAVT2G(J,4)                   
  187 CONTINUE                                                          
C      CLOSE(17)                                                        
C                                                                       
      WRITE(17,'(A72)') CM2(71)                                         
      DO 188 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),ANQAVTG(J,1,1),ANQAVTG(J,2,1)     
     &                     ,ANQAVTG(J,3,1),ANQAVTG(J,4,1)               
  188 CONTINUE                                                          
C                                                                       
      WRITE(17,'(A72)') CM2(72)                                         
      DO 189 J=1,JG                                                     
       WRITE(17,'(5E15.6)') YPLS2G(J),ANQAVTG(J,1,2),ANQAVTG(J,2,2)     
     &                     ,ANQAVTG(J,3,2),ANQAVTG(J,4,2)               
  189 CONTINUE                                                          
C                                                                       
C      CLOSE(17)                                                        
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE TBUD_OUTPUT                                            
C                                                                       
C     REVISED BY H.ABE (2000.10.20) ADD: PTG,PDF (BUDGET OF UT,VT,WT)   
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
      INCLUDE './INCFILE/INCMESH'                                         
C                                                                       
      DIMENSION RES1TG(JG),RES1UG(JG),RES1VG(JG),RES1WG(JG)             
      DIMENSION RES2TG(JG),RES2UG(JG),RES2VG(JG),RES2WG(JG)             
C                                                                       
      CHARACTER*72 TL(3),CM(2),CM1(2),CM2(3),CM3(6)                     
C                                                                       
C---  LOCAL  VARIABLES  ------------------------------------------------
C                                                                       
      COMMON /SCNM/ NCALC                                               
      COMMON /SCTM/ CALTIM                                              
      COMMON /SNUM/ NSTCS                                               
      COMMON /STIM/ STCSTM                                              
C                                                                       
C     COMMON / RVRE / PRE                                               
C                                                                       
      COMMON /RVXZ/ PXZ                                                 
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /KON1/ PRO1TG(JG),DIS1TG(JG),                              
     &              TDF1TG(JG),RMD1TG(JG),                              
     &              PRO1UG(JG),DIS1UG(JG),TPG1UG(JG),                   
     &              TDF1UG(JG),RMD1UG(JG),PTG1UG(JG),PDF1UG(JG),        
     &              PRO1VG(JG),DIS1VG(JG),TPG1VG(JG),                   
     &              TDF1VG(JG),RMD1VG(JG),PTG1VG(JG),PDF1VG(JG),        
     &              PRO1WG(JG),DIS1WG(JG),TPG1WG(JG),                   
     &              TDF1WG(JG),RMD1WG(JG),PTG1WG(JG),PDF1WG(JG)         
      COMMON /KON2/ PRO2TG(JG),DIS2TG(JG),                              
     &              TDF2TG(JG),RMD2TG(JG),                              
     &              PRO2UG(JG),DIS2UG(JG),TPG2UG(JG),                   
     &              TDF2UG(JG),RMD2UG(JG),PTG2UG(JG),PDF2UG(JG),        
     &              PRO2VG(JG),DIS2VG(JG),TPG2VG(JG),                   
     &              TDF2VG(JG),RMD2VG(JG),PTG2VG(JG),PDF2VG(JG),        
     &              PRO2WG(JG),DIS2WG(JG),TPG2WG(JG),                   
     &              TDF2WG(JG),RMD2WG(JG),PTG2WG(JG),PDF2WG(JG)         
C                                                                       
      COMMON /YPC1/ YPLS1G(JG)                                          
      COMMON /YPC2/ YPLS2G(JG)                                          
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
      PNSTCS=1.0D0/DBLE(NSTCS)                                          
C                                                                       
      DO 200 J=1,JG                                                     
C                                                                       
       PRO1TG(J)=PRO1TG(J)*PRE*PXZ*PNSTCS                               
       DIS1TG(J)=DIS1TG(J)*(PRE**2)*PXZ*PNSTCS                          
       TDF1TG(J)=TDF1TG(J)*PRE*PXZ*PNSTCS                               
       RMD1TG(J)=RMD1TG(J)*(PRE**2)*PXZ*PNSTCS                          
C                                                                       
       PRO1UG(J)=PRO1UG(J)*PRE*PXZ*PNSTCS                               
       DIS1UG(J)=DIS1UG(J)*(PRE**2)*PXZ*PNSTCS                          
       TPG1UG(J)=TPG1UG(J)*PRE*PXZ*PNSTCS                               
       TDF1UG(J)=TDF1UG(J)*PRE*PXZ*PNSTCS                               
       RMD1UG(J)=RMD1UG(J)*(PRE**2)*PXZ*PNSTCS                          
       PTG1UG(J)=PTG1UG(J)*PRE*PXZ*PNSTCS                               
       PDF1UG(J)=PDF1UG(J)*PRE*PXZ*PNSTCS                               
C                                                                       
       PRO1VG(J)=PRO1VG(J)*PRE*PXZ*PNSTCS                               
       DIS1VG(J)=DIS1VG(J)*(PRE**2)*PXZ*PNSTCS                          
       TPG1VG(J)=TPG1VG(J)*PRE*PXZ*PNSTCS                               
       TDF1VG(J)=TDF1VG(J)*PRE*PXZ*PNSTCS                               
       RMD1VG(J)=RMD1VG(J)*(PRE**2)*PXZ*PNSTCS                          
       PTG1VG(J)=PTG1VG(J)*PRE*PXZ*PNSTCS                               
       PDF1VG(J)=PDF1VG(J)*PRE*PXZ*PNSTCS                               
C                                                                       
       PRO1WG(J)=PRO1WG(J)*PRE*PXZ*PNSTCS                               
       DIS1WG(J)=DIS1WG(J)*(PRE**2)*PXZ*PNSTCS                          
       TPG1WG(J)=TPG1WG(J)*PRE*PXZ*PNSTCS                               
       TDF1WG(J)=TDF1WG(J)*PRE*PXZ*PNSTCS                               
       RMD1WG(J)=RMD1WG(J)*(PRE**2)*PXZ*PNSTCS                          
       PTG1WG(J)=PTG1WG(J)*PRE*PXZ*PNSTCS                               
       PDF1WG(J)=PDF1WG(J)*PRE*PXZ*PNSTCS                               
C                                                                       
       PRO2TG(J)=PRO2TG(J)*PRE*PXZ*PNSTCS                               
       DIS2TG(J)=DIS2TG(J)*(PRE**2)*PXZ*PNSTCS                          
       TDF2TG(J)=TDF2TG(J)*PRE*PXZ*PNSTCS                               
       RMD2TG(J)=RMD2TG(J)*(PRE**2)*PXZ*PNSTCS                          
C                                                                       
       PRO2UG(J)=PRO2UG(J)*PRE*PXZ*PNSTCS                               
       DIS2UG(J)=DIS2UG(J)*(PRE**2)*PXZ*PNSTCS                          
       TPG2UG(J)=TPG2UG(J)*PRE*PXZ*PNSTCS                               
       TDF2UG(J)=TDF2UG(J)*PRE*PXZ*PNSTCS                               
       RMD2UG(J)=RMD2UG(J)*(PRE**2)*PXZ*PNSTCS                          
       PTG2UG(J)=PTG2UG(J)*PRE*PXZ*PNSTCS                               
       PDF2UG(J)=PDF2UG(J)*PRE*PXZ*PNSTCS                               
C                                                                       
       PRO2VG(J)=PRO2VG(J)*PRE*PXZ*PNSTCS                               
       DIS2VG(J)=DIS2VG(J)*(PRE**2)*PXZ*PNSTCS                          
       TPG2VG(J)=TPG2VG(J)*PRE*PXZ*PNSTCS                               
       TDF2VG(J)=TDF2VG(J)*PRE*PXZ*PNSTCS                               
       RMD2VG(J)=RMD2VG(J)*(PRE**2)*PXZ*PNSTCS                          
       PTG2VG(J)=PTG2VG(J)*PRE*PXZ*PNSTCS                               
       PDF2VG(J)=PDF2VG(J)*PRE*PXZ*PNSTCS                               
C                                                                       
       PRO2WG(J)=PRO2WG(J)*PRE*PXZ*PNSTCS                               
       DIS2WG(J)=DIS2WG(J)*(PRE**2)*PXZ*PNSTCS                          
       TPG2WG(J)=TPG2WG(J)*PRE*PXZ*PNSTCS                               
       TDF2WG(J)=TDF2WG(J)*PRE*PXZ*PNSTCS                               
       RMD2WG(J)=RMD2WG(J)*(PRE**2)*PXZ*PNSTCS                          
       PTG2WG(J)=PTG2WG(J)*PRE*PXZ*PNSTCS                               
       PDF2WG(J)=PDF2WG(J)*PRE*PXZ*PNSTCS                               
C                                                                       
  200 CONTINUE                                                          
C                                                                       
      DO 210 J=1,JG                                                     
C                                                                       
       RES1TG(J)=PRO1TG(J)+DIS1TG(J)+TDF1TG(J)+RMD1TG(J)                
       RES1UG(J)=PRO1UG(J)+DIS1UG(J)+TPG1UG(J)+TDF1UG(J)+RMD1UG(J)      
       RES1VG(J)=PRO1VG(J)+DIS1VG(J)+TPG1VG(J)+TDF1VG(J)+RMD1VG(J)      
       RES1WG(J)=PRO1WG(J)+DIS1WG(J)+TPG1WG(J)+TDF1WG(J)+RMD1WG(J)      
C                                                                       
       RES2TG(J)=PRO2TG(J)+DIS2TG(J)+TDF2TG(J)+RMD2TG(J)                
       RES2UG(J)=PRO2UG(J)+DIS2UG(J)+TPG2UG(J)+TDF2UG(J)+RMD2UG(J)      
       RES2VG(J)=PRO2VG(J)+DIS2VG(J)+TPG2VG(J)+TDF2VG(J)+RMD2VG(J)      
       RES2WG(J)=PRO2WG(J)+DIS2WG(J)+TPG2WG(J)+TDF2WG(J)+RMD2WG(J)      
C                                                                       
  210 CONTINUE                                                          
C                                                                       
      TL(1) ='# DIRECT NUMERICAL SIMULATION OF TURBULENT CHANNEL FLOW'  
      TL(2) ='#  PASSIVE SCALAR FIELD ( B.C. / ISOFLUX CONDITION )'     
      TL(3) ='#                 TURBULENT STATISTICS'                   
      CM(1) ='#       2ND-CONSISTENT SCHEME & CONSISTENT FORM'          
      CM(2) ='#CALC.NUM.         CALC.TIME STCS NUM.         STCS TIME' 
C                                                                       
      CM1(1)='#  <HEREAFTER PR1 BUDGET-DATA>'                           
      CM1(2)='#  <HEREAFTER PR2 BUDGET-DATA>'                           
      CM2(1)='#                 BUDGET OF THE TEMPERATURE VARIANCE'     
      CM2(2)='#    YPLUS        PRODUCTION       DISSIPATION    TURBULEN
     &T DIF.'                                                           
      CM2(3)='#    YLPUS    MOLECULAR DIF.          RESIDUAL'           
C                                                                       
      CM3(1)='#            BUDGET OF THE STREAMWISE TURBULENT HEAT FLUX'
      CM3(2)='#           BUDGET OF THE WALL-NORMAL TURBULENT HEAT FLUX'
      CM3(3)='#             BUDGET OF THE SPANWISE TURBULENT HEAT FLUX' 
      CM3(4)='#    YPLUS        PRODUCTION       DISSIPATION T.P-GRD.COR
     &R.TERM'                                                           
      CM3(5)='#    YLPUS    TURBULENT DIF.    MOLECULAR DIF.          RE
     &SIDUAL'                                                           
      CM3(6)='#    YLPUS    T.P-GRD.CORR.    P.T-GRD.CORR.    P-DIF.'   
C                                                                       
C      OPEN(18)                                                         
      WRITE(18,'(A72)') TL(1)                                           
      WRITE(18,'(A72)') TL(2)                                           
      WRITE(18,'(A72)') TL(3)                                           
      WRITE(18,'(A72)') CM(1)                                           
      WRITE(18,'(A72)') CM(2)                                           
      WRITE(18,'(I10,E18.10,I10,E18.10)') NCALC,CALTIM,NSTCS,STCSTM     
      WRITE(18,'(A72)') CM1(1)                                          
C                                                                       
      WRITE(18,'(A72)') CM2(1)                                          
      WRITE(18,'(A72)') CM2(2)                                          
      DO 10 J=1,JG                                                      
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),PRO1TG(J),                
     &                              DIS1TG(J),TDF1TG(J)                 
   10 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM2(3)                                          
      DO 20 J=1,JG                                                      
       WRITE(18,'(F10.5,2E18.10)')  YPLS2G(J),RMD1TG(J),RES1TG(J)       
   20 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(1)                                          
      WRITE(18,'(A72)') CM3(4)                                          
      DO 30 J=1,JG                                                      
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),PRO1UG(J),                
     &                              DIS1UG(J),TPG1UG(J)                 
   30 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(5)                                          
      DO 40 J=1,JG                                                      
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TDF1UG(J),                
     &                              RMD1UG(J),RES1UG(J)                 
   40 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(6)                                          
      DO 300 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TPG1UG(J),                
     &                              PTG1UG(J),PDF1UG(J)                 
  300 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(2)                                          
      WRITE(18,'(A72)') CM3(4)                                          
      DO 50 J=1,JG                                                      
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),PRO1VG(J),                
     &                              DIS1VG(J),TPG1VG(J)                 
   50 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(5)                                          
      DO 60 J=1,JG                                                      
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TDF1VG(J),                
     &                              RMD1VG(J),RES1VG(J)                 
   60 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(6)                                          
      DO 310 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TPG1VG(J),                
     &                              PTG1VG(J),PDF1VG(J)                 
  310 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(3)                                          
      WRITE(18,'(A72)') CM3(4)                                          
      DO 70 J=1,JG                                                      
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),PRO1WG(J),                
     &                              DIS1WG(J),TPG1WG(J)                 
   70 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(5)                                          
      DO 80 J=1,JG                                                      
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TDF1WG(J),                
     &                              RMD1WG(J),RES1WG(J)                 
   80 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(6)                                          
      DO 320 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TPG1WG(J),                
     &                              PTG1WG(J),PDF1WG(J)                 
  320 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM1(2)                                          
C                                                                       
      WRITE(18,'(A72)') CM2(1)                                          
      WRITE(18,'(A72)') CM2(2)                                          
      DO 90 J=1,JG                                                      
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),PRO2TG(J),                
     &                              DIS2TG(J),TDF2TG(J)                 
   90 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM2(3)                                          
      DO 100 J=1,JG                                                     
       WRITE(18,'(F10.5,2E18.10)')  YPLS2G(J),RMD2TG(J),RES2TG(J)       
  100 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(1)                                          
      WRITE(18,'(A72)') CM3(4)                                          
      DO 110 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),PRO2UG(J),                
     &                              DIS2UG(J),TPG2UG(J)                 
  110 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(5)                                          
      DO 120 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TDF2UG(J),                
     &                              RMD2UG(J),RES2UG(J)                 
  120 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(6)                                          
      DO 330 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TPG2UG(J),                
     &                              PTG2UG(J),PDF2UG(J)                 
  330 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(2)                                          
      WRITE(18,'(A72)') CM3(4)                                          
      DO 130 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),PRO2VG(J),                
     &                              DIS2VG(J),TPG2VG(J)                 
  130 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(5)                                          
      DO 140 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TDF2VG(J),                
     &                              RMD2VG(J),RES2VG(J)                 
  140 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(6)                                          
      DO 340 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TPG2VG(J),                
     &                              PTG2VG(J),PDF2VG(J)                 
  340 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(3)                                          
      WRITE(18,'(A72)') CM3(4)                                          
      DO 150 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),PRO2WG(J),                
     &                              DIS2WG(J),TPG2WG(J)                 
  150 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(5)                                          
      DO 160 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TDF2WG(J),                
     &                              RMD2WG(J),RES2WG(J)                 
  160 CONTINUE                                                          
C                                                                       
      WRITE(18,'(A72)') CM3(6)                                          
      DO 350 J=1,JG                                                     
       WRITE(18,'(F10.5,3E18.10)')  YPLS2G(J),TPG2WG(J),                
     &                              PTG2WG(J),PDF2WG(J)                 
  350 CONTINUE                                                          
C                                                                       
C      CLOSE(18)                                                        
C                                                                       
      RETURN                                                            
      END                                                               
C                                                                       
C=======================================================================
C                                                                       
      SUBROUTINE TVEL_BACK                                              
C                                                                       
C=======================================================================
C                                                                       
      INCLUDE './INCFILE/INCINIT96'                                       
C                                                                       
      CHARACTER*72 TL(3),CM(2),CM1(4)                                   
C                                                                       
C---  LOCAL  VARIABLES  ------------------------------------------------
C                                                                       
      INCLUDE './INCFILE/INCMESH'                                         
      COMMON /SCNM/ NCALC                                               
      COMMON /SCTM/ CALTIM                                              
      COMMON /SNUM/ NSTCS                                               
      COMMON /STIM/ STCSTM                                              
C                                                                       
      COMMON /RVXZ/ PXZ                                                 
C                                                                       
C---  GLOBAL  VARIABLES  -----------------------------------------------
C                                                                       
      COMMON /TAVE/ TAGU(JG),TAGV(JG),TAGW(JG),TAGP(JG),                
     &              UGRMS(JG),VGRMS(JG),WGRMS(JG),PGRMS(JG)             
C                                                                       
      COMMON /YPC1/ YPLS1G(JG)                                          
      COMMON /YPC2/ YPLS2G(JG)                                          
C                                                                       
C=======================================================================
C                                                                       
C                                                                       
      PNSTCS=1.0D0/DBLE(NSTCS)                                          
C                                                                       
      DO 200 J=1,JG                                                     
       TAGU(J)=TAGU(J)*PNSTCS                                           
       TAGV(J)=TAGV(J)*PNSTCS                                           
       TAGW(J)=TAGW(J)*PNSTCS                                           
       TAGP(J)=TAGP(J)*PNSTCS                                           
       UGRMS(J)=DSQRT(UGRMS(J)*PXZ*PNSTCS)                              
       VGRMS(J)=DSQRT(VGRMS(J)*PXZ*PNSTCS)                              
       WGRMS(J)=DSQRT(WGRMS(J)*PXZ*PNSTCS)                              
       PGRMS(J)=DSQRT(PGRMS(J)*PXZ*PNSTCS)                              
  200 CONTINUE                                                          
C                                                                       
      TL(1) ='# DIRECT NUMERICAL SIMULATION OF TURBULENT CHANNEL FLOW'  
      TL(2) ='#  PASSIVE SCALAR FIELD ( B.C. / ISOFLUX CONDITION )'     
      TL(3) ='#                 TURBULENT STATISTICS'                   
      CM(1) ='#       2ND-CONSISTENT SCHEME & CONSISTENT FORM'          
      CM(2) ='#CALC.NUM.         CALC.TIME STCS NUM.         STCS TIME' 
      CM1(1)='#    YPLUS             UMEAN              URMS'           
      CM1(2)='#    YPLUS             VMEAN              VRMS'           
      CM1(3)='#    YPLUS             WMEAN              WRMS'           
      CM1(4)='#    YPLUS             PMEAN              PRMS'           
C                                                                       
C      OPEN(19)                                                         
      WRITE(19,'(A72)') TL(1)                                           
      WRITE(19,'(A72)') TL(2)                                           
      WRITE(19,'(A72)') TL(3)                                           
      WRITE(19,'(A72)') CM(1)                                           
      WRITE(19,'(A72)') CM(2)                                           
      WRITE(19,'(I10,E18.10,I10,E18.10)') NCALC,CALTIM,NSTCS,STCSTM     
C                                                                       
      WRITE(19,'(A72)') CM1(1)                                          
      DO 10 J=1,JG                                                      
       WRITE(19,'(F10.5,2E18.10)') YPLS2G(J),TAGU(J),UGRMS(J)           
   10 CONTINUE                                                          
C                                                                       
      WRITE(19,'(A72)') CM1(2)                                          
      DO 20 J=1,JG                                                      
       WRITE(19,'(F10.5,2E18.10)') YPLS2G(J),TAGV(J),VGRMS(J)           
   20 CONTINUE                                                          
C                                                                       
      WRITE(19,'(A72)') CM1(3)                                          
      DO 30 J=1,JG                                                      
       WRITE(19,'(F10.5,2E18.10)') YPLS2G(J),TAGW(J),WGRMS(J)           
   30 CONTINUE                                                          
C                                                                       
      WRITE(19,'(A72)') CM1(4)                                          
      DO 40 J=1,JG                                                      
       WRITE(19,'(F10.5,2E18.10)') YPLS2G(J),TAGP(J),PGRMS(J)           
   40 CONTINUE                                                          
C                                                                       
C      CLOSE(19)                                                        
C                                                                       
      RETURN                                                            
      END                                                               
